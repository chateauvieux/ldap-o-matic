[connectors GDFullSetOfAttributes]
	ALEvent {
		addonly_fail {
			active:false
			flow:
			name:AddOnly fail
		}
		addonly_ok {
			active:false
			flow:
			name:AddOnly ok
		}
		after_add {
			active:false
			flow:
			name:After Add
		}
		after_close {
			active:false
			flow:
			name:After close
		}
		after_delete {
			active:false
			flow:
			name:After delete
		}
		after_getnext {
			active:false
			flow:
			name:After GetNext
		}
		after_initialize {
			active:false
			flow:
			name:After initialize
		}
		after_lookup {
			active:false
			flow:
			name:After lookup
		}
		after_modify {
			active:false
			flow:
			name:After Modify
		}
		after_selectEntries {
			active:false
			flow:
			name:After selectEntries
		}
		after_update {
			active:false
			flow:
			name:After update
		}
		before_add {
			active:true
			flow:task.logmsg ("Attempting to ADD on unity");\ntask.dumpEntry (conn);\n
			name:Before Add
		}
		before_close {
			active:false
			flow:
			name:Before close
		}
		before_delete {
			active:false
			flow:
			name:Before delete
		}
		before_getnext {
			active:false
			flow:
			name:Before GetNext
		}
		before_initialize {
			active:false
			flow:
			name:Before initialize
		}
		before_lookup {
			active:false
			flow:
			name:Before lookup
		}
		before_modify {
			active:true
			flow:task.logmsg("Update Attributes on unity");\ntask.dumpEntry (conn);
			name:Before Modify
		}
		before_selectEntries {
			active:false
			flow:
			name:Before selectEntries
		}
		before_update {
			active:true
			flow:if (work.getString("ErrorOccured") == "yes") {\n\ttask.logmsg ("Unregistered user attack! I quit");\n\tsystem.ignoreEntry();\n}\ntask.logmsg ("Before Update on unity");\ntask.dumpEntry (work);
			name:Before update
		}
		default_fail {
			active:false
			flow:
			name:Default fail
		}
		default_ok {
			active:false
			flow:
			name:Default ok
		}
		delete_fail {
			active:false
			flow:
			name:Fail Delete
		}
		delete_ok {
			active:false
			flow:
			name:OK Delete
		}
		get_fail {
			active:false
			flow:
			name:GetNext fail
		}
		get_ok {
			active:false
			flow:
			name:GetNext ok
		}
		lookup_fail {
			active:false
			flow:
			name:Lookup fail
		}
		lookup_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		lookup_ok {
			active:false
			flow:
			name:Lookup ok
		}
		modify_apply {
			active:true
			flow:task.logmsg("Apply Attributes on unity");\ntask.dumpEntry (conn);
			name:Before Applying Changes
		}
		modify_nochange {
			active:true
			flow:task.logmsg ("No changes on unity");
			name:Modify No changes
		}
		override_add {
			active:false
			flow:
			name:Override add
		}
		override_delete {
			active:false
			flow:
			name:Override delete
		}
		override_getnext {
			active:false
			flow:
			name:Override getnext
		}
		override_lookup {
			active:false
			flow:
			name:Override lookup
		}
		override_modify {
			active:false
			flow:
			name:Override modify
		}
		override_update {
			active:false
			flow:
			name:Override update
		}
		update_fail {
			active:true
			flow:ldapErrorUnity = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapErrorUnity);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));\nwork.setAttribute("ErrorOccured", "yes");
			name:Update fail
		}
		update_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		update_ok {
			active:true
			flow:// ISS update\n// make sure file path exists\nvar url = new java.net.URL("http://unity.uwc.org/cgi-bin/checkdir.cpe?uid=" + work.getString("http.qs.uid"));\nurl.getContent();\ntask.logmsg ("Create: " + work.getString("http.qs.uid"));\nldapErrorUnity = "OK";\ntask.logmsg ("Entry updated OK on unity");\n
			name:Update ok
		}
	}
	attributeList {
	}
	compute_changes:true
	connectorConfig {
		automapADPassword:false
		debug:false
		inheritFrom:metamerge.LDAP
		ldapAuthenticationMethod:Anonymous
		ldapPageSize:0
		ldapReferrals:follow
		ldapSearchScope:subtree
		ldapSizeLimit:0
		ldapTimeLimit:0
		ldapUseSSL:false
		ldapVLVPageSize:0
		userComment:
	}
	inheritAM:
	link [
		$dn:=|$$dn
	]
	linkScript:ret.filter = "";
	override {
	}
	parserConfig {
	}
	proxyConfig {
	}
	source:D:\\Documents and Settings\\cchateauvieux\\My Documents\\My Webs\\export.cfg
	type:Update
	updateAttributes {
		$dn {
			add:true
			flow:ret.value = work.getString("$dn");\n
			mod:false
		}
		cn {
			add:true
			flow:ret.value = work.getAttribute("http.qs.cn");
			mod:true
		}
		facsimileTelephonenumber {
			add:true
			flow:ret.value = work.getAttribute("http.qs.facsimiletelephonenumber");
			mod:true
		}
		generationQualifier {
			add:true
			flow:ret.value = work.getAttribute("http.qs.generationQualifier");
			mod:true
		}
		givenName {
			add:true
			flow:ret.value = work.getAttribute("http.qs.givenname");
			mod:true
		}
		homePhone {
			add:true
			flow:ret.value = work.getAttribute("http.qs.homephone");
			mod:true
		}
		homePostalAddress {
			add:true
			flow:ret.value = work.getAttribute("http.qs.homepostaladdress");
			mod:true
		}
		labeledURI {
			add:true
			flow:ret.value = work.getAttribute("http.qs.labeledURI");
			mod:true
		}
		mail {
			add:true
			flow:ret.value = work.getAttribute("http.qs.mail");
			mod:true
		}
		migLastModifiedBy {
			add:true
			flow:ret.value = work.getAttribute("http.qs.migLastModifiedBy");
			mod:true
		}
		migLastModifiedDate {
			add:true
			flow:ret.value = work.getAttribute("http.qs.migLastModifiedDate");
			mod:true
		}
		mobile {
			add:true
			flow:ret.value = work.getAttribute("http.qs.mobile");
			mod:true
		}
		o {
			add:true
			flow:ret.value = work.getAttribute("http.qs.o");
			mod:true
		}
		objectclass {
			add:true
			flow:if (!work.getAttribute("objectclass").hasValue("uwcPerson"))\n{\n\ttmp = work.getAttribute("objectclass");\n\ttmp.addValue("uwcPerson");\n\tret.value = tmp;\n}\nelse\n{\n\tret.value = work.getAttribute("objectclass");\n}
			mod:false
		}
		pager {
			add:true
			flow:ret.value = work.getAttribute("http.qs.pager");
			mod:true
		}
		postalAddress {
			add:true
			flow:ret.value = work.getAttribute("http.qs.postaladdress");
			mod:true
		}
		preferredLanguage {
			add:true
			flow:ret.value = work.getAttribute("http.qs.preferredLanguage");
			mod:true
		}
		sn {
			add:true
			flow:ret.value = work.getAttribute("http.qs.sn");
			mod:true
		}
		telephoneNumber {
			add:true
			flow:ret.value = work.getAttribute("http.qs.telephonenumber");
			mod:true
		}
		title {
			add:true
			flow:ret.value = work.getAttribute("http.qs.title");
			mod:true
		}
		uid {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uid");
			mod:false
		}
		uwcAffiliations {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcaffiliations");
			mod:true
		}
		uwcAlsoKnownAs {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcalsoknownas");
			mod:true
		}
		uwcBiography {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcbiography");
			mod:true
		}
		uwcBirthDate {
			add:true
			flow:if ((work.getString("http.qs.y4_uwcbirthdate") != "")\n\t && (work.getString("http.qs.mm_uwcbirthdate")  != "")   \n\t && (work.getString("http.qs.dd_uwcbirthdate")  != ""))\nret.value = \n\twork.getString("http.qs.y4_uwcbirthdate") + \n\twork.getString("http.qs.mm_uwcbirthdate") + \n\twork.getString("http.qs.dd_uwcbirthdate");\nelse ret.value= null;
			mod:true
		}
		uwcChildren {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcchildren");
			mod:true
		}
		uwcCity {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwccity");
			mod:true
		}
		uwcCollege {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwccollege");
			mod:false
		}
		uwcCollegeFirstName {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwccollegefirstname");
			mod:false
		}
		uwcCollegeSurname {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwccollegesurname");
			mod:false
		}
		uwcCountry {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwccountry");
			mod:true
		}
		uwcDegree {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcdegree");
			mod:true
		}
		uwcEducatedAt {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwceducatedat");
			mod:true
		}
		uwcEducation {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwceducation");
			mod:true
		}
		uwcEndYear {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcendyear");
			mod:true
		}
		uwcFallbackContactAddress {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcfallbackcontactaddress");
			mod:true
		}
		uwcFallbackContactCity {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcfallbackcontactcity");
			mod:true
		}
		uwcFallbackContactCountry {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcfallbackcontactcountry");
			mod:true
		}
		uwcFallbackContactName {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcfallbackcontactname");
			mod:true
		}
		uwcFallbackContactPostalCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcfallbackcontactpostalcode");
			mod:true
		}
		uwcFallbackContactProvince {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcfallbackcontactprovince");
			mod:true
		}
		uwcFallbackFacsimileTelephoneNumber {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcFallbackFacsimileTelephoneNumber");
			mod:true
		}
		uwcFallbackHomePhone {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcFallbackHomePhone");
			mod:true
		}
		uwcFallbackMail {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcFallbackMail");
			mod:true
		}
		uwcGender {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcgender");
			mod:true
		}
		uwcHomePhoneAreaCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwchomephoneareacode");
			mod:true
		}
		uwcHomePhoneInternationalCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwchomephoneinternationalcode");
			mod:true
		}
		uwcHonorific {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcHonorific");
			mod:true
		}
		uwcICQNumber {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcicqnumber");
			mod:true
		}
		uwcInterest {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcinterest");
			mod:true
		}
		uwcMaritalStatus {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcmaritalstatus");
			mod:true
		}
		uwcMiddleName {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcmiddlename");
			mod:true
		}
		uwcNationality {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcnationality");
			mod:true
		}
		uwcNotes {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcnotes");
			mod:true
		}
		uwcOrganisation {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcorganisation");
			mod:true
		}
		uwcPartnerName {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcpartnername");
			mod:true
		}
		uwcPictureURI {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcpictureuri");
			mod:true
		}
		uwcPostalCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcpostalcode");
			mod:true
		}
		uwcPreferredAddress {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcPreferredAddress");
			mod:true
		}
		uwcProfessions {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcprofessions");
			mod:true
		}
		uwcProvince {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcprovince");
			mod:true
		}
		uwcPublication {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcpublication");
			mod:true
		}
		uwcRoles {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcroles");
			mod:true
		}
		uwcSalutation {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcsalutation");
			mod:true
		}
		uwcSpokenLanguages {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcspokenlanguages");
			mod:true
		}
		uwcStartYear {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcstartyear");
			mod:false
		}
		uwcTelephoneNumberAreaCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwctelephonenumberareacode");
			mod:true
		}
		uwcTelephoneNumberInternationalCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwctelephonenumberinternationalcode");
			mod:true
		}
		uwcWebSite {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcwebsite");
			mod:true
		}
		uwcWorkCity {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcworkcity");
			mod:true
		}
		uwcWorkCountry {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcworkcountry");
			mod:true
		}
		uwcWorkHistory {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcWorkHistory");
			mod:true
		}
		uwcWorkPostalCode {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcworkpostalcode");
			mod:true
		}
		uwcWorkProvince {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcworkprovince");
			mod:true
		}
		uwcWorkURI {
			add:true
			flow:ret.value = work.getAttribute("http.qs.uwcworkURI");
			mod:true
		}
	}
[end]

[connectors LDAPFreedom]
	ALEvent {
		addonly_fail {
			active:false
			flow:
			name:AddOnly fail
		}
		addonly_ok {
			active:false
			flow:
			name:AddOnly ok
		}
		after_add {
			active:false
			flow:
			name:After Add
		}
		after_close {
			active:false
			flow:
			name:After close
		}
		after_delete {
			active:false
			flow:
			name:After delete
		}
		after_getnext {
			active:false
			flow:
			name:After GetNext
		}
		after_initialize {
			active:false
			flow:
			name:After initialize
		}
		after_lookup {
			active:false
			flow:
			name:After lookup
		}
		after_modify {
			active:false
			flow:
			name:After Modify
		}
		after_selectEntries {
			active:false
			flow:
			name:After selectEntries
		}
		after_update {
			active:false
			flow:
			name:After update
		}
		before_add {
			active:false
			flow:
			name:Before Add
		}
		before_close {
			active:false
			flow:
			name:Before close
		}
		before_delete {
			active:false
			flow:
			name:Before delete
		}
		before_getnext {
			active:false
			flow:
			name:Before GetNext
		}
		before_initialize {
			active:false
			flow:
			name:Before initialize
		}
		before_lookup {
			active:false
			flow:
			name:Before lookup
		}
		before_modify {
			active:true
			flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
			name:Before Modify
		}
		before_selectEntries {
			active:false
			flow:
			name:Before selectEntries
		}
		before_update {
			active:false
			flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
			name:Before update
		}
		default_fail {
			active:false
			flow:
			name:Default fail
		}
		default_ok {
			active:false
			flow:
			name:Default ok
		}
		delete_fail {
			active:false
			flow:
			name:Fail Delete
		}
		delete_ok {
			active:false
			flow:
			name:OK Delete
		}
		get_fail {
			active:false
			flow:
			name:GetNext fail
		}
		get_ok {
			active:false
			flow:
			name:GetNext ok
		}
		lookup_fail {
			active:true
			flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("$dn") );\n
			name:Lookup fail
		}
		lookup_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		lookup_ok {
			active:true
			flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
			name:Lookup ok
		}
		modify_apply {
			active:false
			flow:
			name:Before Applying Changes
		}
		modify_nochange {
			active:false
			flow:
			name:Modify No changes
		}
		override_add {
			active:false
			flow:
			name:Override add
		}
		override_delete {
			active:false
			flow:
			name:Override delete
		}
		override_getnext {
			active:false
			flow:
			name:Override getnext
		}
		override_lookup {
			active:false
			flow:
			name:Override lookup
		}
		override_modify {
			active:false
			flow:
			name:Override modify
		}
		override_update {
			active:false
			flow:
			name:Override update
		}
		update_fail {
			active:true
			flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
			name:Update fail
		}
		update_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		update_ok {
			active:true
			flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
			name:Update ok
		}
	}
	attributeList {
		$dn {
			Include:true
			Name:$dn
			Sample:uid=AC91MTIP,o=uwc
			Syntax:java.lang.String
		}
		MigCategory {
			Include:true
			Name:MigCategory
			Sample:MIGuser
			Syntax:java.lang.String
		}
		MigChallengeQuestion {
			Include:true
			Name:MigChallengeQuestion
			Sample:What was the name of the first car you drove?
			Syntax:java.lang.String
		}
		MigChallengeQuestionAnswer {
			Include:true
			Name:MigChallengeQuestionAnswer
			Sample:homer
			Syntax:java.lang.String
		}
		MigLastModifiedBy {
			Include:true
			Name:MigLastModifiedBy
			Sample:ad96cgah
			Syntax:java.lang.String
		}
		MigLastModifiedDate {
			Include:true
			Name:MigLastModifiedDate
			Sample:Feb 26, 2002 12:08:44 PM
			Syntax:java.lang.String
		}
		cn {
			Include:true
			Name:cn
			Sample:Matthew Tippett
			Syntax:java.lang.String
		}
		deliveryMode {
			Include:true
			Name:deliveryMode
			Sample:localdelivery
			Syntax:java.lang.String
		}
		facsimileTelephoneNumber {
			Include:true
			Name:facsimileTelephoneNumber
			Sample:+1 603 297 7599
			Syntax:java.lang.String
		}
		generationQualifier {
			Include:true
			Name:generationQualifier
			Sample:asd
			Syntax:java.lang.String
		}
		givenName {
			Include:true
			Name:givenName
			Sample:Matthew
			Syntax:java.lang.String
		}
		homePhone {
			Include:true
			Name:homePhone
			Sample:1704 821585
			Syntax:java.lang.String
		}
		homePostalAddress {
			Include:true
			Name:homePostalAddress
			Sample:Tennisveien 3E
			Syntax:java.lang.String
		}
		labeledURI {
			Include:true
			Name:labeledURI
			Sample:http://www.ljone.net/
			Syntax:java.lang.String
		}
		mail {
			Include:true
			Name:mail
			Sample:AC91MTIP@uwc.net
			Syntax:java.lang.String
		}
		mailAlternateAddress {
			Include:true
			Name:mailAlternateAddress
			Sample:lag@estmail.hu
			Syntax:java.lang.String
		}
		mailForwardingAddress {
			Include:true
			Name:mailForwardingAddress
			Sample:christian.gahre@redcross.no
			Syntax:java.lang.String
		}
		mailHost {
			Include:true
			Name:mailHost
			Sample:www.uwc.org
			Syntax:java.lang.String
		}
		mailMessageStore {
			Include:true
			Name:mailMessageStore
			Sample:ac91mtip
			Syntax:java.lang.String
		}
		mobile {
			Include:true
			Name:mobile
			Sample:+47-9003 3738
			Syntax:java.lang.String
		}
		o {
			Include:true
			Name:o
			Sample:Norwegian Red Cross
			Syntax:java.lang.String
		}
		objectClass {
			Include:true
			Name:objectClass
			Sample:top
			Syntax:java.lang.String
		}
		pager {
			Include:true
			Name:pager
			Sample:zxczxc
			Syntax:java.lang.String
		}
		postalAddress {
			Include:true
			Name:postalAddress
			Sample:Hausmannsgate 7 / $PO Box 1 GrÃ¸nland
			Syntax:java.lang.String
		}
		preferredLanguage {
			Include:true
			Name:preferredLanguage
			Sample:ab
			Syntax:java.lang.String
		}
		sn {
			Include:true
			Name:sn
			Sample:Tippett
			Syntax:java.lang.String
		}
		telephoneNumber {
			Include:true
			Name:telephoneNumber
			Sample:9003 3738
			Syntax:java.lang.String
		}
		title {
			Include:true
			Name:title
			Sample:Managing Dir.
			Syntax:java.lang.String
		}
		uid {
			Include:true
			Name:uid
			Sample:AC91MTIP
			Syntax:java.lang.String
		}
		userPassword {
			Include:true
			Name:userPassword
			Sample:[B@65394b
			Syntax:ByteArray
		}
		uwcAffiliations {
			Include:true
			Name:uwcAffiliations
			Sample:Amnesty International
			Syntax:java.lang.String
		}
		uwcAlsoKnownAs {
			Include:true
			Name:uwcAlsoKnownAs
			Sample:Gino
			Syntax:java.lang.String
		}
		uwcBiography {
			Include:true
			Name:uwcBiography
			Sample:I was born at a very early age. I was pretty shy and liked to read. Then I went to a UWC and that opened my eyes to the joys of dancing and sailing. I became a professional Ukranian dancer, before taking up my new career of software testing for the UWC.
			Syntax:java.lang.String
		}
		uwcBirthDate {
			Include:true
			Name:uwcBirthDate
			Sample:530528
			Syntax:java.lang.String
		}
		uwcChildren {
			Include:true
			Name:uwcChildren
			Sample:Sofie (1985)$Sara (1988)
			Syntax:java.lang.String
		}
		uwcCity {
			Include:true
			Name:uwcCity
			Sample:Lancashire
			Syntax:java.lang.String
		}
		uwcCollege {
			Include:true
			Name:uwcCollege
			Sample:AC
			Syntax:java.lang.String
		}
		uwcCollegeFirstName {
			Include:true
			Name:uwcCollegeFirstName
			Sample:Matthew
			Syntax:java.lang.String
		}
		uwcCollegeSurname {
			Include:true
			Name:uwcCollegeSurname
			Sample:Tippett
			Syntax:java.lang.String
		}
		uwcCountry {
			Include:true
			Name:uwcCountry
			Sample:AF
			Syntax:java.lang.String
		}
		uwcDegree {
			Include:true
			Name:uwcDegree
			Sample:MBA / Siviløkonom
			Syntax:java.lang.String
		}
		uwcEducatedAt {
			Include:true
			Name:uwcEducatedAt
			Sample:Université Fribourg, Switzerl
			Syntax:java.lang.String
		}
		uwcEducation {
			Include:true
			Name:uwcEducation
			Sample:Economist
			Syntax:java.lang.String
		}
		uwcEndYear {
			Include:true
			Name:uwcEndYear
			Sample:1993
			Syntax:java.lang.String
		}
		uwcFallbackContactAddress {
			Include:true
			Name:uwcFallbackContactAddress
			Sample:PO Box 54
			Syntax:java.lang.String
		}
		uwcFallbackContactCity {
			Include:true
			Name:uwcFallbackContactCity
			Sample:SPANGEREID
			Syntax:java.lang.String
		}
		uwcFallbackContactCountry {
			Include:true
			Name:uwcFallbackContactCountry
			Sample:AF
			Syntax:java.lang.String
		}
		uwcFallbackContactName {
			Include:true
			Name:uwcFallbackContactName
			Sample:Grete and Stein Gahre
			Syntax:java.lang.String
		}
		uwcFallbackContactPostalCode {
			Include:true
			Name:uwcFallbackContactPostalCode
			Sample:4521
			Syntax:java.lang.String
		}
		uwcFallbackContactProvince {
			Include:true
			Name:uwcFallbackContactProvince
			Sample:Quetzalcuatl
			Syntax:java.lang.String
		}
		uwcGender {
			Include:true
			Name:uwcGender
			Sample:Male
			Syntax:java.lang.String
		}
		uwcHomePhoneAreaCode {
			Include:true
			Name:uwcHomePhoneAreaCode
			Sample:5773
			Syntax:java.lang.String
		}
		uwcHomePhoneInternationalCode {
			Include:true
			Name:uwcHomePhoneInternationalCode
			Sample:47
			Syntax:java.lang.String
		}
		uwcHonorific {
			Include:true
			Name:uwcHonorific
			Sample:Ms.
			Syntax:java.lang.String
		}
		uwcICQNumber {
			Include:true
			Name:uwcICQNumber
			Sample:19470147
			Syntax:java.lang.String
		}
		uwcInterest {
			Include:true
			Name:uwcInterest
			Sample:Skiing, canoeing
			Syntax:java.lang.String
		}
		uwcMaritalStatus {
			Include:true
			Name:uwcMaritalStatus
			Sample:single
			Syntax:java.lang.String
		}
		uwcMiddleName {
			Include:true
			Name:uwcMiddleName
			Sample:Haffner
			Syntax:java.lang.String
		}
		uwcNationality {
			Include:true
			Name:uwcNationality
			Sample:Norwegian
			Syntax:java.lang.String
		}
		uwcNotes {
			Include:true
			Name:uwcNotes
			Sample:Not much else to add.
			Syntax:java.lang.String
		}
		uwcOrganisation {
			Include:true
			Name:uwcOrganisation
			Sample:UWC College
			Syntax:java.lang.String
		}
		uwcPartnerName {
			Include:true
			Name:uwcPartnerName
			Sample:Sidsel
			Syntax:java.lang.String
		}
		uwcPictureURI {
			Include:true
			Name:uwcPictureURI
			Sample:http://w3.rcnuwc.uwc.org/people/photos/nc00dati.jpg
			Syntax:java.lang.String
		}
		uwcPostalCode {
			Include:true
			Name:uwcPostalCode
			Sample:0777
			Syntax:java.lang.String
		}
		uwcPreferredAddress {
			Include:true
			Name:uwcPreferredAddress
			Sample:Home
			Syntax:java.lang.String
		}
		uwcProfessions {
			Include:true
			Name:uwcProfessions
			Sample:Entrepenuer
			Syntax:java.lang.String
		}
		uwcProvince {
			Include:true
			Name:uwcProvince
			Sample:Status
			Syntax:java.lang.String
		}
		uwcPublication {
			Include:true
			Name:uwcPublication
			Sample:Ester, T. (1998). Cool thoughts, warm words. New York: Random House
			Syntax:java.lang.String
		}
		uwcRoles {
			Include:true
			Name:uwcRoles
			Sample:Former Student
			Syntax:java.lang.String
		}
		uwcSalutation {
			Include:true
			Name:uwcSalutation
			Sample:Ted
			Syntax:java.lang.String
		}
		uwcSpokenLanguages {
			Include:true
			Name:uwcSpokenLanguages
			Sample:no
			Syntax:java.lang.String
		}
		uwcStartYear {
			Include:true
			Name:uwcStartYear
			Sample:1991
			Syntax:java.lang.String
		}
		uwcTelephoneNumberAreaCode {
			Include:true
			Name:uwcTelephoneNumberAreaCode
			Sample:99
			Syntax:java.lang.String
		}
		uwcTelephoneNumberInternationalCode {
			Include:true
			Name:uwcTelephoneNumberInternationalCode
			Sample:47
			Syntax:java.lang.String
		}
		uwcWebSite {
			Include:true
			Name:uwcWebSite
			Sample:http://no.uwc.org/network/
			Syntax:java.lang.String
		}
		uwcWorkCity {
			Include:true
			Name:uwcWorkCity
			Sample:OSLO
			Syntax:java.lang.String
		}
		uwcWorkCountry {
			Include:true
			Name:uwcWorkCountry
			Sample:AF
			Syntax:java.lang.String
		}
		uwcWorkHistory {
			Include:true
			Name:uwcWorkHistory
			Sample:1980-82 Sales Manager
			Syntax:java.lang.String
		}
		uwcWorkPostalCode {
			Include:true
			Name:uwcWorkPostalCode
			Sample:0158
			Syntax:java.lang.String
		}
		uwcWorkProvince {
			Include:true
			Name:uwcWorkProvince
			Sample:Ohio
			Syntax:java.lang.String
		}
		uwcWorkURI {
			Include:true
			Name:uwcWorkURI
			Sample:www.redcross.no
			Syntax:java.lang.String
		}
	}
	compute_changes:false
	connectorConfig {
		automapADPassword:false
		connectorFlags:{deleteEmptyStrings}
		debug:false
		inheritFrom:metamerge.LDAP
		jndiExtraProviderParams:
		ldapAuthenticationMethod:Simple
		ldapPageSize:0
		ldapPassword:worthington
		ldapReferrals:follow
		ldapSearchBase:o=uwc
		ldapSearchFilter:cn=*
		ldapSizeLimit:0
		ldapTimeLimit:0
		ldapUrl:ldap://freedom1.uwc.org:389
		ldapUseSSL:false
		ldapUsername:cn=manager,o=uwc
		ldapVLVPageSize:0
	}
	description:Config to access freedom
	link [
		$dn:=|$$dn
	]
	linkScript:ret.filter = "";
	override {
	}
	parserConfig {
	}
	proxyConfig {
	}
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	type:Lookup
	updateAttributes {
	}
[end]

[connectors LDAPUnity]
	ALEvent {
		addonly_fail {
			active:false
			flow:
			name:AddOnly fail
		}
		addonly_ok {
			active:false
			flow:
			name:AddOnly ok
		}
		after_add {
			active:false
			flow:
			name:After Add
		}
		after_close {
			active:false
			flow:
			name:After close
		}
		after_delete {
			active:false
			flow:
			name:After delete
		}
		after_getnext {
			active:false
			flow:
			name:After GetNext
		}
		after_initialize {
			active:false
			flow:
			name:After initialize
		}
		after_lookup {
			active:false
			flow:
			name:After lookup
		}
		after_modify {
			active:false
			flow:
			name:After Modify
		}
		after_selectEntries {
			active:false
			flow:
			name:After selectEntries
		}
		after_update {
			active:false
			flow:
			name:After update
		}
		before_add {
			active:false
			flow:
			name:Before Add
		}
		before_close {
			active:false
			flow:
			name:Before close
		}
		before_delete {
			active:false
			flow:
			name:Before delete
		}
		before_getnext {
			active:false
			flow:
			name:Before GetNext
		}
		before_initialize {
			active:false
			flow:
			name:Before initialize
		}
		before_lookup {
			active:true
			flow:if (work.getString("oper") != "lookup") {\n\ttask.logmsg ("Not a lookup operation");\n\tsystem.ignoreEntry();\n}
			name:Before lookup
		}
		before_modify {
			active:true
			flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
			name:Before Modify
		}
		before_selectEntries {
			active:false
			flow:
			name:Before selectEntries
		}
		before_update {
			active:false
			flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
			name:Before update
		}
		default_fail {
			active:false
			flow:
			name:Default fail
		}
		default_ok {
			active:false
			flow:
			name:Default ok
		}
		delete_fail {
			active:false
			flow:
			name:Fail Delete
		}
		delete_ok {
			active:false
			flow:
			name:OK Delete
		}
		get_fail {
			active:false
			flow:
			name:GetNext fail
		}
		get_ok {
			active:false
			flow:
			name:GetNext ok
		}
		lookup_fail {
			active:true
			flow:main.logmsg  ("Unable to find entry");\nldapError = "AS unable to find entry based on your submitted data";\n
			name:Lookup fail
		}
		lookup_multiple {
			active:true
			flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "Not found";\nwork.setAttribute ("status", "entry not found");\n
			name:Multiple Entries Found
		}
		lookup_ok {
			active:true
			flow:task.logmsg ("Entry found on UNITY");
			name:Lookup ok
		}
		modify_apply {
			active:false
			flow:
			name:Before Applying Changes
		}
		modify_nochange {
			active:false
			flow:
			name:Modify No changes
		}
		override_add {
			active:false
			flow:
			name:Override add
		}
		override_delete {
			active:false
			flow:
			name:Override delete
		}
		override_getnext {
			active:false
			flow:
			name:Override getnext
		}
		override_lookup {
			active:false
			flow:
			name:Override lookup
		}
		override_modify {
			active:false
			flow:
			name:Override modify
		}
		override_update {
			active:false
			flow:
			name:Override update
		}
		update_fail {
			active:true
			flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
			name:Update fail
		}
		update_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		update_ok {
			active:true
			flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
			name:Update ok
		}
	}
	attributeList {
	}
	compute_changes:false
	connectorConfig {
		automapADPassword:false
		debug:false
		inheritFrom:metamerge.LDAP
		ldapAuthenticationMethod:Simple
		ldapPageSize:0
		ldapPassword:worthington
		ldapReferrals:follow
		ldapSearchBase:o=uwc
		ldapSearchFilter:cn=*
		ldapSizeLimit:0
		ldapTimeLimit:0
		ldapUrl:ldap://unity1.uwc.org
		ldapUseSSL:false
		ldapUsername:cn=root
		ldapVLVPageSize:0
	}
	description:Config to access unity
	link [
		gn:=|$gn
		sn:=|$sn
		uwccollege:=|$uwccollege
		uwcstartyear:=|$uwcstartyear
	]
	linkScript:ret.filter = "";
	override {
	}
	parserConfig {
	}
	proxyConfig {
	}
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	type:Lookup
	updateAttributes {
		* {
			add:false
			flow:ret.value = conn.getAttribute("*");
			mod:false
		}
	}
[end]

[connectors LDAPUnityFailedRegistrations]
	ALEvent {
		addonly_fail {
			active:false
			flow:
			name:AddOnly fail
		}
		addonly_ok {
			active:false
			flow:
			name:AddOnly ok
		}
		after_add {
			active:false
			flow:
			name:After Add
		}
		after_close {
			active:false
			flow:
			name:After close
		}
		after_delete {
			active:false
			flow:
			name:After delete
		}
		after_getnext {
			active:false
			flow:
			name:After GetNext
		}
		after_initialize {
			active:false
			flow:
			name:After initialize
		}
		after_lookup {
			active:false
			flow:
			name:After lookup
		}
		after_modify {
			active:false
			flow:
			name:After Modify
		}
		after_selectEntries {
			active:false
			flow:
			name:After selectEntries
		}
		after_update {
			active:false
			flow:
			name:After update
		}
		before_add {
			active:false
			flow:
			name:Before Add
		}
		before_close {
			active:false
			flow:
			name:Before close
		}
		before_delete {
			active:false
			flow:
			name:Before delete
		}
		before_getnext {
			active:false
			flow:
			name:Before GetNext
		}
		before_initialize {
			active:false
			flow:
			name:Before initialize
		}
		before_lookup {
			active:false
			flow:
			name:Before lookup
		}
		before_modify {
			active:false
			flow:
			name:Before Modify
		}
		before_selectEntries {
			active:false
			flow:
			name:Before selectEntries
		}
		before_update {
			active:false
			flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
			name:Before update
		}
		default_fail {
			active:true
			flow:error = system.sendMail("integrator@uwc.net",\n\t"christian@uwc.net",\n\t"An error occured",\n\t"\\nHere's what the error object says.\\n\\n" + error.getString("message"),\n\t"");\n\nif (work.getProperty("after_default_onError") != null)\n{\n\tif (work.getProperty("after_default_onError").equalsIgnoreCase("skip"))\n\t\tsystem.skipEntry();\n\twork.setProperty("after_default_onError", null);\n}
			name:Default fail
		}
		default_ok {
			active:false
			flow:
			name:Default ok
		}
		delete_fail {
			active:false
			flow:
			name:Fail Delete
		}
		delete_ok {
			active:false
			flow:
			name:OK Delete
		}
		get_fail {
			active:false
			flow:
			name:GetNext fail
		}
		get_ok {
			active:false
			flow:
			name:GetNext ok
		}
		lookup_fail {
			active:false
			flow:
			name:Lookup fail
		}
		lookup_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		lookup_ok {
			active:false
			flow:
			name:Lookup ok
		}
		modify_apply {
			active:false
			flow:
			name:Before Applying Changes
		}
		modify_nochange {
			active:false
			flow:
			name:Modify No changes
		}
		override_add {
			active:false
			flow:
			name:Override add
		}
		override_delete {
			active:false
			flow:
			name:Override delete
		}
		override_getnext {
			active:false
			flow:
			name:Override getnext
		}
		override_lookup {
			active:false
			flow:
			name:Override lookup
		}
		override_modify {
			active:false
			flow:
			name:Override modify
		}
		override_update {
			active:false
			flow:
			name:Override update
		}
		update_fail {
			active:false
			flow:
			name:Update fail
		}
		update_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		update_ok {
			active:false
			flow:
			name:Update ok
		}
	}
	attributeList {
	}
	compute_changes:false
	connectorConfig {
		automapADPassword:false
		debug:false
		inheritFrom:metamerge.LDAP
		ldapAuthenticationMethod:Simple
		ldapPageSize:0
		ldapPassword:worthington
		ldapReferrals:follow
		ldapSearchBase:cn=Failed Registrations
		ldapSearchFilter:cn=*
		ldapSizeLimit:0
		ldapTimeLimit:0
		ldapUrl:ldap://unity1.uwc.org:389
		ldapUseSSL:false
		ldapUsername:cn=root
		ldapVLVPageSize:0
	}
	description:Config to access unity
	link [
		gn:=|$gn
		sn:=|$sn
		uwccollege:=|$uwccollege
		uwcstartyear:=|$uwcstartyear
	]
	linkScript:ret.filter = "";
	override {
	}
	parserConfig {
	}
	proxyConfig {
	}
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	type:Passive
	updateAttributes {
		* {
			add:false
			flow:ret.value = conn.getAttribute("*");
			mod:false
		}
	}
[end]

[connectors OpenLDAP_Auth]
	ALEvent {
		before_lookup {
			active:false
			flow:main.dump(work);\ntask.dumpEntry(work);
		}
		lookup_fail {
			active:true
			flow:main.logmsg("an error occured");\ntask.logmsg("an error occured different");
		}
	}
	allow_duplicates:false
	attributeList {
	}
	connectorConfig {
		debug:true
		includeFiles:
		inheritFrom:metamerge.ScriptConnector
		script:// LDAP base dn where employees are to be authenticated\nvar authBase = "o=uwc";\n\nfunction selectEntries()\n{\n}\n\nfunction getNextEntry ()\n{\n}\n\nfunction modEntry ()\n{\n}\n\nfunction deleteEntry ()\n{\n}\n\nfunction putEntry ()\n{\n\n}\n\nfunction findEntry () \n{\n\tconne = system.getConnector ("metamerge.LDAP");\n\tconne.setParam("ldapUrl","ldap://www.uwc.net:389");\n\n\tuid = system.remove("\\\\/,", search.getCriteria(0).value.toString());\n\tpasswd = search.getCriteria ( 1 ).value;\n\n\tconne.setParam ("ldapUsername", "uid=" + uid + ", " + authBase);\n\t\n\tif (search.getCriteria ( 1 ).value == "")\n\t{\n\t\tresult.setStatus(0);\n\t\treturn;\n\t}\n\n\tconne.setParam ("ldapPassword", passwd);\n\n\tconne.setParam ("ldapSearchBase", authBase);\n\tconne.setParam("ldapSearchScope","onelevel");\n\n\tconne.initialize ( null );\n\tconnector.logmsg("Connection initialization successfull!");\n\n\t// RBAC\n\tmyEntry = conne.findEntry("uid", uid);\n\tconnector.logmsg(myEntry);\n\n// MM 4.6.8 might be needed for this to work\n\tif (myEntry.getAttribute("migCategory") != null )\n\t{\n\n\t\tif (myEntry.getAttribute("migCategory").hasValueIC("migUser") || myEntry.getAttribute("migCategory").hasValueIC("migAdmin"))\n\t\t{\n\t\t\tresult.setStatus(1);\n\t\t\tentry.setAttribute("ModifierUID", uid);\n\t\t\tentry.setAttribute("ModifierFullName", myEntry.getAttribute("cn"));\n\t\t\treturn;\n\t\t}\n\t}\n\t\n\tresult.setStatus(0);\n}\t\n
		scriptEngine:javascript
	}
	include:true
	link [
		uid:=|$username
		password:=|$password
	]
	linkScript:ret.filter = "";
	parserConfig {
	}
	source:C:\\Atelier\\Metamerge\\UWC\\userAutoReg\\in_vpn\\in-VPN.cfg
	type:Lookup
	updateAttributes {
		ModifierFullName {
			add:false
			flow:ret.value = conn.getAttribute("ModifierFullName");
			mod:false
		}
		ModifierUID {
			add:false
			flow:ret.value = conn.getAttribute("ModifierUID");
			mod:false
		}
	}
[end]

[connectors WebConnector]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		debug:false
		httpPort:8899
		inheritFrom:metamerge.HTTPServer
		parser:
	}
	description:Web connector
	parserConfig {
		inheritFrom:
	}
	updateAttributes {
	}
[end]

[connectors metamerge.BTreeObjectDB]
	connectorConfig {
		connectorType:com.architech.connector.BTree
	}
	description:BTree storing Java objects
[end]

[connectors metamerge.COMPort]
	connectorConfig {
		commPort:COM1
		connectorType:com.architech.connector.rscCOMPort
	}
	description:Communications port
[end]

[connectors metamerge.CommandLine]
	connectorConfig {
		commandLine:
		connectorType:com.architech.connector.rscCommandLine
		parser:metamerge.CSV
	}
	description:Command line input/output
[end]

[connectors metamerge.EMI_UCP]
	connectorConfig {
		accessNumber:+47 90002198
		commPort:COM1
		connectorType:com.architech.connector.rscEmiUcpConnector
		meta.description:EMI/UCP Short Message Service protocol
	}
	description:SMS service
[end]

[connectors metamerge.FileSystem]
	connectorConfig {
		connectorType:com.architech.connector.rscFileConnector
		fileMode:input
		filePath:
		parser:
	}
	description:File System
[end]

[connectors metamerge.GSMPhone]
	connectorConfig {
		commPort:COM1,19200
		connectorType:com.architech.connector.SiemensS25
		meta.description:Should work with Ericsson, Nokia and Motorola as well
	}
	description:GSM Phonebook
[end]

[connectors metamerge.HTTPClient]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorType:com.architech.connector.HTTPConnector
		debug:false
		method:GET
		parser:
		password:
		url:http://localhost
		username:anonymous
	}
	parserConfig {
		inheritFrom:
	}
	updateAttributes {
	}
[end]

[connectors metamerge.HTTPServer]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorType:com.architech.connector.rscHttpServer
		debug:false
		httpPort:80
		parser:
	}
	description:Server side HTTP
	parserConfig {
		inheritFrom:
	}
	updateAttributes {
	}
[end]

[connectors metamerge.JDBC]
	connectorConfig {
		connectorFlags:{ignoreFieldErrors}
		connectorType:com.architech.connector.rscJdbc
		jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
		jdbcExposeNullValues:true
		jdbcLogin:
		jdbcMetaQuery:
		jdbcPassword:
		jdbcSelect:
		jdbcSessionParameters:
		jdbcSource:
		jdbcTable:
	}
	description:JDBC & ODBC
[end]

[connectors metamerge.JMS]
	connectorConfig {
		connectorType:com.architech.connector.rscJMSConnector
		jms.broker:hostname:port
		jms.mode:publisher or subscriber
		jms.password:<no value>
		jms.topic:<no value>
		jms.username:<no value>
		meta.description:Java Message Server client
	}
	description:Java Message Service
[end]

[connectors metamerge.LDAP]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorFlags:{deleteEmptyStrings}
		connectorType:com.architech.connector.rscLdap
		debug:false
		ldapAuthenticationMethod:Anonymous
		ldapPassword:
		ldapPump:AZ
		ldapSearchBase:<o=orgname>
		ldapSearchFilter:cn=*
		ldapSearchScope:subtree
		ldapUrl:ldap://localhost:389
		ldapUseSSL:false
		ldapUsername:
		userComment:
	}
	description:Lightweight Directory Access Protocol (v2/v3)
	parserConfig {
	}
	updateAttributes {
	}
[end]

[connectors metamerge.MSOutlook]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorType:com.architech.connector.rscScriptConnector
		debug:false
		includeFiles:
		script:'\n' This script implements all the necessary functions for accessing\n' the Contacts register in MS Outlook.\n'\n\nset ol = CreateObject ("Outlook.Application")\nset ns = ol.GetNameSpace ("MAPI")\nset contacts = ns.getDefaultFolder (10)\n\ncounter = 1\n\nsub selectEntries()\n\tcounter = 1\nend sub\n\nsub getNextEntry ()\n\n\t' End of items?\n\tif counter > contacts.Items.count then\n\t\tresult.setStatus 0\n\t\tresult.setMessage "End of input"\n\t\texit sub\n\tend if\n\n\t' Populate entry\n\tpopulateEntry entry, contacts.Items.Item(counter)\n\n\t' Increase current position\n\tcounter = counter + 1\nend sub\n\nsub modEntry ()\n\tflt = "[" & search.getFirstCriteriaName() & "] = '" & search.getFirstCriteriaValue() & "'"\n\tset item = contacts.Items.Find ( flt )\n\tif item is nothing then\n\t\tresult.setStatus 2\n\t\tresult.setMessage "Not found"\n\t\texit sub\n\tend if\n\t\n\tpopulateItem entry, item\n\titem.Save\nend sub\n\nsub deleteEntry ()\n\tflt = "[" & search.getFirstCriteriaName() & "] = '" & search.getFirstCriteriaValue() & "'"\n\tset item = contacts.Items.Find ( flt )\n\tif item is nothing then\n\t\tresult.setStatus 2\n\t\tresult.setMessage "Not found"\n\t\texit sub\n\tend if\n\n\titem.Delete\nend sub\n\nsub findEntry ()\n\tflt = "[" & search.getFirstCriteriaName() & "] = '" & search.getFirstCriteriaValue() & "'"\n\tset item = contacts.Items.Find ( flt )\n\tif item is nothing then\n\t\tresult.setStatus 2\n\t\tresult.setMessage "Not found" + "\\n --->["& flt & "]"\n\telse\n\t\tpopulateEntry entry, item\n\tend if\nend sub\n\nsub putEntry ()\n\n\tset item = contacts.Items.Add\n\tif item is nothing then\n\t\tresult.setStatus 2\n\t\tresult.setMessage "Unabled to create olContacts(2) item"\n\t\texit sub\n\tend if\n\tpopulateItem entry, item\n\titem.Save\nend sub\n\nsub populateEntry (entry, item)\n\n\tentry.setAttribute "FullName", item.FullName\n\tentry.setAttribute "Email1Address", item.Email1Address\n\tentry.setAttribute "Categories", item.Categories\n\tentry.setAttribute "Birthday", item.Birthday\n\tentry.setAttribute "LastModificationTime", item.LastModificationTime\n\n\tentry.setAttribute "BusinessAddress", item.BusinessAddress\n\tentry.setAttribute "BusinessTelephoneNumber", item.BusinessTelephoneNumber\n\tentry.setAttribute "BusinessFaxNumber", item.BusinessFaxNumber\n\n\tentry.setAttribute "HomeAddress", item.HomeAddress\n\tentry.setAttribute "HomeTelephoneNumber", item.HomeTelephoneNumber\n\tentry.setAttribute "HomeFaxNumber", item.HomeFaxNumber\n\n\tentry.setAttribute "MobileTelephoneNumber", item.MobileTelephoneNumber\n\tentry.setAttribute "JobTitle", item.JobTitle\nend sub\n\nsub populateItem (entry, item)\n\titem.FullName = entry.getString("FullName")\n\titem.FileAs = entry.getString("FullName")\nend sub\n\n\n\n
		scriptEngine:vbscript
	}
	description:MSOutlook VBScript
	parserConfig {
	}
	proxyConfig {
	}
	updateAttributes {
	}
[end]

[connectors metamerge.NetscapeChangelog]
	connectorConfig {
		connectorType:com.architech.connector.rscNetscapeChangelog
		ldapSearchBase:cn=changelog
	}
	description:Netscape/iPlanet changelog iterator
[end]

[connectors metamerge.Notes]
	connectorConfig {
		connectorType:com.architech.connector.rscLotusDomino
		dominoHost:
		dominoLogin:
		dominoPassword:
		notesDatabase:names.nsf
		notesSearchView:
		notesSelection:
		notesServer:
	}
	description:Lotus Domino V5
[end]

[connectors metamerge.Oracle8]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorFlags:{ignoreFieldErrors}
		connectorType:com.architech.connector.rscJdbc
		debug:false
		jdbcDriver:oracle.jdbc.driver.OracleDriver
		jdbcExposeNullValues:true
		jdbcLogin:
		jdbcMetaQuery:
		jdbcPassword:
		jdbcSelect:
		jdbcSessionParameters:
		jdbcSource:dbc:oracle:oci8:@DATABASE
		jdbcTable:
	}
	description:JDBC connector with Oracle OCI configuration
	parserConfig {
	}
[end]

[connectors metamerge.Oracle8Thin]
	connectorConfig {
		connectorFlags:{ignoreFieldErrors}
		connectorType:com.architech.connector.rscJdbc
		jdbcDriver:oracle.jdbc.driver.OracleDriver
		jdbcExposeNullValues:true
		jdbcLogin:
		jdbcMetaQuery:
		jdbcPassword:
		jdbcSelect:
		jdbcSessionParameters:
		jdbcSource:jdbc:oracle:thin:@127.0.0.1:1521:DATABASE
		jdbcTable:<TableName>
	}
	description:JDBC connector with Oracle Net8 configuration
[end]

[connectors metamerge.Publisher]
	connectorConfig {
		connectorType:com.architech.connector.rscConsumerProducerConnector
		publisher:Name for global/shared connector
	}
[end]

[connectors metamerge.SMPP]
	connectorConfig {
		connectorType:com.architech.connector.rscSMPPConnector
		meta.description:SMPP Short Message Service (Aldiscon)
		sms.connectorMode:transmitter or receiver
		sms.dest_gsm_npi:<no value>
		sms.dest_gsm_ton:<no value>
		sms.password:<no value>
		sms.remote:tcp,localhost,5016
		sms.src_gsm_npi:<no value>
		sms.src_gsm_ton:<no value>
		sms.systemID:<no value>
		sms.systemType:<no value>
		sms.version:<no value>
	}
	description:SMS service provider protocol
[end]

[connectors metamerge.SNMPTrap]
	connectorConfig {
		connectorType:com.architech.connector.rscSnmp
		port:162
		timeout:0
	}
	description:SNMP traps
[end]

[connectors metamerge.Script1]
	connectorConfig {
		connectorType:com.architech.connector.rscScriptConnector
		script:// Sample connector\n// Place intialiazation code before function declarations.\n//\nvar counter = 0;\n\nfunction selectEntries()\n{\n}\n\nfunction getNextEntry ()\n{\n\tif (counter > 100) {\n\t\tresult.setStatus (1);\n\t\tresult.setMessage ("End of input");\n\t\treturn;\n\t}\n\n\tentry.setAttribute ("counter", counter);\n\tcounter++;\n}\n\nfunction modEntry ()\n{\n}\n\nfunction deleteEntry ()\n{\n}\n\nfunction findEntry ()\n{\n}\n\nfunction putEntry ()\n{\n}\n
		scriptEngine:JavaScript
	}
	description:Roll your own connector using scripts
[end]

[connectors metamerge.TCP]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorType:com.architech.connector.TCPConnector
		debug:false
		parser:
		serverMode:false
		tcpHost:
		tcpPort:
	}
	parserConfig {
		inheritFrom:
	}
	updateAttributes {
	}
[end]

[connectors metamerge.URLConnector]
	ALEvent {
	}
	attributeList {
	}
	connectorConfig {
		connectorType:com.architech.connector.rscURLConnector
		debug:false
		parser:
		url:ftp://
	}
	description:URL (e.g. http, ftp)
	parserConfig {
		inheritFrom:
	}
	updateAttributes {
	}
[end]

[connectors unityRead]
	ALEvent {
		addonly_fail {
			active:false
			flow:
			name:AddOnly fail
		}
		addonly_ok {
			active:false
			flow:
			name:AddOnly ok
		}
		after_add {
			active:false
			flow:
			name:After Add
		}
		after_close {
			active:false
			flow:
			name:After close
		}
		after_delete {
			active:false
			flow:
			name:After delete
		}
		after_getnext {
			active:false
			flow:
			name:After GetNext
		}
		after_initialize {
			active:false
			flow:
			name:After initialize
		}
		after_lookup {
			active:false
			flow:
			name:After lookup
		}
		after_modify {
			active:false
			flow:
			name:After Modify
		}
		after_selectEntries {
			active:false
			flow:
			name:After selectEntries
		}
		after_update {
			active:false
			flow:
			name:After update
		}
		before_add {
			active:false
			flow:
			name:Before Add
		}
		before_close {
			active:false
			flow:
			name:Before close
		}
		before_delete {
			active:false
			flow:
			name:Before delete
		}
		before_getnext {
			active:false
			flow:
			name:Before GetNext
		}
		before_initialize {
			active:false
			flow:
			name:Before initialize
		}
		before_lookup {
			active:true
			flow:if (work.getString("oper") != "read") {\n\ttask.logmsg ("Not a read operation");\n\tsystem.ignoreEntry();\n}
			name:Before lookup
		}
		before_modify {
			active:true
			flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
			name:Before Modify
		}
		before_selectEntries {
			active:false
			flow:
			name:Before selectEntries
		}
		before_update {
			active:false
			flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
			name:Before update
		}
		default_fail {
			active:false
			flow:
			name:Default fail
		}
		default_ok {
			active:false
			flow:
			name:Default ok
		}
		delete_fail {
			active:false
			flow:
			name:Fail Delete
		}
		delete_ok {
			active:false
			flow:
			name:OK Delete
		}
		get_fail {
			active:false
			flow:
			name:GetNext fail
		}
		get_ok {
			active:false
			flow:
			name:GetNext ok
		}
		lookup_fail {
			active:true
			flow:main.logmsg  ("Unable to find entry");\nldapError = "AS unable to find entry based on your submitted data(3)";\n
			name:Lookup fail
		}
		lookup_multiple {
			active:true
			flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "Not found";\nwork.setAttribute ("status", "entry not found");\n
			name:Multiple Entries Found
		}
		lookup_ok {
			active:true
			flow:task.logmsg ("Entry READ on UNITY");\n\n//task.logmsg ("additional mappings");\n\nif (work.getAttribute("uwccollegesurname") == null)\n\twork.setAttribute("uwccollegesurname",work.getString("sn"));\n\nif (work.getAttribute("uwccollegefirstname") == null)\n\twork.setAttribute("uwccollegefirstname",work.getString("gn"));\n\n//work.setAttribute("uwcrole",work.getString("title"));\n//work.setAttribute("title","");\n\n//if (work.getAttribute("uwcmiddlename") == null)\n//{\n//\twork.setAttribute("uwcmiddlename",work.getString("initials"));\n//}\n\n//if (work.getAttribute("mail") == null)\n//\twork.setAttribute("mail", work.getString("gn") + "." + work.getString("sn") + "@uwc.net");\n\n//for (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n//{\n//\tif (work.getAttribute("homepostaladdress") == null)\n//\t{\n//\t\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Home"))\n//\t\t\twork.setAttribute("homepostaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n\n//\tif (work.getAttribute("postaladdress") == null)\n//\t{\n//\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Work")) \n//\t\twork.setAttribute("postaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n//}\n//task.logmsg ("Mappings done");\n\n\n
			name:Lookup ok
		}
		modify_apply {
			active:false
			flow:
			name:Before Applying Changes
		}
		modify_nochange {
			active:false
			flow:
			name:Modify No changes
		}
		override_add {
			active:false
			flow:
			name:Override add
		}
		override_delete {
			active:false
			flow:
			name:Override delete
		}
		override_getnext {
			active:false
			flow:
			name:Override getnext
		}
		override_lookup {
			active:false
			flow:
			name:Override lookup
		}
		override_modify {
			active:false
			flow:
			name:Override modify
		}
		override_update {
			active:false
			flow:
			name:Override update
		}
		update_fail {
			active:true
			flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
			name:Update fail
		}
		update_multiple {
			active:false
			flow:
			name:Multiple Entries Found
		}
		update_ok {
			active:true
			flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
			name:Update ok
		}
	}
	attributeList {
		$dn {
			Include:true
			Name:$dn
			Sample:uid=AC65MKNA,o=uwc
		}
		cn {
			Include:true
			Name:cn
			Sample:Michael Knagenhjelm
		}
		facsimileTelephoneNumber {
			Include:true
			Name:facsimileTelephoneNumber
			Sample:+47 67 59 16 19
		}
		filePathname {
			Include:true
			Name:filePathname
			Sample:/var/ISS/mail/uwc/ac65mkna
		}
		gn {
			Include:true
			Name:gn
			Sample:Michael
		}
		homePhone {
			Include:true
			Name:homePhone
			Sample:+47 67 59 16 17
		}
		initials {
			Include:true
			Name:initials
			Sample:Haffner
		}
		mail {
			Include:true
			Name:mail
			Sample:m@uwc.net
		}
		mhsMessageStoreName {
			Include:true
			Name:mhsMessageStoreName
			Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
		}
		objectClass {
			Include:true
			Name:objectClass
			Sample:top
		}
		preferredRfc822Originator {
			Include:true
			Name:preferredRfc822Originator
			Sample:mhk@uwc.net
		}
		preferredRfc822Recipient {
			Include:true
			Name:preferredRfc822Recipient
			Sample:mhk@uwc.net
		}
		sn {
			Include:true
			Name:sn
			Sample:Knagenhjelm
		}
		telephoneNumber {
			Include:true
			Name:telephoneNumber
			Sample:+47 92 03 20 11
		}
		title {
			Include:true
			Name:title
			Sample:Board Member
		}
		uid {
			Include:true
			Name:uid
			Sample:AC65MKNA
		}
		userPassword {
			Include:true
			Name:userPassword
			Sample:[B@32cf5
		}
		uwcCity {
			Include:true
			Name:uwcCity
			Sample:Bekkestua
		}
		uwcCollege {
			Include:true
			Name:uwcCollege
			Sample:AC
		}
		uwcCountry {
			Include:true
			Name:uwcCountry
			Sample:Norway
		}
		uwcEducation {
			Include:true
			Name:uwcEducation
			Sample:Economics!London Sch. of Economics
		}
		uwcEndYear {
			Include:true
			Name:uwcEndYear
			Sample:67
		}
		uwcLocation {
			Include:true
			Name:uwcLocation
			Sample:Home: Griniveien 406,1340 Bekkestua, Norway
		}
		uwcSkills {
			Include:true
			Name:uwcSkills
			Sample:Education: Economics at London Sch. of Economics
		}
		uwcStartYear {
			Include:true
			Name:uwcStartYear
			Sample:65
		}
	}
	compute_changes:false
	connectorConfig {
		inheritFrom:LDAPUnity
		ldapSearchFilter:objectclass=uwcperson
	}
	link [
		$dn:=|$dn
	]
	linkScript:ret.filter = "";
	override {
	}
	parserConfig {
	}
	proxyConfig {
	}
	type:Lookup
	updateAttributes {
		* {
			add:false
			flow:ret.value = conn.getAttribute("*");
			mod:false
		}
	}
[end]

[libraries userFunctions]
	bettersystem:com.architech.christian.betterSystem
	system:com.architech.function.userFunctions2
[end]

[listener AdminPort]
	description:Admin Port
	enabled:true
	inheritFrom:metamerge.AdminPort
	password:uwcclient
	tcp_port:9988
[end]

[listener Handle account creation request]
	AuthConnector:OpenLDAP_Auth
	AuthRealm:metamerge-integrator
	Port:8898
	actionList [
		{
			actions [
				{
					action:Dump Event Object
				}
				{
					action:Custom Script
					script:var auth = event.getProperty("auth.entry");\nevent.setAttribute("ModifierUID", auth.getString("ModifierUID"));\nevent.setAttribute("ModifierFullName", auth.getString("ModifierFullName"));
					scriptEngine:JavaScript
				}
				{
					action:Run AssemblyLine
					assemblyLine:Update Directory
					internallog:false
					parameter:(none)
					wait:true
					workentry:true
				}
				{
					action:Custom Script
					script:entry = event.getProperty("assemblyline.result");\n\n// RETURN THE CORRECT PAGE\nif (entry.getAttribute("file_to_send_back") != null)\n\tf = entry.getString("file_to_send_back");\n\nif (!f || f == "" || f == "/") f = "index.htm";\nsendFileOut(f, event);\n
					scriptEngine:JavaScript
				}
			]
			actionsFail [
				{
					action:Custom Script
					script:var f = event.getString("http.base");\nmain.logmsg ("Request for file: " + f );\n\nif (!f || f == "" || f == "/") f = "index.htm";\nsendFileOut(f, event);
					scriptEngine:JavaScript
				}
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.action
					negate:false
					oper:hasValue
				}
			]
			consumeEvent:false
			errorHandlers [
				{
					action:Custom Script
					script:f = "fatal_error.htm";\nsendFileOut(f, event);\n
					scriptEngine:JavaScript
				}
			]
			matchAny:false
			name:Handle
		}
	]
	debug:true
	description:Respond to HTTP and create account
	enabled:true
	headersAsProperties:false
	include:true
	inheritFrom:metamerge.HTTPEventHandler
	prolog:// ------------- HTML OPTIONS --------------\nvar file_to_send_base = "/home/uwcnet/html/NEWUSER_AUTOREG/";\n\nfunction sendFileOut(f, event)\n{\n\tf = java.lang.String(f);\n\tf = f.trim();\n\n\tif (f.indexOf("..") != -1)\n\t{\n\t\tmain.logmsg ("Attack by using .. in filename: " + f);\n\t\tevent.setAttribute ("http.status", "NOT FOUND");\n\t\treturn;\n\t}\n\t\n\tfile = new java.io.File ( file_to_send_base + f);\n\n\tif ( file.isFile() ) \n\t{\n\t\tevent.setAttribute ("http.body", new java.io.File(file));\n\t\tevent.setAttribute ("http.content-type", "text/html");\n\n\t\t// SUPPORT GIF FILES\n\t\tif (f.endsWith(".gif"))\n\t\t{\n\t\t\tevent.setAttribute ("http.content-type", "image/gif");\n\t\t\tevent.setAttribute ("http.accept-ranges", "bytes");\n\t\t}\n\n\t\t// main.logmsg ("Sending file: " + file.getAbsolutePath());\n\t\t} \n\telse \n\t{\n\t\tmain.logmsg ("Requested file: " + f + " does not exist");\n\t\tevent.setAttribute ("http.status", "NOT FOUND");\n\t}\n}
	source:C:\\Atelier\\Metamerge\\UWC\\userAutoReg\\in_vpn\\in-VPN.cfg
	tcp.port:81
	useSSL:false
	userComment:
[end]

[listener Handle form submission]
	AuthConnector:(none)
	AuthRealm:metamerge-integrator
	Port:8080
	actionList [
		{
			actions [
				{
					action:Dump Event Object
				}
				{
					action:Custom Script
					script:var myAttrs = event.getAttributeNames();\n\ntask.logmsg("entry size" + event.size());\n\nfor (i = 0; i < event.size(); i++)\n{\n\tvar myAttr = event.getAttribute(myAttrs[i]);\n\tfor (j = 0; j < myAttr.size(); j++)\n\t{\n\t\tmyAttr.setValue(j, system.translateString(myAttr.getValue(j).toString(), "UTF8", null));\n\t}\n\tevent.setAttribute(myAttrs[i], myAttr);\n}\n
					scriptEngine:JavaScript
				}
				{
					action:Run AssemblyLine
					assemblyLine:SendEmail
					internallog:false
					parameter:(none)
					wait:true
					workentry:true
				}
				{
					action:Custom Script
					script:entry = event.getProperty("assemblyline.result");\n\n// RETURN THE CORRECT PAGE\nif (entry.getAttribute("file_to_send_back") != null)\n\tf = entry.getString("file_to_send_back");\n\nif (!f || f == "" || f == "/") f = "contactform.html";\nsendFileOut(f, event);
					scriptEngine:JavaScript
				}
			]
			actionsFail [
				{
					action:Custom Script
					script:var f = event.getString("http.base");\nmain.logmsg ("Request for file: " + f );\n\nif (!f || f == "" || f == "/") f = "contactform.html";\n\nsendFileOut(f, event);
					scriptEngine:JavaScript
				}
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.action
					negate:false
					oper:hasValue
				}
			]
			consumeEvent:false
			errorHandlers [
				{
					action:Custom Script
					script:f = "fatal_error.htm";\nsendFileOut(f, event);
					scriptEngine:JavaScript
				}
				{
					action:Custom Script
					script:error = system.sendMail("integrator@uwc.net",\n\t"christian@uwc.net",\n\t"A fatal error occured",\n\t"",\n\t"");
					scriptEngine:JavaScript
				}
			]
			matchAny:false
			name:Handle request
		}
	]
	debug:true
	description:Respond to HTTP request and sends feedback email
	enabled:true
	headersAsProperties:false
	include:true
	inheritFrom:metamerge.HTTPEventHandler
	prolog:// ------------- HTML OPTIONS --------------\nvar file_to_send_first_base = "/home/uwcnet/html/NEWUSER_AUTOREG/";\nvar file_to_send_second_base = "/home/uwcnet/html/NEWUSER/";\n\nfunction sendFileOut(f, event)\n{\n\tf = java.lang.String(f);\n\tf = f.trim();\n\n\tif (f.indexOf("..") != -1)\n\t{\n\t\tmain.logmsg ("Attack by using .. in filename: " + f);\n\t\tevent.setAttribute ("http.status", "NOT FOUND");\n\t\tevent.setAttribute ("http.body", new java.io.File(file_to_send_first_base + not_found_page));\n\t\treturn;\n\t}\n\t\n\tf1 = file_to_send_first_base + f;\n\tfile = new java.io.File ( f1 );\n\t\n\tif ( ! file.isFile() ) \n\t{\n\t\t// main.logmsg ("The requested file is not in " + file_to_send_first_base + " , trying from " + file_to_send_second_base);\n\t\tf2 = file_to_send_second_base + f;\n\t\tfile = new java.io.File ( f2 );\n\t}\n\n\tif ( file.isFile() ) \n\t{\n//\t\tif (f.equals("contact.html"))\n//\t\t\tevent.setAttribute ("http.redirect", "http://www.metamerge.com/contact.html");\n\n\t\tevent.setAttribute ("http.body", new java.io.File(file));\n\t\tevent.setAttribute ("http.content-type", "text/html");\n\n\t\t// SUPPORT GIF FILES\n\t\tif (f.endsWith(".gif"))\n\t\t{\n\t\t\tevent.setAttribute ("http.content-type", "image/gif");\n\t\t\tevent.setAttribute ("http.accept-ranges", "bytes");\n\t\t}\n\n\t\t// main.logmsg ("Sending file: " + file.getAbsolutePath());\n\t} \n\telse \n\t{\n\t\tmain.logmsg ("Requested file: " + f + " does not exist");\n\t\tevent.setAttribute ("http.status", "NOT FOUND");\n\t\tevent.setAttribute ("http.body", new java.io.File(file_to_send_first_base + not_found_page));\n\t}\n}
	source:C:\\Atelier\\Metamerge\\UWC\\userAutoReg\\out_vpn\\out_vpn\\out-VPN.cfg
	tcp.port:80
	useSSL:false
	userComment:
[end]

[listener Web]
	connector:metamerge.HTTPServer
	description:TCP listener
	enabled:false
	inheritFrom:metamerge.TCPListener
	script:task.logmsg ("Web connector from " + socket.toString() );\n\ne = connector.getNextEntry();\nconnector.pushback (e);\n\noper = e.getString("oper");\nal = null;\n\nif (oper == "lookup") {\n\ttask.logmsg ("Start AL uwc.MIG.user.lookup");\n\tal = main.startAL ("uwc.MIG.user.lookup", connector);\n}\n\n\nif (oper == "read") {\n\ttask.logmsg ("Start AL uwc.MIG.user.record.read");\n\tal = main.startAL ("uwc.MIG.user.record.read", connector);\n}\n\nif (oper == "update") {\n\ttask.logmsg ("Start AL uwc.MIG.user.record.modify");\n\tal = main.startAL ("uwc.MIG.user.record.modify", connector);\n}\n\nif (oper == "add_user_schema_subtree") {\n\ttask.logmsg ("Start AL uwc.MIG.user.schema.create");\n\tal = main.startAL ("uwc.MIG.user.schema.create", connector);\n}\n\n\nif (al == null) {\n\tsocket.close();\n}\n
	scriptEngine:JavaScript
	tcp_port:8899
[end]

[listener Web2]
	actionList [
		{
			actions [
				{
					action:Apply Parser
					mode:Read
					parser:UWCParser
					readFrom:event.inputstream
					writeTo:
				}
				{
					action:Dump Event Object
				}
				{
					action:Custom Script
					script:var myAttrs = event.getAttributeNames();\n\ntask.logmsg("entry size" + event.size());\n\nfor (i = 0; i < event.size(); i++)\n{\n\tvar myAttr = event.getAttribute(myAttrs[i]);\n\tfor (j = 0; j < myAttr.size(); j++)\n\t{\n\t\tmyAttr.setValue(j, system.translateString(myAttr.getValue(j).toString(), "UTF8", null));\n\t}\n\tevent.setAttribute(myAttrs[i], myAttr);\n}\n
					scriptEngine:JavaScript
				}
			]
			actionsFail [
			]
			conditions [
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Parse input
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.record.read
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"read"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Read record on Unity
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.mail.read
					internallog:false
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"read_email"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Read mail on Freedom
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.lookup
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"lookup"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Lookup record in Unity
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.record.modify
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"update"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Update record
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.mail.modify
					internallog:false
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"update_email"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Update email
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.record.add
					internallog:false
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"add"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Add record
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.schema.create
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"add_user_schema_subtree"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Create userdefault subtree
		}
		{
			actions [
				{
					action:Run AssemblyLine
					assemblyLine:uwc.MIG2.user.password.modify
					internallog:false
					parameter:(none)
					wait:true
					workentry:true
				}
			]
			actionsFail [
			]
			conditions [
				{
					casesensitive:false
					name:entry.http.qs.oper
					negate:false
					oper:equals
					value:"sync_password"
				}
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:sync password
		}
		{
			actions [
				{
					action:Dump Event Object
				}
				{
					action:Apply Parser
					mode:Write
					parser:UWCParser
					readFrom:entry.*
					writeTo:event.outputstream
				}
			]
			actionsFail [
			]
			conditions [
			]
			consumeEvent:false
			errorHandlers [
			]
			matchAny:false
			name:Output
		}
	]
	debug:false
	description:TCP Event Handler
	enabled:true
	inheritFrom:metamerge.TCPEventHandler
	tcp.port:8899
[end]

[listener metamerge.AdminPort]
	class:com.architech.trigger.rstAdminPort
	description:Use with admin tool's open server etc...
	enabled:false
	password:secret
	tcp_port:99
[end]

[listener metamerge.ConnectorEventHandler]
	actionList [
	]
	class:com.architech.switchboard.ConnectorSwitchboard
	connector:
	debug:false
	description:Event handler using a connector for iterations
	enabled:false
	pollInterval:60
[end]

[listener metamerge.Cronjob]
	assemblyLine:Assembly Line to run at every interval
	class:com.architech.trigger.rstTimer
	description:Simple crontab style timer thread
	enabled:false
	schedule:<month> <day> <weekday> <hour> <minute> (* = any)
	script://\n//\tThe schedule parameter decides when this timer runs. The format\t\n//\tis cron style and specified as follows:\n//\n//\t<month> <day> <weekday> <hour> <minute>\n//\n//\tMont\t= 0 .. 11\n//\tDay\t\t= 0 .. 30\n//\tWeekday = 0 .. 6\n//\tHour\t= 0 .. 23\n//\tMinute\t= 0 .. 59\n//\n//\tEnter an asterix (*) to specify any value.\n//\n//\tSamples:\n//\n//\t* * 5 22 0\t\t- Run every friday at 22:00 hours\n//\t* 3 * 22 0\t\t- Run every 3rd of each month at 22:00 hours\n//\n//\tWhen the timer occurs the function "ontimer()" is called with no\n//\tparameters. You reconfigure the timer on the fly by setting the\n//\tschedule parameter from this function. I.e.:\n//\n//\tfunction ontimer()\n//\t{\n//\t\ttimer.setParam ("schedule", "* * * 22 0");\n//\t}\n//\n\nfunction ontimer()\n{\n\t// main.startAL(....)\n}\n
	scriptEngine:javascript
[end]

[listener metamerge.FTPPoller]
	class:com.architech.trigger.rstGenericThread
	description:Sample generic thread
	enabled:false
	script:\nmain.logmsg ("This message is logged to the console");\ntask.logmsg ("This message is logged to the logfile");\n\nvar host = "ftp.hostname.com";\nvar user = "user";\nvar pass = "pass";\n\nwhile (true)\n{\n\tmain.logmsg ("Check FTP files");\n\n\t// Get an FTP object\n\tvar ftp = system.getFTP ();\n\n\tmain.logmsg ("Connect to " + host);\n\tif (!ftp.connect ( host, user, pass ))\n\t{\n\t\ttask.logmsg ("Login failed: " + ftp.getLastError());\n\t\tbreak;\n\t}\n\n\tmain.logmsg ("Change director to /home/user");\n\tif (!ftp.cd ("/home/user")) {\n\t\ttask.logmsg ("Change directory failed: " + ftp.getLastError());\n\t\tbreak;\n\t}\n\n\tmain.logmsg ("Directory listing");\n\tvar list = ftp.dir();\n\tif (list == null) {\n\t\ttask.logmsg ("Directory listing failed: " + ftp.getLastError());\n\t\tbreak;\n\t}\n\n\tcounter = 0;\n\n\twhile (list.next()) {\n\n\t\ttask.logmsg ("Next file: " + list.getName() + ", type=" + list.getType());\n\n\t\t// Files are type=2 and directories are type=1\n\t\tif (list.getType() == 2)\n\t\t{\n\t\t\tftp.setBinary();\n\t\t\tif (!ftp.get (list.getName(), list.getName())) {\n\t\t\t\tmain.logmsg ("Transfer failed: " + ftp.getLastError());\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t//ftp.remove (list.getName());\n\t\t}\n\n\t}\n\n\tftp.close();\n\ttask.sleep (45);\n}\n\nvar err = ftp.getLastError();\nif (err != null) {\n\ttask.logmsg ("Type of error: " + err.getClass().getName());\n\ttask.logmsg ("Message: " + err.getMessage());\n\ttask.logmsg ("Stack trace");\n\terr.printStackTrace();\n}\n\nmain.logmsg ("Script failed because: " + ftp.getLastError());\n\n
	scriptEngine:JavaScript
[end]

[listener metamerge.GenericThread]
	class:com.architech.trigger.rstGenericThread
	description:Generic thread
	enabled:false
	script:
	scriptEngine:JavaScript
[end]

[listener metamerge.LDAPEventHandler]
	actionList [
	]
	class:com.architech.switchboard.LDAPSwitchboard
	connectorFlags:
	debug:false
	description:Event handler for LDAP events
	enabled:false
	ldapAuthenticationMethod:Anonymous
	ldapPassword:
	ldapSearchBase:
	ldapSearchFilter:cn=*
	ldapSearchScope:subtree
	ldapUrl:ldap://hostname:389
	ldapUseSSL:false
	ldapUsername:
	tcp.port:
	userComment:
[end]

[listener metamerge.LDAPListener]
	assemblyLine:
	class:com.architech.trigger.rstLDAPListener
	description:LDAP event listener
	enabled:false
	ldapConnector:
	onEvent:Call User Defined Script
	script:\n//\n// This script is called by the LDAP listener for events that happen\n// on the LDAP connector's selected objects.\n//\n\ntask.logmsg ("LDAP Listener Started");\n\nfunction idleproc ()\n{\n\ttask.logmsg ("IDLE " + task.getParam("idleInterval") + " seconds");\n}\n\nfunction objAdded (entry)\n{\n\ttask.logmsg ("Added: " + entry.getString("$dn"));\n}\n\nfunction objRemoved (entry)\n{\n\ttask.logmsg ("Removed: " + entry.getString("$dn"));\n}\n\nfunction objRenamed (oldentry, newentry)\n{\n\ttask.logmsg ("Renamed: " + oldentry.getString("$dn"));\n}\n\nfunction objModified (entry)\n{\n\ttask.logmsg ("Modified: " + entry.getString("$dn"));\n}\n\nfunction handleError (err)\n{\n\ttask.logmsg ("ERROR: " + err);\n}\n}
	scriptEngine:JavaScript
[end]

[listener metamerge.MailboxEventHandler]
	actionList [
	]
	class:com.architech.switchboard.MailboxSwitchboard
	description:POP/IMAP Mailbox Event Handler
	enabled:false
	mailFolder:INBOX
	mailPassword:
	mailProtocol:pop3
	mailServer:mail.dot.com
	mailUser:username
[end]

[listener metamerge.OutlookMailbox]
	class:com.architech.trigger.rstGenericThread
	description:Sample generic thread
	enabled:false
	script:\nset ol = CreateObject("Outlook.Application")\nset ns = ol.GetNameSpace("MAPI")\nset ct = ns.GetDefaultFolder (10)\n\nwhile true\n\n\tmain.logmsg "Number Items Now: " & ct.Items.Count\n\n\tmain.logmsg "Sleeping ...."\n\n\ttask.sleep 10\n\nwend
	scriptEngine:VBScript
[end]

[listener metamerge.TCPEventHandler]
	actionList [
	]
	class:com.architech.switchboard.TCPSwitchboard
	debug:false
	description:Event handler for incoming TCP connections
	enabled:false
	epilog:
	prolog:
	tcp.port:
[end]

[listener metamerge.TCPListener]
	class:com.architech.trigger.rstTrigger
	connector:
	description:TCP Port listener
	enabled:false
	script:\n//\n// This is a simple listener that listens on a TCP port and\n// communicates with the peer using the "inp" and "out" objects.\n//\n\nout.println ("Hello");\n\nwhile ( (f = inp.readLine()) != null) {\n\tout.println("You said: " + f);\n\tif (f == "quit") {\n\t\tbreak;\n\t}\n\tif (f == "start") {\n\t\tf = inp.readLine();\n\t\tmain.startAL (f);\n\t\twriteln ("Started AL: " + f);\n\t}\n}\n\nsocket.close();\n
	scriptEngine:JavaScript
	tcp_port:99
[end]

[parsertypes UWCParser]
	parserConfig {
		debug:true
		headersAsProperties:false
		inheritFrom:metamerge.HTTP
	}
[end]

[parsertypes headmasters]
	parserConfig {
		inheritFrom:metamerge.ScriptParser1
		script:var college = "";\nvar uwc = "";\n\nfunction readEntry ()\n{\n\tvar str = inp.readLine();\n\n\tif (str == null) {\n\t\tresult.setStatus (0);\n\t\tresult.setMessage ("End of input");\n\t\treturn;\n\t}\n\n\tdash = str.indexOf("-");\n\n\tif (dash == -1) {\n\t\tx = str.indexOf(":");\n\t\tif (x != -1) {\n\t\t\tuwc = str.substring(0, x);\n\t\t\tcollege = str.substring(x+1);\n\t\t}\n\t\treadEntry();\n\t\treturn;\n\t}\n\n\tstartyear = str.substring(0, dash);\n\tspace = str.indexOf(" ");\n\tendyear = str.substring (dash + 1, space);\n\tif (endyear == "?")\n\t\tendyear = "0";\n\t\n\tentry.setAttribute ("startyear", startyear);\n\tentry.setAttribute ("endyear", endyear);\n\tentry.setAttribute ("college", college);\n\tentry.setAttribute ("uwccollege", uwc);\n\tentry.setAttribute ("headmaster", str.substring(space + 1));\n}\n
	}
[end]

[parsertypes metamerge.CDS-EDB]
	description:Syntegra X.500 EDB files
	parserConfig {
		class:com.architech.parser.rspEDBFile
		description:Control Data X.500 "EDB" type files
	}
[end]

[parsertypes metamerge.CSV]
	description:Comma Separated
	parserConfig {
		class:com.architech.parser.rspCSVParser
		csvColumnSeparator:;
		csvColumns:
	}
[end]

[parsertypes metamerge.Fixed]
	description:Fixed length
	parserConfig {
		class:com.architech.parser.rspFixed
		fixedCols:name,start,size\nname2,start,size\netc ....
		trimValues:true
	}
[end]

[parsertypes metamerge.LDIF]
	description:LDIF
	parserConfig {
		class:com.architech.parser.rspLdif
	}
[end]

[parsertypes metamerge.NTAccountMgr]
	description:This script processes the output of "ntaccmgr.exe /d"
	parserConfig {
		class:com.architech.parser.rspScriptParser
		includeFiles:
		script://\n// This script processes the output of "ntaccmgr.exe /d". Use this parser with the command\n// line connector.\n//\n\nfunction writeEntry ()\n{\n}\n\nfunction readEntry ()\n{\n\tvar str = inp.readLine();\n\n\t// We return EOF when we find global/local groups\n\tif (str == "[Global]" || str == "[Local]") {\n\t\tresult.setStatus (0);\n\t\treturn;\n\t}\n\n\t// We only process User accounts\n\tif (str == "[User]") {\n\t\tstr = inp.readLine();\n\t}\n\n\tvar arr = splitstr(str);\n\tentry.setAttribute ("user", arr[0]);\n\tentry.setAttribute ("name", arr[1]);\n\tentry.setAttribute ("description", arr[3]);\n\tentry.setAttribute ("homePath", arr[5]);\n\tentry.setAttribute ("profilePath", arr[6]);\n\tentry.setAttribute ("logonScript", arr[7]);\n}\n\n//\n// Split string into an array (String.split is not implemented)\n//\n\nfunction splitstr (str)\n{\n\tvar i = 0;\n\tvar j = 0;\n\tvar arr = new Array();\n\n\ti = str.indexOf(",");\n\twhile (i != -1) {\n\t\tarr[j++] = str.substring(0, i);\n\t\tstr = str.substring(i+1);\n\t\ti = str.indexOf(",");\n\t}\n\tarr[j] = str;\n\treturn arr;\n}\n
		scriptEngine:javascript
	}
[end]

[parsertypes metamerge.Perl1]
	description:Sample script parser in perl
	parserConfig {
		class:com.architech.parser.rspScriptParser
		includeFiles:
		script:#\n# Init code before subs\n#\n\n$counter = 0;\n\nsub writeEntry\n{\n\t$context->logmsg ("MyScript: writeEntry");\n\t$out->write ("record header\\n");\n\t$out->write ( $entry->getString("counter") );\n}\n\nsub readEntry\n{\n\tif ($counter > 100) {\n\t\t$result->setStatus (1);\n\t\t$result->setMessage ("End of input");\n\t\treturn;\n\t}\n\t$entry->setAttribute("counter", "Item " . $counter);\n}\n
		scriptEngine:perlscript
	}
[end]

[parsertypes metamerge.ScriptParser1]
	description:Sample script parser in Javascript
	parserConfig {
		class:com.architech.parser.rspScriptParser
		includeFiles:
		script://\n// This is a simple parser that returns one line at a time from\n// the input stream.\n//\n\nvar counter = 0;\n\nfunction writeEntry ()\n{\n\tout.write (entry.getString("line"));\n\tout.newLine();\n}\n\nfunction readEntry ()\n{\n\tvar str = inp.readLine();\n\n\tif (str == null) {\n\t\tresult.setStatus (0);\n\t\tresult.setMessage ("End of input");\n\t\treturn;\n\t}\n\n\tcounter++;\n\n\tentry.setAttribute ("line", str);\n\tresult.setStatus (1);\n}\n
		scriptEngine:JavaScript
	}
[end]

[parsertypes metamerge.Simple]
	description:Simple proprietary format
	parserConfig {
		class:com.architech.parser.rspSimpleParser
		description:Parses <CRLF> separated records with "field:value" lines
	}
[end]

[parsertypes metamerge.XML]
	description:Simple XML two-level parser
	parserConfig {
		class:com.architech.parser.rspXml
		xmlEntryTag:Entry
		xmlRootTag:DocRoot
		xmlValueTag:ValueTag
	}
[end]

[properties java]
	com.architech.certificatesFile:rs.ks
	com.architech.rotatelogs:3
	mail.smtp.host:mail.uwc.net
	rsadmin.attribute.nullBehavior:Delete
	rsadmin.browser:explorer {0}
	rsadmin.color.title:255:255:150
	rsadmin.editor.font:Courier
	rsadmin.editor.fontsize:12
	rsadmin.enableforms:true
	rsadmin.encryption:false
	rsadmin.gui:V4
	rsadmin.javacmd.reuse:true
	rsadmin.statusbar:true
	rsadmin.toolbar:true
[end]

[scripts Constants]
	autoInclude:true
	include:true
	includeFiles:
	script:// LDAP SETTINGS FOR ACCOUNT CREATION \n\n// LDAP base dn where users are to be inserted\nvar base = "o=uwc";\n\nvar file_to_send_back = "error.htm";\n\nvar not_found_page = "404.htm";
	scriptEngine:JavaScript
	source:C:\\Atelier\\Metamerge\\UWC\\userAutoReg\\out_vpn\\out_vpn\\out-VPN.cfg
[end]

[scripts Global]
	autoInclude:true
	includeFiles:
	script://\n// This script is automatically included in all assembly lines with JavaScript selected\n//\n\nfunction today ()\n{\n\tvar dt = new java.util.Date();\n\treturn dt.toString();\n}\n
	scriptEngine:javascript
[end]

[task Check email in new system]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		Read
		Check
		dmp
	]
	components {
		Check {
			ALEvent {
				lookup_fail {
					active:false
				}
				lookup_multiple {
					active:false
				}
				lookup_ok {
					active:true
					flow:if  (work.getAttribute("mail").hasValueIC("@uwcac.uwc.org") || work.getAttribute("preferredRfc822Recipient").hasValueIC("@uwcac.uwc.org"))\n{\n\tmain.dump(work);\n\tcount = count + 1;\n}
				}
			}
			allow_duplicates:true
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=mi98sann,o=uwc
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:SRINIVAS Annamalai
					Syntax:java.lang.String
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/mi98sann
					Syntax:java.lang.String
				}
				gn {
					Include:true
					Name:gn
					Sample:SRINIVAS
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:srinivas.annamalai@uwc.net
					Syntax:java.lang.String
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=iss-unity.uwc.org, cn=Application Services, o=UWC
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Annamalai
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:mi98sann
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@277bd2
					Syntax:ByteArray
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:MI
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1998
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:LDAPUnity
				ldapSearchScope:onelevel
				ldapUrl:ldap://unity.uwc.org
				ldapUsername:cn=administrator,o=uwc
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				mail {
					add:false
					flow:if (conn.getAttribute("mail") == null)\n\tret.value =  java.lang.String("");\nelse\n\tret.value =  conn.getAttribute("mail");
					mod:false
				}
				preferredRfc822Recipient {
					add:false
					flow:if (conn.getAttribute("preferredRfc822Recipient") == null)\n\tret.value = java.lang.String("");\nelse\n\tret.value =  conn.getAttribute("preferredRfc822Recipient");
					mod:false
				}
			}
		}
		Read {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:ac65mkna@uwc.net
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapReturnAttributes:mail\nmailAlternateAddress
				ldapSearchFilter:uid=*
				ldapSearchScope:onelevel
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				Current_email_alias {
					add:false
					flow:ret.value = conn.getAttribute("mailAlternateAddress");
					mod:false
				}
				Current_mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
			}
		}
		dmp {
			enabled:false
			script:
			type:Script
		}
	}
	debug:false
	epilog:main.logmsg("count is: " + count.toString())
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:var count = 0;
	scriptEngine:JavaScript
	verbose:100
[end]

[task Clean HKC]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		fix
	]
	components {
		fix {
			ALEvent {
				before_modify {
					active:true
					flow:task.dumpEntry(conn);
				}
				before_update {
					active:true
					flow:task.dumpEntry(work);
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:true
					flow:old = work.getString("uid");\nret.value = "uid=lp" + old.substring(3) + ",o=uwc";\n
					mod:true
				}
				mail {
					add:true
					flow:old = work.getString("uid");\nret.value = "lp" + old.substring(3) + "@uwc.net";\n
					mod:true
				}
				mailMessageStore {
					add:true
					flow:old = work.getString("uid").toLowerCase();\nret.value = "lp" + old.substring(3);\n
					mod:true
				}
				uid {
					add:true
					flow:old = work.getString("uid");\nret.value = "lp" + old.substring(3);\n
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = "LP";
					mod:true
				}
			}
		}
		read {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=hkc93fshe,o=uwc
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Faisal Sheikh
					Syntax:java.lang.String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:localdelivery
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:51 14 4147
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Faisal
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:6135621855
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:400 Steward St., Ottawa,ON Canada
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:hkc93fshe@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:faisal.sheikh@uwc.net
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:reiko717@beige.ocn.ne.jp
					Syntax:java.lang.String
				}
				mailMessageStore {
					Include:true
					Name:mailMessageStore
					Sample:hk99ryam
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:22/F Prince's Bldg., Hong Kong, Hong Kong
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Sheikh
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:91741820
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Student-Computer Engrg.
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:hkc93fshe
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@69d0cc
					Syntax:ByteArray
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Reiko
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Ottawa
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:HKC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Faisal
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Sheikh
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Canada
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Law!Durham University
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:Jalal
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1993
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchFilter:uid=hkc*
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				mailMessageStore {
					add:false
					flow:ret.value = conn.getAttribute("mailMessageStore");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
				uwcCollege {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollege");
					mod:false
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task Clean T.61]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		unity
		unityupdate
	]
	components {
		unity {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchFilter:uwcCity={T.61}*
				ldapSearchScope:onelevel
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		unityupdate {
			ALEvent {
				before_add {
					active:false
					flow:
				}
				before_execute {
					active:false
					flow:
				}
				before_modify {
					active:true
					flow:var attrnames = work.getAttributeNames();\nskip = true;\n\nfor ( i = 0; i < attrnames.length; i++ ) \n{\n\tattr = work.getAttribute ( attrnames[i] );\n\tconnattr = conn.getAttribute ( attrnames[i] );\n\tfor ( j = 0; j < attr.size(); j++ )\n\t{\n\t\tif ((attrnames[i] != "userPassword") && (attr.getValue(j).startsWith("{T.61}")))\n\t\t{\n\t\t\tconnattr.setValue(j, attr.getValue(j).substring(6));\n\t\t\tskip = false;\n\t\t}\n\t}\n}\n\nif (skip) system.skipEntry();
				}
				update_fail {
					active:false
					flow:
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				connectorType:@unity
				inheritFrom:@unity
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				* {
					add:false
					flow:ret.value = work.getAttribute("*");
					mod:true
				}
			}
		}
	}
	debug:false
	description:Fix attributes wrongly encoded
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
	verbose:600
[end]

[task Clean college codes]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		fix
	]
	components {
		fix {
			ALEvent {
				before_modify {
					active:true
					flow:task.dumpEntry(conn);
				}
				before_update {
					active:true
					flow:main.dump(work);
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				connectorType:@read
				inheritFrom:@read
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				uwcCollege {
					add:true
					flow:ret.value = "SE";
					mod:true
				}
			}
		}
		read {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=hkc93fshe,o=uwc
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Faisal Sheikh
					Syntax:java.lang.String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:localdelivery
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:51 14 4147
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Faisal
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:6135621855
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:400 Steward St., Ottawa,ON Canada
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:hkc93fshe@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:faisal.sheikh@uwc.net
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:reiko717@beige.ocn.ne.jp
					Syntax:java.lang.String
				}
				mailMessageStore {
					Include:true
					Name:mailMessageStore
					Sample:hk99ryam
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:22/F Prince's Bldg., Hong Kong, Hong Kong
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Sheikh
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:91741820
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Student-Computer Engrg.
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:hkc93fshe
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@69d0cc
					Syntax:ByteArray
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Reiko
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Ottawa
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:HKC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Faisal
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Sheikh
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Canada
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Law!Durham University
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:Jalal
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1993
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:uwcCollege=SEA
				ldapSearchScope:onelevel
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task Freedom Dump]
	IOSettings {
	}
	automapattributes:true
	componentlist [
		read
		write
	]
	components {
		read {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:objectclass=*
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
			}
		}
		write {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:output
				filePath:D:\\Atelier\\Metamerge\\UWC\\freedom-250602.ldif
				inheritFrom:metamerge.FileSystem
				parser:metamerge.LDIF
			}
			link [
			]
			override {
			}
			parserConfig {
				debug:false
				inheritFrom:metamerge.LDIF
				ldifDNAttributeName:$dn
			}
			type:AddOnly
			updateAttributes {
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task Freedom bulk Load]
	IOSettings {
	}
	automapattributes:true
	componentlist [
		read
		add
	]
	components {
		add {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:objectclass=*
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:AddOnly
			updateAttributes {
			}
		}
		read {
			ALEvent {
				get_fail {
					active:true
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:migattributename=uwcCity,ou=systemdefaults,ou=schema,o=uwc
					Syntax:java.lang.String
				}
				MigAttributeDisplayName {
					Include:true
					Name:MigAttributeDisplayName
					Sample:City:
					Syntax:java.lang.String
				}
				MigAttributeName {
					Include:true
					Name:MigAttributeName
					Sample:uwcCity
					Syntax:java.lang.String
				}
				MigAttributeOID {
					Include:true
					Name:MigAttributeOID
					Sample:1.2.826.0.1341.1.12
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGuser
					Syntax:java.lang.String
				}
				MigChallengeQuestion {
					Include:true
					Name:MigChallengeQuestion
					Sample:What is the name of the street where you grew up?
					Syntax:java.lang.String
				}
				MigChallengeQuestionAnswer {
					Include:true
					Name:MigChallengeQuestionAnswer
					Sample:langlia
					Syntax:java.lang.String
				}
				MigCustomizedClass {
					Include:true
					Name:MigCustomizedClass
					Sample:uwcNetwork
					Syntax:java.lang.String
				}
				MigDataRefresh {
					Include:true
					Name:MigDataRefresh
					Sample:dynamic
					Syntax:java.lang.String
				}
				MigDataSearchFilter {
					Include:true
					Name:MigDataSearchFilter
					Sample:(&(objectclass=uwcperson)(uwcCollege=*xx*))
					Syntax:java.lang.String
				}
				MigDefaultCriteriaClass {
					Include:true
					Name:MigDefaultCriteriaClass
					Sample:uwcNetwork
					Syntax:java.lang.String
				}
				MigDescription {
					Include:true
					Name:MigDescription
					Sample:The town or city where you live.
					Syntax:java.lang.String
				}
				MigDisplayType {
					Include:true
					Name:MigDisplayType
					Sample:readonlytext
					Syntax:java.lang.String
				}
				MigEditType {
					Include:true
					Name:MigEditType
					Sample:onelinetextbox
					Syntax:java.lang.String
				}
				MigExampleValue {
					Include:true
					Name:MigExampleValue
					Sample:San Marcos
					Syntax:java.lang.String
				}
				MigGroupDisplayName {
					Include:true
					Name:MigGroupDisplayName
					Sample:XX graduates
					Syntax:java.lang.String
				}
				MigGroupName {
					Include:true
					Name:MigGroupName
					Sample:xxgraduates
					Syntax:java.lang.String
				}
				MigLastModifiedBy {
					Include:true
					Name:MigLastModifiedBy
					Sample:ac93fhol
					Syntax:java.lang.String
				}
				MigLastModifiedDate {
					Include:true
					Name:MigLastModifiedDate
					Sample:20020507135047PDT
					Syntax:java.lang.String
				}
				MigModifiedData {
					Include:true
					Name:MigModifiedData
					Sample:uid=SE86DTAR,o=uwc
					Syntax:java.lang.String
				}
				MigSearchCriteriaClass {
					Include:true
					Name:MigSearchCriteriaClass
					Sample:uwcNetwork
					Syntax:java.lang.String
				}
				MigSearchResultClass {
					Include:true
					Name:MigSearchResultClass
					Sample:uwcNetwork
					Syntax:java.lang.String
				}
				MigSearchType {
					Include:true
					Name:MigSearchType
					Sample:onelinetextbox
					Syntax:java.lang.String
				}
				MigUsingClass {
					Include:true
					Name:MigUsingClass
					Sample:uwcNetwork
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Fredrik Ljone Holst
					Syntax:java.lang.String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:nombox
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+1 (999) 555-1213
					Syntax:java.lang.String
				}
				generationQualifier {
					Include:true
					Name:generationQualifier
					Sample:asd
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Fredrik
					Syntax:java.lang.String
				}
				headMaster {
					Include:true
					Name:headMaster
					Sample:David Wilkinson
					Syntax:java.lang.String
				}
				hmCollege {
					Include:true
					Name:hmCollege
					Sample:MAHINDRA COLLEGE
					Syntax:java.lang.String
				}
				hmEndYear {
					Include:true
					Name:hmEndYear
					Sample:9999
					Syntax:java.lang.String
				}
				hmStartYear {
					Include:true
					Name:hmStartYear
					Sample:1997
					Syntax:java.lang.String
				}
				hmUwcCollege {
					Include:true
					Name:hmUwcCollege
					Sample:MI
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:555-1212
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:c/o Dalen $Odins gate 3
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:http://www.ljone.net/
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:AC93FHOL@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:fredrik@uwc.net
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:fredrik@uwc.se
					Syntax:java.lang.String
				}
				mailHost {
					Include:true
					Name:mailHost
					Sample:www.uwc.org
					Syntax:java.lang.String
				}
				mailMessageStore {
					Include:true
					Name:mailMessageStore
					Sample:ac78jlaw
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47 4085 8050
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:Pikop Andropov
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:MIGAttribute
					Syntax:java.lang.String
				}
				ou {
					Include:true
					Name:ou
					Sample:userdefaults
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:23009 East Voss $ Suite 5602
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:eo
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Holst
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:77 70 44 00
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Delivery Carrier
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:pc86bwal
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:{crypt}Fk4mC9M7RXUro
					Syntax:java.lang.String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Teddy
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:I was born at a very early age. I was pretty shy and liked to read. Then I went to a UWC and that opened my eyes to the joys of dancing and sailing. I became a professional Ukranian dancer, before taking up my new career of software testing for the UWC.
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:19760806
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:Barney (b:04 February 1988)
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Fredrik
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Holst
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:NO
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:B. Sc.
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:London School of Economics
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economist
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:Plaza Las Americas 334$Zona Rosadita
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:Chichicastenango
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:GT
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:Haywood U. Buzoff
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:C448
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:Quetzalcuatl
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:999
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:1
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:ICQ: 8675309
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:finding bugs $scuba diving $hiking
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:married
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:Ljone
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:Not much else to add.
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:Other/Friend of UWC
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Isabelle Ringing
					Syntax:java.lang.String
				}
				uwcPictureURI {
					Include:true
					Name:uwcPictureURI
					Sample:http://www.uwc.org/graphics/demo_pic03.gif
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:N-0266
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Tester
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:Status
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:Ester, T. (1998). Cool thoughts, warm words. New York: Random House
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Crashtest Dummy
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ted
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:om
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1993
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:99
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:http://no.uwc.org/network/
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:NO
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:Compaq: bug finder 1998-2000$The House of Ribs: chef 1989-1998
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:30998-1223
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Ohio
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://pikopandropov.com
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				fileMode:input
				filePath:D:\\Atelier\\Metamerge\\UWC\\freedom-230502.ldif
				inheritFrom:metamerge.FileSystem
				parser:metamerge.LDIF
			}
			link [
			]
			override {
			}
			parserConfig {
				debug:false
				inheritFrom:metamerge.LDIF
				ldifDNAttributeName:$dn
			}
			type:Iterator
			updateAttributes {
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task Intrastore-Email2QMail]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		Read
		dump
		Write
	]
	components {
		Read {
			ALEvent {
				default_ok {
					active:true
					flow:main.logmsg("READ" + work.getString("uid"));
				}
			}
			attributeList {
				cn {
					Include:true
					Name:cn
					Sample:Erin Krekoski
					Syntax:java.lang.String
				}
				createTimestamp {
					Include:true
					Name:createTimestamp
					Sample:19990824065444Z
					Syntax:java.lang.String
				}
				creatorsName {
					Include:true
					Name:creatorsName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				description {
					Include:true
					Name:description
					Sample:History and Philosophy Teacher. Homepage www.bigfoot.com/jonimakivirta
					Syntax:java.lang.String
				}
				dseType {
					Include:true
					Name:dseType
					Sample:entry
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
					Syntax:java.lang.String
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/pc99ekre
					Syntax:java.lang.String
				}
				freeFormName {
					Include:true
					Name:freeFormName
					Sample:Alastair Foreman
					Syntax:java.lang.String
				}
				gn {
					Include:true
					Name:gn
					Sample:Erin
					Syntax:java.lang.String
				}
				gq {
					Include:true
					Name:gq
					Sample:asd
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:22 678971
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:Tennisveien 3E
					Syntax:java.lang.String
				}
				initials {
					Include:true
					Name:initials
					Sample:Alejandra
					Syntax:java.lang.String
				}
				issDeliveryFilters {
					Include:true
					Name:issDeliveryFilters
					Sample:(cn= Mnemonic!issFilterCriteria= AND any recent "7"!issFilterActions= store "my email" ;forward "jhonmnemonic@in-box.net" ;reply "thanks for writing, I will soon get back to you" ;notify "write back")
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:{T.61}http://www.etud.insa-tlse.fr/~chateau/
					Syntax:java.lang.String
				}
				languageIdentifier {
					Include:true
					Name:languageIdentifier
					Sample:no
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:erin.krekoski@uwc.net
					Syntax:java.lang.String
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:o=UWC@cn=Application Services@cn=iss-unity.uwc.org
					Syntax:java.lang.String
				}
				migLastModifiedBy {
					Include:true
					Name:migLastModifiedBy
					Sample:xx00ccha
					Syntax:java.lang.String
				}
				migLastModifiedDate {
					Include:true
					Name:migLastModifiedDate
					Sample:Feb 25, 2002 11:53:47 AM
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47-9003 3738
					Syntax:java.lang.String
				}
				modifiersName {
					Include:true
					Name:modifiersName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				modifyTimestamp {
					Include:true
					Name:modifyTimestamp
					Sample:20001128101515Z
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:MetaMerge AS
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:Akersgaten 43
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:en
					Syntax:java.lang.String
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:kathinka.furst@uwc.net
					Syntax:java.lang.String
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:kathinka_furst@hotmail.com
					Syntax:java.lang.String
				}
				searchBase {
					Include:true
					Name:searchBase
					Sample:o=UWC@cn=Colleges
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Krekoski
					Syntax:java.lang.String
				}
				structuralObjectClass {
					Include:true
					Name:structuralObjectClass
					Sample:cdsIntraStoreUser
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:9003 3738
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Student
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:pc99ekre
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:{CRYPT}AFFWOFQ
					Syntax:java.lang.String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Sara
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:xcxcv
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:530528
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:{T.61}Sofie (1985)$Sara (1988)
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:PC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Janice
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:deBoer
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:{T.61}MBA / Sivil?konom
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:{T.61}Universitre Fribourg, Switzerland$Hxogskolan i Karlstad, Sweden
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:{T.61}Chemistry!
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:ff
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:sdfsdf
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:gg
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:asdasd
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:fdsf
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:5
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:zxczxc
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Skiing, canoeing
					Syntax:java.lang.String
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Ryenbergveien 54,0196 Oslo, Norway
					Syntax:java.lang.String
				}
				uwcMaidenName {
					Include:true
					Name:uwcMaidenName
					Sample:Louisa Ellinor R. Nilsson
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:married
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:sssd
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:qwe
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Sidsel
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:0777
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Entrepenuer
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:sda
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:asd
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Former Student
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Accountancy, Finance, Investment at Fribourg Univ.
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:no
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1999
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:6
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:xcvcv
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:{T.61}1980-82 Sales Manager \\"VingCard Systems\\", London, UK$1983-85 Sales Director (Austria,BeNeLux
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:N-1356
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://www.metamerge.com
					Syntax:java.lang.String
				}
				uwcpictureURI {
					Include:true
					Name:uwcpictureURI
					Sample:fff
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\Metamerge\\UWC\\EDB
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CDS-EDB
			}
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:metamerge.CDS-EDB
			}
			type:Iterator
			updateAttributes {
				filePathname {
					add:false
					flow:ret.value = conn.getAttribute("filePathname");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				objectClass {
					add:false
					flow:ret.value = conn.getAttribute("objectClass");
					mod:false
				}
				preferredRfc822Originator {
					add:false
					flow:ret.value = conn.getAttribute("preferredRfc822Originator");
					mod:false
				}
				preferredRfc822Recipient {
					add:false
					flow:ret.value = conn.getAttribute("preferredRfc822Recipient");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		Write {
			ALEvent {
				addonly_fail {
					active:true
					flow:main.logmsg("FAILED to ADD: " + work.getString("uid"));
				}
				before_add {
					active:true
					flow:task.dumpEntry(conn);
				}
				before_execute {
					active:true
					flow://\tWrite.connector.setParam("ldapSearchBase", "uid=" +  work.getString("uid") + ", o=uwc");\n\nif (initialDN != "")\n\twork.setAttribute("dn", initialDN);\nelse\n\twork.setAttribute("dn", "uid=" +  work.getString("uid") + ", o=uwc");
				}
				before_update {
					active:true
					flow:task.dumpEntry(conn);
				}
				update_fail {
					active:true
					flow:main.logmsg("FAILED to UPDATE: " + work.getString("uid"));\nmain.logmsg(error.getString("message"));
				}
				update_multiple {
					active:true
					flow:main.logmsg("FOUND MULTIPLE : " + work.getString("uid"));\nsystem.skipEntry();
				}
				update_ok {
					active:true
					flow:e = system.newEntry();\n\ne.setAttribute("__initial_dn", work.getString("$dn"));\n\n// heuristics are usefull for optimization\n// if you can tell in advance that the current node does not have children, uncomment the code below\n\n// for example\nif (!work.getAttribute("objectclass").hasValueIC("person"))\n{\n\n\t\tal = main.startAL("DumpDir", e);\n\t\t\n\t\t// the number of active AL may explode but it is possible to limit the number of running AL at a time\n\t\tmain.logmsg ("Number of threads: " + java.lang.Thread.activeCount() );\n\t\t\n\t\tif (java.lang.Thread.activeCount() > max_thread_number )\t\n\t\t    al.join();\n\n}
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				automapADPassword:false
				debug:false
				inheritFrom:metamerge.LDAP
				jndiExtraProviderParams:
				ldapAuthenticationMethod:Simple
				ldapBERTrace:
				ldapPageSize:0
				ldapPassword:worthington
				ldapReferrals:follow
				ldapSearchBase:o=uwc
				ldapSearchFilter:objectclass=*
				ldapSearchScope:subtree
				ldapSizeLimit:0
				ldapTimeLimit:30
				ldapUrl:ldap://63.150.14.89:389
				ldapUsername:cn=manager,o=uwc
				ldapVLVPageSize:0
			}
			inheritAM:
			link [
				$dn:=|$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:AddOnly
			updateAttributes {
				MailHost {
					add:true
					flow:ret.value = "";
					mod:true
				}
				deliveryMode {
					add:true
					flow:fwd = system.newAttribute("forwardonly");\nfwd.addValue("nombox");\n\nif (work.getAttribute("preferredRfc822Recipient") != null)\n\tret.value = fwd;\nelse ret.value = "localdelivery";
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getString("uid") + "@uwc.net";
					mod:true
				}
				mailAlternateAddress {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				mailForwardingAddress {
					add:true
					flow:ret.value = work.getAttribute("preferredRfc822Recipient");
					mod:true
				}
				mailMessageStore {
					add:true
					flow:if (work.getAttribute("filePathname") != null)\n\tret.value = work.getString("uid").toLowerCase();\nelse ret.value = "";
					mod:true
				}
				mailReplyText {
					add:true
					flow:ret.value = "";
					mod:true
				}
				objectClass {
					add:true
					flow:objClass = work.getAttribute("objectclass");\n\noldObjClass = work.getAttribute("objectclass");\nobjClass = system.newAttribute("objectclass");\n\nfor (i = 0; i < oldObjClass.size(); i++)\n{\n\tif (!oldObjClass.getValue(i).equalsIgnoreCase("cdsIntraStoreUser"))\n\t{\n\t\tobjClass.addValue(oldObjClass.getValue(i));\n\t}\n}\n\n/*\nif (!oldObjClass.hasValueIC("inetOrgPerson"))\n{\n\tobjClass.addValue("inetOrgPerson");\n}\n*/\nobjClass.addValue("qmailUser");\n\nret.value = objClass;
					mod:true
				}
			}
		}
		dump {
			attributeList {
			}
			enabled:true
			parserConfig {
			}
			script:if (!work.getAttribute("objectclass").hasValueIC("person"))\n\tsystem.skipEntry();
			type:Script
		}
	}
	debug:false
	description:Fix Email settings after IntraStore2OpenLDAP
	include:true
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:// Set the maximum number of active integrator threads we want to have\nvar max_thread_number = 75;\n\nvar initialDN = "";\n\n// Set the current searchbase to whatever last child was\nif ((work != null) && (work.getString("__initial_dn") != null) )\n{\n\tmain.logmsg ("Kid here");\n\tinitialDN = work.getString("__initial_dn");\t\n\t\n\t// reset the initial work otherwise the addonly connector will be called directly\n\ttask.setWork (null);\n}\nelse main.logmsg ("This is the main thread");\n\n\n
	prolog0:
	scriptEngine:JavaScript
	source:D:\\Atelier\\Metamerge\\UWC\\freedom.uwc.net.100302.cfg
	verbose:600
[end]

[task Intrastore2OpenLDAP]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		Read
		dump
		Write
	]
	components {
		Read {
			ALEvent {
			}
			attributeList {
				cn {
					Include:true
					Name:cn
					Sample:Erin Krekoski
					Syntax:java.lang.String
				}
				createTimestamp {
					Include:true
					Name:createTimestamp
					Sample:19990824065444Z
					Syntax:java.lang.String
				}
				creatorsName {
					Include:true
					Name:creatorsName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				description {
					Include:true
					Name:description
					Sample:History and Philosophy Teacher. Homepage www.bigfoot.com/jonimakivirta
					Syntax:java.lang.String
				}
				dseType {
					Include:true
					Name:dseType
					Sample:entry
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
					Syntax:java.lang.String
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/pc99ekre
					Syntax:java.lang.String
				}
				freeFormName {
					Include:true
					Name:freeFormName
					Sample:Alastair Foreman
					Syntax:java.lang.String
				}
				gn {
					Include:true
					Name:gn
					Sample:Erin
					Syntax:java.lang.String
				}
				gq {
					Include:true
					Name:gq
					Sample:asd
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:22 678971
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:Tennisveien 3E
					Syntax:java.lang.String
				}
				initials {
					Include:true
					Name:initials
					Sample:Alejandra
					Syntax:java.lang.String
				}
				issDeliveryFilters {
					Include:true
					Name:issDeliveryFilters
					Sample:(cn= Mnemonic!issFilterCriteria= AND any recent "7"!issFilterActions= store "my email" ;forward "jhonmnemonic@in-box.net" ;reply "thanks for writing, I will soon get back to you" ;notify "write back")
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:{T.61}http://www.etud.insa-tlse.fr/~chateau/
					Syntax:java.lang.String
				}
				languageIdentifier {
					Include:true
					Name:languageIdentifier
					Sample:no
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:erin.krekoski@uwc.net
					Syntax:java.lang.String
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:o=UWC@cn=Application Services@cn=iss-unity.uwc.org
					Syntax:java.lang.String
				}
				migLastModifiedBy {
					Include:true
					Name:migLastModifiedBy
					Sample:xx00ccha
					Syntax:java.lang.String
				}
				migLastModifiedDate {
					Include:true
					Name:migLastModifiedDate
					Sample:Feb 25, 2002 11:53:47 AM
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47-9003 3738
					Syntax:java.lang.String
				}
				modifiersName {
					Include:true
					Name:modifiersName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				modifyTimestamp {
					Include:true
					Name:modifyTimestamp
					Sample:20001128101515Z
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:MetaMerge AS
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:Akersgaten 43
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:en
					Syntax:java.lang.String
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:kathinka.furst@uwc.net
					Syntax:java.lang.String
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:kathinka_furst@hotmail.com
					Syntax:java.lang.String
				}
				searchBase {
					Include:true
					Name:searchBase
					Sample:o=UWC@cn=Colleges
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Krekoski
					Syntax:java.lang.String
				}
				structuralObjectClass {
					Include:true
					Name:structuralObjectClass
					Sample:cdsIntraStoreUser
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:9003 3738
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Student
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:pc99ekre
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:{CRYPT}AFFWOFQ
					Syntax:java.lang.String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Sara
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:xcxcv
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:530528
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:{T.61}Sofie (1985)$Sara (1988)
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:PC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Janice
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:deBoer
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:{T.61}MBA / Sivil?konom
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:{T.61}Universitre Fribourg, Switzerland$Hxogskolan i Karlstad, Sweden
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:{T.61}Chemistry!
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:ff
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:sdfsdf
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:gg
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:asdasd
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:fdsf
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:5
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:zxczxc
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Skiing, canoeing
					Syntax:java.lang.String
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Ryenbergveien 54,0196 Oslo, Norway
					Syntax:java.lang.String
				}
				uwcMaidenName {
					Include:true
					Name:uwcMaidenName
					Sample:Louisa Ellinor R. Nilsson
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:married
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:sssd
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:qwe
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Sidsel
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:0777
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Entrepenuer
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:sda
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:asd
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Former Student
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Accountancy, Finance, Investment at Fribourg Univ.
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:no
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1999
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:6
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:xcvcv
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:{T.61}1980-82 Sales Manager \\"VingCard Systems\\", London, UK$1983-85 Sales Director (Austria,BeNeLux
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:N-1356
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://www.metamerge.com
					Syntax:java.lang.String
				}
				uwcpictureURI {
					Include:true
					Name:uwcpictureURI
					Sample:fff
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\Metamerge\\UWC\\EDB
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CDS-EDB
			}
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:metamerge.CDS-EDB
			}
			type:Iterator
			updateAttributes {
				cn {
					add:false
					flow:ret.value = conn.getAttribute("cn");
					mod:false
				}
				description {
					add:false
					flow:ret.value = conn.getAttribute("description");
					mod:false
				}
				facsimileTelephoneNumber {
					add:false
					flow:ret.value = conn.getAttribute("facsimileTelephoneNumber");
					mod:false
				}
				gn {
					add:false
					flow:ret.value = conn.getAttribute("gn");
					mod:false
				}
				gq {
					add:false
					flow:ret.value = conn.getAttribute("gq");
					mod:false
				}
				homePhone {
					add:false
					flow:ret.value = conn.getAttribute("homePhone");
					mod:false
				}
				homePostalAddress {
					add:false
					flow:ret.value = conn.getAttribute("homePostalAddress");
					mod:false
				}
				initials {
					add:false
					flow:ret.value = conn.getAttribute("initials");
					mod:false
				}
				labeledURI {
					add:false
					flow:ret.value = conn.getAttribute("labeledURI");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				migLastModifiedBy {
					add:false
					flow:ret.value = conn.getAttribute("migLastModifiedBy");
					mod:false
				}
				migLastModifiedDate {
					add:false
					flow:ret.value = conn.getAttribute("migLastModifiedDate");
					mod:false
				}
				mobile {
					add:false
					flow:ret.value = conn.getAttribute("mobile");
					mod:false
				}
				o {
					add:false
					flow:ret.value = conn.getAttribute("o");
					mod:false
				}
				objectClass {
					add:false
					flow:ret.value = conn.getAttribute("objectClass");
					mod:false
				}
				pager {
					add:false
					flow:ret.value = conn.getAttribute("pager");
					mod:false
				}
				postalAddress {
					add:false
					flow:ret.value = conn.getAttribute("postalAddress");
					mod:false
				}
				preferredLanguage {
					add:false
					flow:ret.value = conn.getAttribute("preferredLanguage");
					mod:false
				}
				sn {
					add:false
					flow:ret.value = conn.getAttribute("sn");
					mod:false
				}
				telephoneNumber {
					add:false
					flow:ret.value = conn.getAttribute("telephoneNumber");
					mod:false
				}
				title {
					add:false
					flow:ret.value = conn.getAttribute("title");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
				userPassword {
					add:false
					flow:ret.value = conn.getAttribute("userPassword");
					mod:false
				}
				uwcAffiliations {
					add:false
					flow:ret.value = conn.getAttribute("uwcAffiliations");
					mod:false
				}
				uwcAlsoKnownAs {
					add:false
					flow:ret.value = conn.getAttribute("uwcAlsoKnownAs");
					mod:false
				}
				uwcBiography {
					add:false
					flow:ret.value = conn.getAttribute("uwcBiography");
					mod:false
				}
				uwcBirthDate {
					add:false
					flow:ret.value = conn.getAttribute("uwcBirthDate");
					mod:false
				}
				uwcChildren {
					add:false
					flow:ret.value = conn.getAttribute("uwcChildren");
					mod:false
				}
				uwcCity {
					add:false
					flow:ret.value = conn.getAttribute("uwcCity");
					mod:false
				}
				uwcCollege {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollege");
					mod:false
				}
				uwcCollegeFirstName {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollegeFirstName");
					mod:false
				}
				uwcCollegeSurname {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollegeSurname");
					mod:false
				}
				uwcCountry {
					add:false
					flow:ret.value = conn.getAttribute("uwcCountry");
					mod:false
				}
				uwcDegree {
					add:false
					flow:ret.value = conn.getAttribute("uwcDegree");
					mod:false
				}
				uwcEducatedAt {
					add:false
					flow:ret.value = conn.getAttribute("uwcEducatedAt");
					mod:false
				}
				uwcEducation {
					add:false
					flow:ret.value = conn.getAttribute("uwcEducation");
					mod:false
				}
				uwcEndYear {
					add:false
					flow:ret.value = conn.getAttribute("uwcEndYear");
					mod:false
				}
				uwcFallbackContactAddress {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactAddress");
					mod:false
				}
				uwcFallbackContactCity {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactCity");
					mod:false
				}
				uwcFallbackContactCountry {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactCountry");
					mod:false
				}
				uwcFallbackContactName {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactName");
					mod:false
				}
				uwcFallbackContactPostalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactPostalCode");
					mod:false
				}
				uwcFallbackContactProvince {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactProvince");
					mod:false
				}
				uwcGender {
					add:false
					flow:ret.value = conn.getAttribute("uwcGender");
					mod:false
				}
				uwcHomePhoneAreaCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcHomePhoneAreaCode");
					mod:false
				}
				uwcHomePhoneInternationalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcHomePhoneInternationalCode");
					mod:false
				}
				uwcHonorific {
					add:false
					flow:ret.value = conn.getAttribute("uwcHonorific");
					mod:false
				}
				uwcICQNumber {
					add:false
					flow:ret.value = conn.getAttribute("uwcICQNumber");
					mod:false
				}
				uwcInterest {
					add:false
					flow:ret.value = conn.getAttribute("uwcInterest");
					mod:false
				}
				uwcMaidenName {
					add:false
					flow:ret.value = conn.getAttribute("uwcMaidenName");
					mod:false
				}
				uwcMaritalStatus {
					add:false
					flow:ret.value = conn.getAttribute("uwcMaritalStatus");
					mod:false
				}
				uwcMiddleName {
					add:false
					flow:ret.value = conn.getAttribute("uwcMiddleName");
					mod:false
				}
				uwcNationality {
					add:false
					flow:ret.value = conn.getAttribute("uwcNationality");
					mod:false
				}
				uwcNotes {
					add:false
					flow:ret.value = conn.getAttribute("uwcNotes");
					mod:false
				}
				uwcOrganisation {
					add:false
					flow:ret.value = conn.getAttribute("uwcOrganisation");
					mod:false
				}
				uwcPartnerName {
					add:false
					flow:ret.value = conn.getAttribute("uwcPartnerName");
					mod:false
				}
				uwcPostalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcPostalCode");
					mod:false
				}
				uwcPreferredAddress {
					add:false
					flow:ret.value = conn.getAttribute("uwcPreferredAddress");
					mod:false
				}
				uwcProfessions {
					add:false
					flow:ret.value = conn.getAttribute("uwcProfessions");
					mod:false
				}
				uwcProvince {
					add:false
					flow:ret.value = conn.getAttribute("uwcProvince");
					mod:false
				}
				uwcPublication {
					add:false
					flow:ret.value = conn.getAttribute("uwcPublication");
					mod:false
				}
				uwcRoles {
					add:false
					flow:ret.value = conn.getAttribute("uwcRoles");
					mod:false
				}
				uwcSalutation {
					add:false
					flow:ret.value = conn.getAttribute("uwcSalutation");
					mod:false
				}
				uwcSkills {
					add:false
					flow:ret.value = conn.getAttribute("uwcSkills");
					mod:false
				}
				uwcSpokenLanguages {
					add:false
					flow:ret.value = conn.getAttribute("uwcSpokenLanguages");
					mod:false
				}
				uwcStartYear {
					add:false
					flow:ret.value = conn.getAttribute("uwcStartYear");
					mod:false
				}
				uwcTelephoneNumberAreaCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcTelephoneNumberAreaCode");
					mod:false
				}
				uwcTelephoneNumberInternationalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcTelephoneNumberInternationalCode");
					mod:false
				}
				uwcWebSite {
					add:false
					flow:ret.value = conn.getAttribute("uwcWebSite");
					mod:false
				}
				uwcWorkCity {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkCity");
					mod:false
				}
				uwcWorkCountry {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkCountry");
					mod:false
				}
				uwcWorkHistory {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkHistory");
					mod:false
				}
				uwcWorkPostalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkPostalCode");
					mod:false
				}
				uwcWorkProvince {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkProvince");
					mod:false
				}
				uwcWorkURI {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkURI");
					mod:false
				}
				uwcpictureURI {
					add:false
					flow:ret.value = conn.getAttribute("uwcpictureURI");
					mod:false
				}
			}
		}
		Write {
			ALEvent {
				addonly_fail {
					active:true
					flow:main.logmsg("FAILED to ADD: " + work.getString("uid"));
				}
				before_add {
					active:true
					flow:task.dumpEntry(conn);
				}
			}
			attributeList {
			}
			connectorConfig {
				automapADPassword:false
				debug:true
				inheritFrom:metamerge.LDAP
				ldapAuthenticationMethod:Simple
				ldapPageSize:0
				ldapPassword:worthington
				ldapReferrals:follow
				ldapSearchBase:o=uwc
				ldapSizeLimit:0
				ldapTimeLimit:0
				ldapUrl:ldap://63.150.14.89:389
				ldapUsername:cn=manager,o=uwc
				ldapVLVPageSize:0
			}
			inheritAM:GDFullSetOfAttributes
			link [
			]
			override {
			}
			parserConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ", o=uwc";
					mod:false
				}
				cn {
					add:true
					flow:ret.value = work.getAttribute("cn");
					mod:true
				}
				description {
					add:true
					flow:ret.value = work.getAttribute("description");
					mod:true
				}
				facsimileTelephonenumber {
					add:true
					flow:ret.value = work.getAttribute("facsimiletelephonenumber");
					mod:true
				}
				generationQualifier {
					add:true
					flow:ret.value = work.getAttribute("gq");
					mod:true
				}
				gn {
					add:true
					flow:ret.value = work.getAttribute("gn");
					mod:true
				}
				homePhone {
					add:true
					flow:ret.value = work.getAttribute("homephone");
					mod:true
				}
				homePostalAddress {
					add:true
					flow:ret.value = work.getAttribute("homepostaladdress");
					mod:true
				}
				labeledURI {
					add:true
					flow:ret.value = work.getAttribute("labeledURI");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				migLastModifiedBy {
					add:true
					flow:ret.value = work.getAttribute("migLastModifiedBy");
					mod:true
				}
				migLastModifiedDate {
					add:true
					flow:ret.value = work.getAttribute("migLastModifiedDate");
					mod:true
				}
				mobile {
					add:true
					flow:ret.value = work.getAttribute("mobile");
					mod:true
				}
				o {
					add:true
					flow:ret.value = work.getAttribute("o");
					mod:true
				}
				objectclass {
					add:true
					flow:oldObjClass = work.getAttribute("objectclass");\nobjClass = system.newAttribute("objectclass");\n\nfor (i = 0; i < oldObjClass.size(); i++)\n{\n\tif (!oldObjClass.getValue(i).equalsIgnoreCase("cdsIntraStoreUser"))\n\t{\n\t\tobjClass.addValue(oldObjClass.getValue(i));\n\t}\n}\n\n/*\nif (!oldObjClass.hasValueIC("inetOrgPerson"))\n{\n\tobjClass.addValue("inetOrgPerson");\n}\n*/\n\nret.value = objClass;\n
					mod:false
				}
				pager {
					add:true
					flow:ret.value = work.getAttribute("pager");
					mod:true
				}
				postalAddress {
					add:true
					flow:ret.value = work.getAttribute("postaladdress");
					mod:true
				}
				preferredLanguage {
					add:true
					flow:ret.value = work.getAttribute("preferredLanguage");
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("sn");
					mod:true
				}
				telephoneNumber {
					add:true
					flow:ret.value = work.getAttribute("telephonenumber");
					mod:true
				}
				title {
					add:true
					flow:ret.value = work.getAttribute("title");
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				userPassword {
					add:true
					flow:ret.value = work.getAttribute("userPassword");
					mod:true
				}
				uwcAffiliations {
					add:true
					flow:ret.value = work.getAttribute("uwcaffiliations");
					mod:true
				}
				uwcAlsoKnownAs {
					add:true
					flow:ret.value = work.getAttribute("uwcalsoknownas");
					mod:true
				}
				uwcBiography {
					add:true
					flow:ret.value = work.getAttribute("uwcbiography");
					mod:true
				}
				uwcBirthDate {
					add:true
					flow:ret.value = work.getAttribute("uwcBirthDate");
					mod:true
				}
				uwcChildren {
					add:true
					flow:ret.value = work.getAttribute("uwcchildren");
					mod:true
				}
				uwcCity {
					add:true
					flow:ret.value = work.getAttribute("uwccity");
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("uwccollege");
					mod:false
				}
				uwcCollegeFirstName {
					add:true
					flow:if (work.getAttribute("uwccollegefirstname") == null)\n\tret.value = work.getAttribute("gn");\nelse ret.value = work.getAttribute("uwccollegefirstname");\n\nif (ret.value == null) ret.value = "UNKNOWN";
					mod:false
				}
				uwcCollegeSurname {
					add:true
					flow:if (work.getAttribute("uwccollegesurname") == null)\n\tret.value = work.getAttribute("sn");\nelse ret.value = work.getAttribute("uwccollegesurname");
					mod:false
				}
				uwcCountry {
					add:true
					flow:ret.value = work.getAttribute("uwccountry");
					mod:true
				}
				uwcDegree {
					add:true
					flow:ret.value = work.getAttribute("uwcdegree");
					mod:true
				}
				uwcEducatedAt {
					add:true
					flow:ret.value = work.getAttribute("uwceducatedat");
					mod:true
				}
				uwcEducation {
					add:true
					flow:ret.value = work.getAttribute("uwceducation");
					mod:true
				}
				uwcEndYear {
					add:true
					flow:ret.value = work.getAttribute("uwcendyear");
					mod:true
				}
				uwcFallbackContactAddress {
					add:true
					flow:ret.value = work.getAttribute("uwcfallbackcontactaddress");
					mod:true
				}
				uwcFallbackContactCity {
					add:true
					flow:ret.value = work.getAttribute("uwcfallbackcontactcity");
					mod:true
				}
				uwcFallbackContactCountry {
					add:true
					flow:ret.value = work.getAttribute("uwcfallbackcontactcountry");
					mod:true
				}
				uwcFallbackContactName {
					add:true
					flow:ret.value = work.getAttribute("uwcfallbackcontactname");
					mod:true
				}
				uwcFallbackContactPostalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactPostalCode");
					mod:true
				}
				uwcFallbackContactProvince {
					add:true
					flow:ret.value = work.getAttribute("uwcfallbackcontactprovince");
					mod:true
				}
				uwcFallbackFacsimileTelephoneNumber {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackFacsimileTelephoneNumber");
					mod:true
				}
				uwcFallbackHomePhone {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackHomePhone");
					mod:true
				}
				uwcFallbackMail {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackMail");
					mod:true
				}
				uwcGender {
					add:true
					flow:ret.value = work.getAttribute("uwcgender");
					mod:true
				}
				uwcHomePhoneAreaCode {
					add:true
					flow:ret.value = work.getAttribute("uwchomephoneareacode");
					mod:true
				}
				uwcHomePhoneInternationalCode {
					add:true
					flow:ret.value = work.getAttribute("uwchomephoneinternationalcode");
					mod:true
				}
				uwcHonorific {
					add:true
					flow:ret.value = work.getAttribute("uwcHonorific");
					mod:true
				}
				uwcICQNumber {
					add:true
					flow:ret.value = work.getAttribute("uwcicqnumber");
					mod:true
				}
				uwcInterest {
					add:true
					flow:ret.value = work.getAttribute("uwcinterest");
					mod:true
				}
				uwcMaritalStatus {
					add:true
					flow:ret.value = work.getAttribute("uwcmaritalstatus");
					mod:true
				}
				uwcMiddleName {
					add:true
					flow:if (work.getAttribute("uwcmiddlename") != null)\n\tret.value = work.getAttribute("uwcmiddlename");\nelse ret.value = work.getAttribute("initials");
					mod:true
				}
				uwcNationality {
					add:true
					flow:ret.value = work.getAttribute("uwcnationality");
					mod:true
				}
				uwcNotes {
					add:true
					flow:ret.value = work.getAttribute("uwcnotes");
					mod:true
				}
				uwcOrganisation {
					add:true
					flow:ret.value = work.getAttribute("uwcorganisation");
					mod:true
				}
				uwcPartnerName {
					add:true
					flow:ret.value = work.getAttribute("uwcpartnername");
					mod:true
				}
				uwcPictureURI {
					add:true
					flow:ret.value = work.getAttribute("uwcpictureuri");
					mod:true
				}
				uwcPostalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcpostalcode");
					mod:true
				}
				uwcPreferredAddress {
					add:true
					flow:ret.value = work.getAttribute("uwcPreferredAddress");
					mod:true
				}
				uwcProfessions {
					add:true
					flow:ret.value = work.getAttribute("uwcprofessions");
					mod:true
				}
				uwcProvince {
					add:true
					flow:ret.value = work.getAttribute("uwcprovince");
					mod:true
				}
				uwcPublication {
					add:true
					flow:ret.value = work.getAttribute("uwcpublication");
					mod:true
				}
				uwcRoles {
					add:true
					flow:ret.value = work.getAttribute("uwcroles");
					mod:true
				}
				uwcSalutation {
					add:true
					flow:ret.value = work.getAttribute("uwcsalutation");
					mod:true
				}
				uwcSpokenLanguages {
					add:true
					flow:ret.value = work.getAttribute("uwcspokenlanguages");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("uwcstartyear");
					mod:false
				}
				uwcTelephoneNumberAreaCode {
					add:true
					flow:ret.value = work.getAttribute("uwctelephonenumberareacode");
					mod:true
				}
				uwcTelephoneNumberInternationalCode {
					add:true
					flow:ret.value = work.getAttribute("uwctelephonenumberinternationalcode");
					mod:true
				}
				uwcWebSite {
					add:true
					flow:ret.value = work.getAttribute("uwcwebsite");
					mod:true
				}
				uwcWorkCity {
					add:true
					flow:ret.value = work.getAttribute("uwcworkcity");
					mod:true
				}
				uwcWorkCountry {
					add:true
					flow:ret.value = work.getAttribute("uwcworkcountry");
					mod:true
				}
				uwcWorkHistory {
					add:true
					flow:ret.value = work.getAttribute("uwcWorkHistory");
					mod:true
				}
				uwcWorkPostalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcworkpostalcode");
					mod:true
				}
				uwcWorkProvince {
					add:true
					flow:ret.value = work.getAttribute("uwcworkprovince");
					mod:true
				}
				uwcWorkURI {
					add:true
					flow:ret.value = work.getAttribute("uwcworkURI");
					mod:true
				}
			}
		}
		dump {
			enabled:true
			script:if (!work.getAttribute("objectclass").hasValueIC("person"))\n\tsystem.skipEntry();
			type:Script
		}
	}
	debug:false
	description:Export Unity accounts to OpenLDAP
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task Intrastore2OpenLDAP.uwcLocation]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		Read
		dump
		Write
	]
	components {
		Read {
			ALEvent {
				after_getnext {
					active:true
					flow:counter++;
				}
				default_ok {
					active:true
					flow:work.setAttribute("dn", "uid=" + work.getString("uid") + ",o=uwc");
				}
			}
			attributeList {
				cn {
					Include:true
					Name:cn
					Sample:Erin Krekoski
					Syntax:java.lang.String
				}
				createTimestamp {
					Include:true
					Name:createTimestamp
					Sample:19990824065444Z
					Syntax:java.lang.String
				}
				creatorsName {
					Include:true
					Name:creatorsName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				description {
					Include:true
					Name:description
					Sample:History and Philosophy Teacher. Homepage www.bigfoot.com/jonimakivirta
					Syntax:java.lang.String
				}
				dseType {
					Include:true
					Name:dseType
					Sample:entry
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
					Syntax:java.lang.String
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/pc99ekre
					Syntax:java.lang.String
				}
				freeFormName {
					Include:true
					Name:freeFormName
					Sample:Alastair Foreman
					Syntax:java.lang.String
				}
				gn {
					Include:true
					Name:gn
					Sample:Erin
					Syntax:java.lang.String
				}
				gq {
					Include:true
					Name:gq
					Sample:asd
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:22 678971
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:Tennisveien 3E
					Syntax:java.lang.String
				}
				initials {
					Include:true
					Name:initials
					Sample:Alejandra
					Syntax:java.lang.String
				}
				issDeliveryFilters {
					Include:true
					Name:issDeliveryFilters
					Sample:(cn= Mnemonic!issFilterCriteria= AND any recent "7"!issFilterActions= store "my email" ;forward "jhonmnemonic@in-box.net" ;reply "thanks for writing, I will soon get back to you" ;notify "write back")
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:{T.61}http://www.etud.insa-tlse.fr/~chateau/
					Syntax:java.lang.String
				}
				languageIdentifier {
					Include:true
					Name:languageIdentifier
					Sample:no
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:erin.krekoski@uwc.net
					Syntax:java.lang.String
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:o=UWC@cn=Application Services@cn=iss-unity.uwc.org
					Syntax:java.lang.String
				}
				migLastModifiedBy {
					Include:true
					Name:migLastModifiedBy
					Sample:xx00ccha
					Syntax:java.lang.String
				}
				migLastModifiedDate {
					Include:true
					Name:migLastModifiedDate
					Sample:Feb 25, 2002 11:53:47 AM
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47-9003 3738
					Syntax:java.lang.String
				}
				modifiersName {
					Include:true
					Name:modifiersName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				modifyTimestamp {
					Include:true
					Name:modifyTimestamp
					Sample:20001128101515Z
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:MetaMerge AS
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:Akersgaten 43
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:en
					Syntax:java.lang.String
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:kathinka.furst@uwc.net
					Syntax:java.lang.String
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:kathinka_furst@hotmail.com
					Syntax:java.lang.String
				}
				searchBase {
					Include:true
					Name:searchBase
					Sample:o=UWC@cn=Colleges
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Krekoski
					Syntax:java.lang.String
				}
				structuralObjectClass {
					Include:true
					Name:structuralObjectClass
					Sample:cdsIntraStoreUser
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:9003 3738
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Student
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:pc99ekre
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:{CRYPT}AFFWOFQ
					Syntax:java.lang.String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Sara
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:xcxcv
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:530528
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:{T.61}Sofie (1985)$Sara (1988)
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:PC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Janice
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:deBoer
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:{T.61}MBA / Sivil?konom
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:{T.61}Universitre Fribourg, Switzerland$Hxogskolan i Karlstad, Sweden
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:{T.61}Chemistry!
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:ff
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:sdfsdf
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:gg
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:asdasd
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:fdsf
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:5
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:zxczxc
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Skiing, canoeing
					Syntax:java.lang.String
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Ryenbergveien 54,0196 Oslo, Norway
					Syntax:java.lang.String
				}
				uwcMaidenName {
					Include:true
					Name:uwcMaidenName
					Sample:Louisa Ellinor R. Nilsson
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:married
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:sssd
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:qwe
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Sidsel
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:0777
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Entrepenuer
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:sda
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:asd
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Former Student
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Accountancy, Finance, Investment at Fribourg Univ.
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:no
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1999
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:6
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:xcvcv
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:{T.61}1980-82 Sales Manager \\"VingCard Systems\\", London, UK$1983-85 Sales Director (Austria,BeNeLux
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:N-1356
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://www.metamerge.com
					Syntax:java.lang.String
				}
				uwcpictureURI {
					Include:true
					Name:uwcpictureURI
					Sample:fff
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\Metamerge\\UWC\\EDB
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CDS-EDB
			}
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:metamerge.CDS-EDB
			}
			type:Iterator
			updateAttributes {
				objectclass {
					add:false
					flow:ret.value = conn.getAttribute("objectclass");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
				uwcLocation {
					add:false
					flow:ret.value = conn.getAttribute("uwcLocation");
					mod:false
				}
			}
		}
		Write {
			ALEvent {
				addonly_fail {
					active:true
					flow:main.logmsg("FAILED to ADD: " + work.getString("uid"));
				}
				before_add {
					active:true
					flow:task.dumpEntry(conn);
				}
				update_fail {
					active:true
					flow:main.logmsg("error" + work.getString("uid"));
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				automapADPassword:false
				debug:false
				inheritFrom:metamerge.LDAP
				ldapAuthenticationMethod:Simple
				ldapPageSize:0
				ldapPassword:worthington
				ldapReferrals:follow
				ldapSearchBase:o=uwc
				ldapSizeLimit:0
				ldapTimeLimit:0
				ldapUrl:ldap://63.150.14.89:389
				ldapUsername:cn=manager,o=uwc
				ldapVLVPageSize:0
			}
			inheritAM:
			link [
				$dn:=|$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				homePostalAddress {
					add:true
					flow:ret.value = work.getAttribute("homePostalAddress");
					mod:true
				}
				postalAddress {
					add:true
					flow:ret.value = work.getAttribute("postalAddress");
					mod:true
				}
			}
		}
		dump {
			enabled:true
			script:if (!(work.getAttribute("objectclass").hasValueIC("person") && (counter > 13500) && (work.getAttribute("uwcLocation") != null)))\n\tsystem.skipEntry();\n\nfor (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n{\n\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Home"))\n\t\twork.setAttribute("homepostaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n\n\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Work")) \n\t\twork.setAttribute("postaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n}\n
			type:Script
		}
	}
	debug:false
	description:Fix uwcLocation on OpenLDAP after IntraStore2OpenLDAP
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:var counter = 0;
	scriptEngine:JavaScript
	verbose:500
[end]

[task LDAP2CSV.2000-2001grads]
	automapattributes:false
	componentlist [
		read
		output
	]
	components {
		output {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:append
				filePath:D:\\Documents and Settings\\cchateauvieux\\My Documents\\export.csv
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumnSeparator:,
				csvColumns:First Name,Last Name,College,Starting Year,Home Postal Address,Work Postal Address,Email address,Preferred Email Address
				inheritFrom:metamerge.CSV
			}
			type:AddOnly
			updateAttributes {
				College {
					add:true
					flow:ret.value = work.getAttribute("uwcCollege");
					mod:true
				}
				Email address {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				First Name {
					add:true
					flow:ret.value = work.getAttribute("gn");
					mod:true
				}
				Home Postal Address {
					add:true
					flow:ret.value = null;\n\nif (work.getAttribute("uwclocation") != null)\n{\n\tfor (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n\t{\n\t\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Home")) \n\t\t\tret.value = work.getAttribute("uwclocation").getValue(i).toString().substring(6);\n\t}\n}\n
					mod:true
				}
				Last Name {
					add:true
					flow:ret.value = work.getAttribute("sn");
					mod:true
				}
				Starting Year {
					add:true
					flow:ret.value = work.getAttribute("uwcStartYear");
					mod:true
				}
				Work Postal Address {
					add:true
					flow:ret.value = null;\n\nif (work.getAttribute("uwclocation") != null)\n{\n\tfor (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n\t{\n\t\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Work")) \n\t\t\tret.value = work.getAttribute("uwclocation").getValue(i).toString().substring(6);\n\t}\n}\n\n
					mod:true
				}
				preferred Email Address {
					add:true
					flow:ret.value = work.getAttribute("preferredrfc822recipient");
					mod:true
				}
			}
		}
		read {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=ac99rell,o=uwc
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Rhian ELLIS
					Syntax:java.lang.String
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac99rell
					Syntax:java.lang.String
				}
				gn {
					Include:true
					Name:gn
					Sample:Rhian
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:rhian.ellis@uwc.net
					Syntax:java.lang.String
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=iss-unity.uwc.org, cn=Application Services, o=UWC
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Ellis
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:ac99rell
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@55d765
					Syntax:ByteArray
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1999
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:LDAPUnity
				ldapReferrals:follow
				ldapSearchFilter:(uwcstartyear=1998)
				ldapSizeLimit:0
				ldapTimeLimit:0
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				gn {
					add:false
					flow:ret.value = conn.getAttribute("gn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				preferredrfc822recipient {
					add:false
					flow:ret.value = conn.getAttribute("preferredrfc822recipient");
					mod:false
				}
				sn {
					add:false
					flow:ret.value = conn.getAttribute("sn");
					mod:false
				}
				uwcCollege {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollege");
					mod:false
				}
				uwcLocation {
					add:false
					flow:ret.value = conn.getAttribute("uwcLocation");
					mod:false
				}
				uwcStartYear {
					add:false
					flow:ret.value = conn.getAttribute("uwcStartYear");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to export entries for UWC journal
	includeGlobalPrologs:true
	scriptEngine:JavaScript
[end]

[task LDAP2LDAP.Y2K-migration]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		unity
		unity update
	]
	components {
		unity {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:task.logmsg("before reading");
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:task.logmsg ("Before lookup");\ntask.dumpEntry (work);
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:true
					flow:refs = ["uwcstartyear", "uwcendyear"];\n\nfor (i=0; i < refs.length; i++)\n{\n\tchk = work.getString(refs[i]);\n\tif (chk != null)  \t// if specified\n\t{\n\t\tif (chk.length() == 4)\n\t\t{\n\t\t\tif (chk.endsWith(".0") == true)\n\t\t\t\tchk = chk.substring(0, 2);\n        }\t\t\t\n\t\tif (chk.length() == 3)\t\n\t\t{\n\t\t\tif (parseInt(chk,10) == 100)\n\t\t\t    chk = new java.lang.String("2000");\n\t\t}\t\t\n\t\tif (chk.length() == 2)\t\t// if 2 digit\n\t\t{\n\t\t\tif (parseInt(chk,10) < 62)\n\t\t\t    chk = new java.lang.String("20" + chk);\n\t\t\telse\n\t   \t  \t\tchk = new java.lang.String("19" + chk);\n\t\t}\n\t\twork.setAttribute(refs[i], chk);\n\t}\n}
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:task.logmsg ("Entry not found");\nentryNotFound = true;\nldapError = "Unable to find entry";\nwork.setAttribute ("$dn", "bullshit");
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				connectorFlags:{deleteEmptyStrings}
				debug:false
				inheritFrom:LDAPUnity
				ldapPump:AZ
				ldapSearchBase:o=uwc
				ldapSearchFilter:uid=hkc*
				ldapUrl:ldap://unity.uwc.org
			}
			deltaConfig {
				enabled:false
			}
			link [
				$dn:=|$dn
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				cn {
					add:false
					flow:ret.value = conn.getAttribute("cn");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
				uwcEndYear {
					add:false
					flow:ret.value = conn.getAttribute("uwcEndYear");
					mod:false
				}
				uwcStartYear {
					add:false
					flow:ret.value = conn.getAttribute("uwcStartYear");
					mod:false
				}
			}
		}
		unity update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:task.logmsg ("Attempting to ADD on unity");\ntask.dumpEntry (conn);\n
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:task.logmsg("Update Attributes on unity");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:true
					flow:task.logmsg ("Before Update on unity");\ntask.dumpEntry (work);\n
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:true
					flow:task.logmsg("Apply Attributes on unity");\ntask.dumpEntry (conn);
					name:Before Applying Changes
				}
				modify_nochange {
					active:true
					flow:task.logmsg ("No changes on unity");\nldapError = "No changes";
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapError);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK on unity");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=xx98bsta,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn Stadheim
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:+47 2274 5705
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				mail {
					Include:true
					Name:mail
					Sample:bjorn@architech.no
				}
				objectclass {
					Include:true
					Name:objectclass
					Sample:uwcperson
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Consultant
				}
				uid {
					Include:true
					Name:uid
					Sample:xx98bsta
				}
				userpassword {
					Include:true
					Name:userpassword
					Sample:[B@1ce4a3
				}
				uwccollege {
					Include:true
					Name:uwccollege
					Sample:xx
				}
				uwcdateofbirth {
					Include:true
					Name:uwcdateofbirth
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
			}
			compute_changes:true
			connectorConfig {
				connectorFlags:{DontDeleteEmptyStrings}
				debug:false
				inheritFrom:LDAPUnity
				ldapAuthenticationMethod:Simple
				ldapPassword:worthington
				ldapSearchBase:o=uwc
				ldapSearchFilter:
				ldapUrl:ldap://unity.uwc.org
				ldapUsername:cn=administrator,o=uwc
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				uwcendyear {
					add:false
					flow:ret.value = work.getAttribute("uwcendyear");
					mod:true
				}
				uwcstartyear {
					add:false
					flow:ret.value = work.getAttribute("uwcstartyear");
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to convert old start/end years into Y2K format
	epilog:
	get_history:
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task MIG-AttributeOIDgeneration]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		update
	]
	components {
		read {
			ALEvent {
				get_ok {
					active:true
					flow:counter++;
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:migattributename=mmMiddleName,ou=systemdefaults,ou=schema,o=metamerge
					Syntax:java.lang.String
				}
				MigAttributeDisplayName {
					Include:true
					Name:MigAttributeDisplayName
					Sample:Middle name(s):
					Syntax:MAY/String
				}
				MigAttributeName {
					Include:true
					Name:MigAttributeName
					Sample:mmMiddleName
					Syntax:MUST/String
				}
				MigAttributeOID {
					Include:true
					Name:MigAttributeOID
					Sample:
					Syntax:MUST/String
				}
				MigAuthorizedValue {
					Include:true
					Name:MigAuthorizedValue
					Sample:#STRING +
					Syntax:MAY/String
				}
				MigCustomizedClass {
					Include:true
					Name:MigCustomizedClass
					Sample:
					Syntax:MAY/String
				}
				MigDefaultCriteriaClass {
					Include:true
					Name:MigDefaultCriteriaClass
					Sample:mmNetwork
					Syntax:MAY/String
				}
				MigDescription {
					Include:true
					Name:MigDescription
					Sample:Any middle (given) names.
					Syntax:MAY/String
				}
				MigDisplayType {
					Include:true
					Name:MigDisplayType
					Sample:readonlytext
					Syntax:MAY/String
				}
				MigEditType {
					Include:true
					Name:MigEditType
					Sample:onelinetextbox
					Syntax:MAY/String
				}
				MigExampleValue {
					Include:true
					Name:MigExampleValue
					Sample:Jillian Elizabeth
					Syntax:MAY/String
				}
				MigSearchCriteriaClass {
					Include:true
					Name:MigSearchCriteriaClass
					Sample:mmNetwork
					Syntax:MAY/String
				}
				MigSearchResultClass {
					Include:true
					Name:MigSearchResultClass
					Sample:mmcust
					Syntax:MAY/String
				}
				MigSearchType {
					Include:true
					Name:MigSearchType
					Sample:onelinetextbox
					Syntax:MAY/String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:MIGAttribute
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:objectclass=MIGattribute
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				objectClass {
					add:false
					flow:ret.value = conn.getAttribute("objectClass");
					mod:false
				}
			}
		}
		update {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:migattributename=sn,ou=systemdefaults,ou=schema,o=metamerge
					Syntax:java.lang.String
				}
				MigAttributeDisplayName {
					Include:true
					Name:MigAttributeDisplayName
					Sample:Last name(s):
					Syntax:MAY/String
				}
				MigAttributeName {
					Include:true
					Name:MigAttributeName
					Sample:sn
					Syntax:MUST/String
				}
				MigAttributeOID {
					Include:true
					Name:MigAttributeOID
					Sample:
					Syntax:MUST/String
				}
				MigAuthorizedValue {
					Include:true
					Name:MigAuthorizedValue
					Sample:
					Syntax:MAY/String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGadmin
					Syntax:java.lang.String
				}
				MigCustomizedClass {
					Include:true
					Name:MigCustomizedClass
					Sample:
					Syntax:MAY/String
				}
				MigDefaultCriteriaClass {
					Include:true
					Name:MigDefaultCriteriaClass
					Sample:
					Syntax:MAY/String
				}
				MigDescription {
					Include:true
					Name:MigDescription
					Sample:All last names you currently use.
					Syntax:MAY/String
				}
				MigDisplayType {
					Include:true
					Name:MigDisplayType
					Sample:readonlytext
					Syntax:MAY/String
				}
				MigEditType {
					Include:true
					Name:MigEditType
					Sample:onelinetextbox
					Syntax:MAY/String
				}
				MigExampleValue {
					Include:true
					Name:MigExampleValue
					Sample:Williams; Gonzalez Perez
					Syntax:MAY/String
				}
				MigSearchCriteriaClass {
					Include:true
					Name:MigSearchCriteriaClass
					Sample:
					Syntax:MAY/String
				}
				MigSearchResultClass {
					Include:true
					Name:MigSearchResultClass
					Sample:
					Syntax:MAY/String
				}
				MigSearchType {
					Include:true
					Name:MigSearchType
					Sample:onelinetextbox
					Syntax:MAY/String
				}
				cn {
					Include:true
					Name:cn
					Sample:Christian Chateauvieux
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Christian
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:christian@metamerge.com
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:MIGAttribute
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:fr
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Chateauvieux
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:cchateauvieux
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@30b13c
					Syntax:ByteArray
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				MigAttributeOID {
					add:true
					flow:ret.value = "1.3.6.1.4.1.8002.1." + counter;
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var counter=0;
	scriptEngine:JavaScript
	source:D:\\Atelier\\Metamerge\\MM\\rs.cfg
[end]

[task MIG-ClassOIDgeneration]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		update
	]
	components {
		read {
			ALEvent {
				get_ok {
					active:true
					flow:counter++;
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:migclassname=mmNetwork,ou=systemdefaults,ou=schema,o=metamerge
					Syntax:java.lang.String
				}
				MigAccessMode {
					Include:true
					Name:MigAccessMode
					Sample:public
					Syntax:MUST/String
				}
				MigAuthorizedUser {
					Include:true
					Name:MigAuthorizedUser
					Sample:
					Syntax:MAY/String
				}
				MigClassDisplayName {
					Include:true
					Name:MigClassDisplayName
					Sample:Metamerge Network members
					Syntax:MUST/String
				}
				MigClassName {
					Include:true
					Name:MigClassName
					Sample:mmNetwork
					Syntax:MUST/String
				}
				MigClassOID {
					Include:true
					Name:MigClassOID
					Sample:
					Syntax:MUST/String
				}
				MigDataBaseDN {
					Include:true
					Name:MigDataBaseDN
					Sample:ou=employees, o=metamerge
					Syntax:MUST/String
				}
				MigDataFilter {
					Include:true
					Name:MigDataFilter
					Sample:employee
					Syntax:MUST/String
				}
				MigDataIcon {
					Include:true
					Name:MigDataIcon
					Sample:images/arrow.gif
					Syntax:MUST/String
				}
				MigPointedWebPage {
					Include:true
					Name:MigPointedWebPage
					Sample:user_management.html
					Syntax:MUST/String
				}
				MigRelevantAttribute {
					Include:true
					Name:MigRelevantAttribute
					Sample:mmCity
					Syntax:MAY/String
				}
				MigRequiredAttribute {
					Include:true
					Name:MigRequiredAttribute
					Sample:cn
					Syntax:MAY/String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:MIGSearchClass
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:objectclass=MIGSearchClass
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				objectClass {
					add:false
					flow:ret.value = conn.getAttribute("objectClass");
					mod:false
				}
			}
		}
		update {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:migattributename=sn,ou=systemdefaults,ou=schema,o=metamerge
					Syntax:java.lang.String
				}
				MigAttributeDisplayName {
					Include:true
					Name:MigAttributeDisplayName
					Sample:Last name(s):
					Syntax:MAY/String
				}
				MigAttributeName {
					Include:true
					Name:MigAttributeName
					Sample:sn
					Syntax:MUST/String
				}
				MigAttributeOID {
					Include:true
					Name:MigAttributeOID
					Sample:
					Syntax:MUST/String
				}
				MigAuthorizedValue {
					Include:true
					Name:MigAuthorizedValue
					Sample:
					Syntax:MAY/String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGadmin
					Syntax:java.lang.String
				}
				MigCustomizedClass {
					Include:true
					Name:MigCustomizedClass
					Sample:
					Syntax:MAY/String
				}
				MigDefaultCriteriaClass {
					Include:true
					Name:MigDefaultCriteriaClass
					Sample:
					Syntax:MAY/String
				}
				MigDescription {
					Include:true
					Name:MigDescription
					Sample:All last names you currently use.
					Syntax:MAY/String
				}
				MigDisplayType {
					Include:true
					Name:MigDisplayType
					Sample:readonlytext
					Syntax:MAY/String
				}
				MigEditType {
					Include:true
					Name:MigEditType
					Sample:onelinetextbox
					Syntax:MAY/String
				}
				MigExampleValue {
					Include:true
					Name:MigExampleValue
					Sample:Williams; Gonzalez Perez
					Syntax:MAY/String
				}
				MigSearchCriteriaClass {
					Include:true
					Name:MigSearchCriteriaClass
					Sample:
					Syntax:MAY/String
				}
				MigSearchResultClass {
					Include:true
					Name:MigSearchResultClass
					Sample:
					Syntax:MAY/String
				}
				MigSearchType {
					Include:true
					Name:MigSearchType
					Sample:onelinetextbox
					Syntax:MAY/String
				}
				cn {
					Include:true
					Name:cn
					Sample:Christian Chateauvieux
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Christian
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:christian@metamerge.com
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:MIGAttribute
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:fr
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Chateauvieux
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:cchateauvieux
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@30b13c
					Syntax:ByteArray
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:cn=*
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				MigClassOID {
					add:true
					flow:ret.value = "1.3.6.1.4.1.8002.1." + counter;
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var counter=0;
	scriptEngine:JavaScript
	source:D:\\Atelier\\Metamerge\\MM\\rs.cfg
[end]

[task MIG.schema.fix]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		read
		lookup
		add
	]
	components {
		add {
			ALEvent {
			}
			connectorConfig {
				connectorType:@read
				inheritFrom:@read
			}
			link [
			]
			override {
			}
			type:Passive
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ",ou=userdefaults,ou=schema,o=uwc";\n
					mod:true
				}
				objectclass {
					add:true
					flow:tmp = system.newAttribute("objectclass");\ntmp.addValue("uidObject");\ntmp.addValue("top");\nret.value = tmp;
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
			}
		}
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.dumpEntry (conn);\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:true
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:true
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:true
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:true
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				inputStream {
					Include:true
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:true
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:true
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		lookup {
			ALEvent {
				before_execute {
					active:true
					flow:work.setAttribute("dn", "uid=" + work.getString("uid") + ",ou=userdefaults,ou=schema,o=uwc");
				}
				lookup_fail {
					active:true
					flow:main.logmsg("Adding subtree for uid " + work.getString("uid"));\nadd.add(work);
				}
			}
			connectorConfig {
				connectorType:@read
				inheritFrom:@read
			}
			link [
				$dn:=|$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			type:Lookup
			updateAttributes {
			}
		}
		read {
			ALEvent {
				after_getnext {
					active:false
					flow:
				}
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:uid=*
				ldapSearchScope:onelevel
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to insert user's search engine preference folder into freedom's MIG
	epilog:
	get_history:
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var ldapError = "OK";\n
	prolog0:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:100
[end]

[task QMail.activation]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		Read
		dump
		Retrieve
		Write
		CSV
		MIG
	]
	components {
		CSV {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:output
				filePath:D:\\Atelier\\Metamerge\\UWC\\migrated_accounts.csv
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumns:uid\nname
				csvEnableQuoting:true
				csvLogLongLines:0
				csvWriteHeader:true
				inheritFrom:metamerge.CSV
			}
			type:AddOnly
			updateAttributes {
				mail {
					add:true
					flow:ret.value = work.getString("uid") + "@uwc.net";
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
			}
		}
		MIG {
			ALEvent {
			}
			connectorConfig {
				connectorType:@Write
				inheritFrom:@Write
			}
			link [
			]
			override {
			}
			type:Passive
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ",ou=userdefaults,ou=schema,o=uwc";\n
					mod:true
				}
				objectclass {
					add:true
					flow:tmp = system.newAttribute("objectclass");\ntmp.addValue("uidObject");\ntmp.addValue("top");\nret.value = tmp;
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
			}
		}
		Read {
			ALEvent {
				default_ok {
					active:true
					flow:main.logmsg("READ" + work.getString("uid"));
				}
			}
			attributeList {
				cn {
					Include:true
					Name:cn
					Sample:Erin Krekoski
					Syntax:java.lang.String
				}
				createTimestamp {
					Include:true
					Name:createTimestamp
					Sample:19990824065444Z
					Syntax:java.lang.String
				}
				creatorsName {
					Include:true
					Name:creatorsName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				description {
					Include:true
					Name:description
					Sample:History and Philosophy Teacher. Homepage www.bigfoot.com/jonimakivirta
					Syntax:java.lang.String
				}
				dseType {
					Include:true
					Name:dseType
					Sample:entry
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
					Syntax:java.lang.String
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/pc99ekre
					Syntax:java.lang.String
				}
				freeFormName {
					Include:true
					Name:freeFormName
					Sample:Alastair Foreman
					Syntax:java.lang.String
				}
				gn {
					Include:true
					Name:gn
					Sample:Erin
					Syntax:java.lang.String
				}
				gq {
					Include:true
					Name:gq
					Sample:asd
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:22 678971
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:Tennisveien 3E
					Syntax:java.lang.String
				}
				initials {
					Include:true
					Name:initials
					Sample:Alejandra
					Syntax:java.lang.String
				}
				issDeliveryFilters {
					Include:true
					Name:issDeliveryFilters
					Sample:(cn= Mnemonic!issFilterCriteria= AND any recent "7"!issFilterActions= store "my email" ;forward "jhonmnemonic@in-box.net" ;reply "thanks for writing, I will soon get back to you" ;notify "write back")
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:{T.61}http://www.etud.insa-tlse.fr/~chateau/
					Syntax:java.lang.String
				}
				languageIdentifier {
					Include:true
					Name:languageIdentifier
					Sample:no
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:erin.krekoski@uwc.net
					Syntax:java.lang.String
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:o=UWC@cn=Application Services@cn=iss-unity.uwc.org
					Syntax:java.lang.String
				}
				migLastModifiedBy {
					Include:true
					Name:migLastModifiedBy
					Sample:xx00ccha
					Syntax:java.lang.String
				}
				migLastModifiedDate {
					Include:true
					Name:migLastModifiedDate
					Sample:Feb 25, 2002 11:53:47 AM
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47-9003 3738
					Syntax:java.lang.String
				}
				modifiersName {
					Include:true
					Name:modifiersName
					Sample:o=uwc@cn=administrator
					Syntax:java.lang.String
				}
				modifyTimestamp {
					Include:true
					Name:modifyTimestamp
					Sample:20001128101515Z
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:MetaMerge AS
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:Akersgaten 43
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:en
					Syntax:java.lang.String
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:kathinka.furst@uwc.net
					Syntax:java.lang.String
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:kathinka_furst@hotmail.com
					Syntax:java.lang.String
				}
				searchBase {
					Include:true
					Name:searchBase
					Sample:o=UWC@cn=Colleges
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Krekoski
					Syntax:java.lang.String
				}
				structuralObjectClass {
					Include:true
					Name:structuralObjectClass
					Sample:cdsIntraStoreUser
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:9003 3738
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Student
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:pc99ekre
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:{CRYPT}AFFWOFQ
					Syntax:java.lang.String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Sara
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:xcxcv
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:530528
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:{T.61}Sofie (1985)$Sara (1988)
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:PC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Janice
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:deBoer
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:{T.61}MBA / Sivil?konom
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:{T.61}Universitre Fribourg, Switzerland$Hxogskolan i Karlstad, Sweden
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:{T.61}Chemistry!
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1995
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:ff
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:sdfsdf
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:gg
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:asdasd
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:fdsf
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:5
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:zxczxc
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Skiing, canoeing
					Syntax:java.lang.String
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Ryenbergveien 54,0196 Oslo, Norway
					Syntax:java.lang.String
				}
				uwcMaidenName {
					Include:true
					Name:uwcMaidenName
					Sample:Louisa Ellinor R. Nilsson
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:married
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:sssd
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:qwe
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Sidsel
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:0777
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Entrepenuer
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:sda
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:asd
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Former Student
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Accountancy, Finance, Investment at Fribourg Univ.
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:no
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1999
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:6
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:xcvcv
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:{T.61}1980-82 Sales Manager \\"VingCard Systems\\", London, UK$1983-85 Sales Director (Austria,BeNeLux
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:N-1356
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://www.metamerge.com
					Syntax:java.lang.String
				}
				uwcpictureURI {
					Include:true
					Name:uwcpictureURI
					Sample:fff
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\Metamerge\\UWC\\EDB
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CDS-EDB
			}
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:metamerge.CDS-EDB
			}
			type:Iterator
			updateAttributes {
				filePathname {
					add:false
					flow:ret.value = conn.getAttribute("filePathname");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				mhsMessageStoreName {
					add:false
					flow:ret.value = conn.getAttribute("mhsMessageStoreName");
					mod:false
				}
				objectClass {
					add:false
					flow:ret.value = conn.getAttribute("objectClass");
					mod:false
				}
				preferredRfc822Originator {
					add:false
					flow:ret.value = conn.getAttribute("preferredRfc822Originator");
					mod:false
				}
				preferredRfc822Recipient {
					add:false
					flow:ret.value = conn.getAttribute("preferredRfc822Recipient");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		Retrieve {
			ALEvent {
				lookup_fail {
					active:true
					flow:main.logmsg("lookup failed for " + work.getString("uid"));
				}
			}
			advancedLink:false
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchScope:onelevel
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				cn {
					add:false
					flow:ret.value = conn.getAttribute("cn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				mailAlternateAddress {
					add:false
					flow:ret.value = conn.getAttribute("mailAlternateAddress");
					mod:false
				}
				mailForwardingAddress {
					add:false
					flow:ret.value = conn.getAttribute("mailForwardingAddress");
					mod:false
				}
				objectclass {
					add:false
					flow:ret.value = conn.getAttribute("objectclass");
					mod:false
				}
				sn {
					add:false
					flow:ret.value = conn.getAttribute("sn");
					mod:false
				}
				userPassword {
					add:false
					flow:ret.value = conn.getAttribute("userPassword");
					mod:false
				}
				uwcCollege {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollege");
					mod:false
				}
				uwcCollegeFirstName {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollegeFirstName");
					mod:false
				}
				uwcCollegeSurname {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollegeSurname");
					mod:false
				}
				uwcStartYear {
					add:false
					flow:ret.value = conn.getAttribute("uwcStartYear");
					mod:false
				}
			}
		}
		Write {
			ALEvent {
				addonly_fail {
					active:true
					flow:main.logmsg("FAILED to ADD: " + work.getString("uid"));
				}
				after_add {
					active:true
					flow:MIG.add(work);
				}
				before_add {
					active:false
					flow:
				}
				before_execute {
					active:false
					flow:
				}
				before_modify {
					active:true
					flow:main.logmsg("modify " + work.getString("uid"));
				}
				before_update {
					active:true
					flow:task.dumpEntry(conn);
				}
				update_fail {
					active:true
					flow:main.logmsg("FAILED to UPDATE: " + work.getString("uid"));\nmain.logmsg(error.getString("message"));
				}
				update_multiple {
					active:true
					flow:main.logmsg("FOUND MULTIPLE : " + work.getString("uid"));\nsystem.skipEntry();
				}
				update_ok {
					active:false
					flow:
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchScope:onelevel
			}
			inheritAM:
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = work.getAttribute("$dn");
					mod:true
				}
				cn {
					add:true
					flow:ret.value = work.getAttribute("cn");
					mod:true
				}
				deliveryMode {
					add:true
					flow:if (local)\n\tret.value = "localdelivery";\nelse if (forward)\n\tret.value = "nombox";
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				mailAlternateAddress {
					add:true
					flow:ret.value = work.getAttribute("mailAlternateAddress");
					mod:true
				}
				mailForwardingAddress {
					add:true
					flow:ret.value = work.getAttribute("mailForwardingAddress");
					mod:true
				}
				mailMessageStore {
					add:true
					flow:if (local)\n\tret.value = work.getString("uid").toLowerCase();\nelse ret.value = "";
					mod:true
				}
				migCategory {
					add:true
					flow:ret.value = "MIGuser";
					mod:true
				}
				objectclass {
					add:true
					flow:ret.value = work.getAttribute("objectclass");\nret.value.addValue("MIGitem");
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("sn");
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
				userPassword {
					add:true
					flow:ret.value = work.getString("uid");\n/*\nx = work.getObject("userPassword");\n\nif (x != null)\n{\n\tpass = "{crypt}";\n\tfor ( i = 7; i < x.length; i++ ) \n\t{\n\t   pass += String.fromCharCode(x[i]);\n\t}\nret.value = pass;\n}\nelse ret.value = null;\n*/
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("uwcCollege");
					mod:true
				}
				uwcCollegeFirstName {
					add:true
					flow:ret.value = work.getAttribute("uwcCollegeFirstName");
					mod:true
				}
				uwcCollegeSurname {
					add:true
					flow:ret.value = work.getAttribute("uwcCollegeSurname");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("uwcStartYear");
					mod:true
				}
			}
		}
		dump {
			attributeList {
			}
			enabled:true
			parserConfig {
			}
			script:if (!work.getAttribute("objectclass").hasValueIC("person"))\n\tsystem.skipEntry();\n\nlocal = false;\nforward = false;\n\nif (work.getAttribute("preferredRfc822Recipient") != null)\n{\n\tif ((work.getString("preferredRfc822Recipient").endsWith("unity.uwc.org")) || (work.getString("preferredRfc822Recipient").endsWith("uwc.net") && work.getString("preferredRfc822Recipient").equalsIgnoreCase(work.getString("mail"))))\n\t{\n\t\tlocal = true;\n\t\tnblocal++;\n\t}\n\telse\n\t{\n\t\tforward = true;\n\t\tnbforward++;\n\t}\n}\nelse if ((work.getAttribute("filePathName") != null) && (work.getAttribute("mhsMessageStoreName") != null))\n{\n\tlocal = true;\n\tnblocal++;\n}\nelse nbnone++;\n\nif (!local && !forward)\n\tsystem.skipEntry();
			type:Script
		}
	}
	debug:false
	description:Fix Email settings after IntraStore2OpenLDAP
	epilog:main.logmsg("Local: " + nblocal);\nmain.logmsg("Forward: " + nbforward);\nmain.logmsg("None: " + nbnone);\n
	include:true
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:var local = false;\nvar forward = false;\n\nvar nblocal = 0;\nvar nbforward = 0;\nvar nbnone = 0;
	prolog0:
	scriptEngine:JavaScript
	source:D:\\Atelier\\Metamerge\\UWC\\freedom.uwc.net.100302.cfg
	verbose:600
[end]

[task SendEmail]
	IOSettings {
	}
	automapattributes:true
	componentlist [
		Directory.check
		Directory.add
		email.send
		feedback.send
	]
	components {
		Directory.add {
			ALEvent {
				addonly_fail {
					active:true
					flow:file_to_send_back = "error.htm";\ntask.logmsg(error.getString("message"));\n\nwork.setProperty("after_default_onError", "skip");\n\n// to remove when 4.6.8\n\nerror = system.sendMail("integrator@uwc.net",\n\t"christian@uwc.net",\n\t"An error occured",\n\t"\\nHere's what the error object says.\\n\\n" + error.getString("message"),\n\t"");\n\nif (work.getProperty("after_default_onError") != null)\n{\n\tif (work.getProperty("after_default_onError").equalsIgnoreCase("skip"))\n\t\tsystem.skipEntry();\n\twork.setProperty("after_default_onError", null);\n}
				}
				addonly_ok {
					active:false
					flow:\n
				}
				after_add {
					active:true
					flow:work.setAttribute("$dn", conn.getString("$dn"));\nwork.setAttribute("cn", conn.getString("cn"));\nwork.setAttribute("uwcCollege", conn.getString("uwcCollege"));\nwork.setAttribute("mail", conn.getString("mail"));\nwork.setAttribute("uid", conn.getString("uid"));\n
				}
				before_add {
					active:true
					flow:task.dumpEntry(conn);
				}
				before_execute {
					active:false
					flow:
				}
				default_fail {
					active:true
					flow:error = system.sendMail("integrator@uwc.net",\n\t"christian@uwc.net",\n\t"An error occured",\n\t"\\nHere's what the error object says.\\n\\n" + error.getString("message"),\n\t"");\n\nif (work.getProperty("after_default_onError") != null)\n{\n\tif (work.getProperty("after_default_onError").equalsIgnoreCase("skip"))\n\t\tsystem.skipEntry();\n\twork.setProperty("after_default_onError", null);\n}
					name:Default fail
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=jhildebrand,ou=customers,o=metamerge
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGadmin
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Jeff Hildebrand
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Jeff
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:jeffhild@gte.net
					Syntax:java.lang.String
				}
				mmAlsoKnownAs {
					Include:true
					Name:mmAlsoKnownAs
					Sample:Krist
					Syntax:java.lang.String
				}
				mmCountry {
					Include:true
					Name:mmCountry
					Sample:AF
					Syntax:java.lang.String
				}
				mmGender {
					Include:true
					Name:mmGender
					Sample:Male
					Syntax:java.lang.String
				}
				mmHonorific {
					Include:true
					Name:mmHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				mmLastModifiedBy {
					Include:true
					Name:mmLastModifiedBy
					Sample:cchateauvieux
					Syntax:java.lang.String
				}
				mmLastModifiedDate {
					Include:true
					Name:mmLastModifiedDate
					Sample:08/10/01 09:29:35
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:person
					Syntax:java.lang.String
				}
				organisation {
					Include:true
					Name:organisation
					Sample:Metamerge
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:fr
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Hildebrand
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:jhildebrand
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@7db177
					Syntax:ByteArray
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnityFailedRegistrations
			}
			inheritAM:
			inheritEH:LDAPUnityFailedRegistrations
			link [
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ", cn=Failed Registrations"; \n
					mod:false
				}
				cn {
					add:true
					flow:var sFirstname = bettersystem.makeTitleCase(work.getString("http.qs.givenname"));\nvar sLastname = bettersystem.makeTitleCase(work.getString("http.qs.sn"));\n\nsFullname = sFirstname + " " + sLastname;\n\nret.value = system.trim(sFullname); \n
					mod:false
				}
				givenName {
					add:true
					flow:ret.value = bettersystem.makeTitleCase(work.getString("http.qs.givenname"));
					mod:false
				}
				mail {
					add:true
					flow:ret.value = bettersystem.translate2ascii(work.getString("http.qs.email"), 1); \n\n
					mod:false
				}
				migLastModifiedBy {
					add:true
					flow:ret.value = "User self-registration process";
					mod:false
				}
				migLastModifiedDate {
					add:true
					flow:ret.value = system.formatDate(today, "yyyyMMddHHmmssz");
					mod:false
				}
				objectClass {
					add:true
					flow:objClass = system.newAttribute("objectclass");\nobjClass.addValue("person");\nobjClass.addValue("inetOrgPerson");\nobjClass.addValue("organizationalPerson");\nobjClass.addValue("uwcPerson");\nobjClass.addValue("top");\nobjClass.addValue("MIGitem");\n \nret.value = objClass;
					mod:false
				}
				sn {
					add:true
					flow:ret.value = bettersystem.makeTitleCase(work.getString("http.qs.sn"));
					mod:false
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uwcCollege");
					mod:true
				}
				uwcCollegeFirstName {
					add:true
					flow:ret.value = bettersystem.makeTitleCase(work.getString("http.qs.givenname"));
					mod:true
				}
				uwcCollegeSurName {
					add:true
					flow:ret.value = bettersystem.makeTitleCase(work.getString("http.qs.sn"));
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uwcStartYear");
					mod:true
				}
			}
		}
		Directory.check {
			ALEvent {
				before_execute {
					active:true
					flow:tempname = system.remove ("\\\\ /,'-_", work.getString("http.qs.sn"));\n\nif (tempname.length() >= 3)\n\tlastname = bettersystem.translate2ascii(tempname.substring(0,3).toLowerCase(), 1);\nelse lastname = bettersystem.translate2ascii(tempname.substring(0,tempname.length()).toLowerCase(), 1);\n\nMyUid = work.getString("http.qs.uwcCollege").toLowerCase()\n\t\t\t+ work.getString("http.qs.uwcStartYear").substring(2)\n\t\t\t+ bettersystem.translate2ascii(work.getString("http.qs.givenname").substring(0,1).toLowerCase(), 1)\n\t\t\t+ lastname;\n\nMyUid = system.remove ("\\\\ /,", MyUid);\n\nwork.setAttribute ("_originalUid", MyUid);\n\nif (counter > 1)\n\tMyUid = MyUid.substring(0, MyUid.length() - 1) + counter;\n\nwork.setAttribute ("uid", MyUid);\ntask.logmsg("link criteria set to " + MyUid);\n
				}
				before_lookup {
					active:false
					flow:
				}
				default_fail {
					active:true
					flow:error = system.sendMail("integrator@uwc.net",\n\t"christian@uwc.net",\n\t"An error occured",\n\t"\\nHere's what the error object says.\\n\\n" + error.getString("message"),\n\t"");\n\nif (work.getProperty("after_default_onError") != null)\n{\n\tif (work.getProperty("after_default_onError").equalsIgnoreCase("skip"))\n\t\tsystem.skipEntry();\n\twork.setProperty("after_default_onError", null);\n}
				}
				lookup_fail {
					active:true
					flow:task.logmsg ("Lookup failed, so we can continue");\nsystem.ignoreEntry();\n \n
				}
				lookup_ok {
					active:true
					flow:// if user already registered, set link to his uid, otherwise find unused uid\n\ntask.logmsg ("Lookup succeeded, so we must try another uid");\ncounter++;\n// work.removeAllAttributes() ?\nsystem.restartEntry();\n\n\n
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=cchateauvieux,ou=test, o=metamerge
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGUser
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Christian Châteauvieux
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Christian
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:christian@metamerge.com
					Syntax:java.lang.String
				}
				mmIntegratedSystems {
					Include:true
					Name:mmIntegratedSystems
					Sample:Microsoft
					Syntax:java.lang.String
				}
				mmLastModifiedBy {
					Include:true
					Name:mmLastModifiedBy
					Sample:User self-registration process
					Syntax:java.lang.String
				}
				mmLastModifiedDate {
					Include:true
					Name:mmLastModifiedDate
					Sample:Dec 14, 2001 6:59:49 PM
					Syntax:java.lang.String
				}
				mmWhereFrom {
					Include:true
					Name:mmWhereFrom
					Sample:Metamerge Reseller conference
					Syntax:java.lang.String
				}
				mmWorkCity {
					Include:true
					Name:mmWorkCity
					Sample:p
					Syntax:java.lang.String
				}
				mmWorkCountry {
					Include:true
					Name:mmWorkCountry
					Sample:AF
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:mmcust
					Syntax:java.lang.String
				}
				organisation {
					Include:true
					Name:organisation
					Sample:k
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Châteauvieux
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:12
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:cchateauvieux
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@673783
					Syntax:ByteArray
				}
			}
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			inheritEH:OpenLDAP
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				cn {
					add:false
					flow:ret.value = conn.getAttribute("cn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				userDN {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
			}
		}
		email.send {
			enabled:true
			script:alreadyRegistered = "no";\n\n\nemailText = work.getString("cn") + " (" + work.getString("mail") + ") ";\n\nemailText += "has attemted to register on the UWC directory.";\n\nif (counter > 1)\n{\n\temailText += "\\n\\nWARNING: THIS PERSON MAY ALREADY EXIST IN THE DIRECTORY. Integrator found";\n\tfor (i = 0; i < counter; i++)\n\t{\n\t\tif (i != 1)\n\t\t{\n\t\t\tif (i > 0) emailText += ",";\n\t\t\temailText += " one record having " + work.getString("_originalUid");\n\t\t\tif (i != 0) emailText += i;\n\t\t\temailText += " as a UID";\n\t\t}\n\t}\n\temailText += ".\\nPlease check the directory; the newly created record has got " + MyUid + " as a UID and should be deleted if it is a duplicate of an existing record.\\n\\n";\n}\nelse emailText += "\\nThe person must be qualified first, so please take some time to view and edit the record.\\n\\n";\n\nemailText += \n\t"Click the following link to view / edit the record:\\n" \n\t+ "http://www.uwc.net/MIG/record_management.html?class=uwcNetworkUnity&dn=" + escape(work.getString("$dn")) + "\\n\\n\\n";\n\nemailText +=\n\t"Click the following link to";\n\nif (work.getAttribute("MigCategory") == null)\n\temailText += "\\n\\t - automatically activate the account login";\n\nemailText += \n\t"\\nhttp://" + host + "/index.htm?action=update&uid=" + escape(work.getString("uid"))\n\n\nsubject += " " + work.getString("cn") + " (" + work.getString("uwcCollege") + ")"; \nerror = system.sendMail(sendFrom, sendTo, subject, emailText, "");\n\t\n\n\nif ( error == null ) \n\tfile_to_send_back = "thankyou-popup.html";\nelse\n{\n\tfile_to_send_back = "error.htm";\n\tsystem.skipEntry();\n}
			type:Script
		}
		feedback.send {
			enabled:true
			script:mail = work.getString("http.qs.email");\n\ntext = "Thank you for your interest in the UWC Global Directory! One of our representatives will be in touch with you shortly.\\n\\nThe Global Directory Team";\n\nerror = system.sendMail(sendOutFrom, mail, sendOutSubject, text, "");\n\nif ( error == null ) \n\tfile_to_send_back = "thankyou-popup.html";\nelse\n\tfile_to_send_back = "error.htm";
			type:Script
		}
	}
	debug:false
	description:Converts from HTML, adds entry in directory, sends email to business team
	epilog:work.setAttribute("file_to_send_back", file_to_send_back);\n
	include:true
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var counter = 1;\nvar today = new java.util.Date();\n\n// HTML OPTIONS\nvar host = "www.uwc.net:8898";\n\n// EMAIL OPTIONS \n\n// Email sent to Account Qualifiers\nvar sendTo = "support@uwc.net";\nvar sendFrom = "integrator@uwc.net";\nvar subject = "** New user request: ";\n\n// Email sent to Web user\nvar sendOutFrom = "support@uwc.net";\nvar sendOutSubject = "Your UWC Global Directory Registration inquiry";\n\n
	prolog0:var crucialAttributes = ["http.qs.email", "http.qs.givenname", "http.qs.sn", "http.qs.uwcCollege", "http.qs.uwcStartYear"];\n\nfor (i = 0; i < crucialAttributes.length; i++)\n{\n\tif ((work.getAttribute(crucialAttributes[i]) == null) || (work.getString(crucialAttributes[i]) == ""))\n\t{\n\t\tfile_to_send_back = "500.htm";\n\t\tsystem.abortAL("At least one required field was not received from the web form: " + crucialAttributes[i]);\n\t}\n}\n
	scriptEngine:JavaScript
	source:C:\\Atelier\\Metamerge\\UWC\\userAutoReg\\out_vpn\\out_vpn\\out-VPN.cfg
[end]

[task Unity Dump]
	IOSettings {
	}
	automapattributes:true
	componentlist [
		read
		write
	]
	components {
		read {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchFilter:objectclass=*
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
			}
		}
		write {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:output
				filePath:D:\\Atelier\\Metamerge\\UWC\\unity-250602.ldif
				inheritFrom:metamerge.FileSystem
				parser:metamerge.LDIF
			}
			link [
			]
			override {
			}
			parserConfig {
				debug:false
				inheritFrom:metamerge.LDIF
				ldifDNAttributeName:$dn
			}
			type:AddOnly
			updateAttributes {
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
	verbose:500
[end]

[task Update Directory]
	IOSettings {
	}
	automapattributes:true
	componentlist [
		Directory.lookup
		Directory.update
		Email.send
		Feedback.send
	]
	components {
		Directory.lookup {
			ALEvent {
				lookup_fail {
					active:true
					flow:file_to_send_back = "error.htm";\ntask.logmsg(error.getString("message"));\n\nwork.setProperty("after_default_onError", "skip");\n\n
				}
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPUnityFailedRegistrations
			}
			inheritEH:LDAPUnityFailedRegistrations
			link [
				uid:=|$http.qs.uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				cn {
					add:false
					flow:ret.value = conn.getAttribute("cn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
				uwcCollege {
					add:false
					flow:ret.value = conn.getAttribute("uwcCollege");
					mod:false
				}
			}
		}
		Directory.update {
			ALEvent {
				addonly_fail {
					active:true
					flow:file_to_send_back = "error.htm";\nsystem.skipEntry();
				}
				addonly_ok {
					active:true
					flow:file_to_send_back = "thank_you.htm";\n
				}
				after_add {
					active:true
					flow:work.setAttribute("uid", conn.getString("uid"));\nwork.setAttribute("cn", conn.getString("cn"));\nwork.setAttribute("mail", conn.getString("mail"));\n
				}
				before_execute {
					active:false
					flow:
				}
				before_modify {
					active:false
					flow:
				}
				update_fail {
					active:true
					flow:file_to_send_back = "error.htm";\ntask.logmsg(error.getString("message"));\nwork.setProperty("after_default_onError", "skip");
				}
				update_ok {
					active:false
					flow:\n
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=jhildebrand,ou=customers,o=metamerge
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGadmin
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Jeff Hildebrand
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Jeff
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:jeffhild@gte.net
					Syntax:java.lang.String
				}
				mmAlsoKnownAs {
					Include:true
					Name:mmAlsoKnownAs
					Sample:Krist
					Syntax:java.lang.String
				}
				mmCountry {
					Include:true
					Name:mmCountry
					Sample:AF
					Syntax:java.lang.String
				}
				mmGender {
					Include:true
					Name:mmGender
					Sample:Male
					Syntax:java.lang.String
				}
				mmHonorific {
					Include:true
					Name:mmHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				mmLastModifiedBy {
					Include:true
					Name:mmLastModifiedBy
					Sample:cchateauvieux
					Syntax:java.lang.String
				}
				mmLastModifiedDate {
					Include:true
					Name:mmLastModifiedDate
					Sample:08/10/01 09:29:35
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:person
					Syntax:java.lang.String
				}
				organisation {
					Include:true
					Name:organisation
					Sample:Metamerge
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:fr
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Hildebrand
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:jhildebrand
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@7db177
					Syntax:ByteArray
				}
			}
			compute_changes:true
			connectorConfig {
				connectorType:@Directory.lookup
				inheritFrom:@Directory.lookup
			}
			inheritAM:
			inheritEH:LDAPUnityFailedRegistrations
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = "uid=" + work.getString("uid") + ", " + base;
					mod:true
				}
				migLastModifiedBy {
					add:false
					flow:ret.value = work.getAttribute("ModifierUID");
					mod:true
				}
				migLastModifiedDate {
					add:false
					flow:ret.value = system.formatDate(today, "yyyyMMddHHmmssz");
					mod:true
				}
			}
		}
		Email.send {
			enabled:true
			script:/* ------------------------- EMAIL GENERATION ------------------------- */\n\t\ntext = \n\t"Dear " + work.getString("cn") + ","\n\t+ "\\n\\nThank you for your interest in the UWC Global Directory.\\n\\nYou should now be able to register at http://www.uwc.org/NEWUSER\\n\\nEnjoy!";\n\ntask.logmsg ("Sending email to " + work.getString("mail"));\n\nerror = system.sendMail(sendFrom, work.getString("mail"), subject, text, "");\nif ( error == null ) \n\tfile_to_send_back = "thank_you.htm";\nelse\n{\n\tfile_to_send_back = "error.htm";\n\tsystem.skipEntry();\n}\n\n/* ---------------------END EMAIL GENERATION -------------------------- */
			type:Script
		}
		Feedback.send {
			enabled:true
			script:error = system.sendMail("integrator@uwc.net",\n\t"support@uwc.net",\n\t"** " +  work.getString("cn") + " (" + work.getString("uwcCollege") + ") has been processed",\n\t"\\nThis is an automated report generated by Metamerge Integrator. The request was serviced by " + work.getString("ModifierFullName") + ".",\n\t"");\n\nif (error == null)\n\tfile_to_send_back = "thank_you.htm";\nelse\n\tfile_to_send_back = "error.htm";
			type:Script
		}
	}
	debug:false
	description:Converts from HTML, updates Directory, sends email to user with license file
	epilog:work.setAttribute("file_to_send_back", file_to_send_back);
	include:true
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var today = new java.util.Date();\n\n// ------------ EMAIL OPTIONS --------------\nvar sendFrom = "support@uwc.net";\nvar subject = "Your UWC Global Directory inquiry";\n
	scriptEngine:JavaScript
	source:C:\\Atelier\\Metamerge\\UWC\\userAutoReg\\in_vpn\\in-VPN.cfg
[end]

[task csv2csv.NatCom2002]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		change_first_name
		lookup
		add
	]
	components {
		add {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:output
				filePath:D:\\Atelier\\Metamerge\\UWC\\q-Bulle-out.csv
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumnSeparator:,
				csvEnableQuoting:true
				csvLogLongLines:0
				csvWriteHeader:true
				inheritFrom:metamerge.CSV
			}
			type:AddOnly
			updateAttributes {
				Active {
					add:true
					flow:ret.value = work.getAttribute("Active");
					mod:true
				}
				Address line 1 {
					add:true
					flow:ret.value = work.getAttribute("Address line 1");
					mod:true
				}
				Address line 2 {
					add:true
					flow:ret.value = work.getAttribute("Address line 2");
					mod:true
				}
				Address line 3 {
					add:true
					flow:ret.value = work.getAttribute("Address line 3");
					mod:true
				}
				City {
					add:true
					flow:ret.value = work.getAttribute("City");
					mod:true
				}
				First name {
					add:true
					flow:ret.value = work.getAttribute("First name");
					mod:true
				}
				Postnr (front) {
					add:true
					flow:ret.value = work.getAttribute("Postnr (front)");
					mod:true
				}
				Surname {
					add:true
					flow:ret.value = work.getAttribute("Surname");
					mod:true
				}
				homePhone {
					add:true
					flow:ret.value = work.getAttribute("homePhone");
					mod:true
				}
				homePostalAddress {
					add:true
					flow:ret.value = work.getAttribute("homePostalAddress");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				mailAlternateAddress {
					add:true
					flow:ret.value = work.getAttribute("mailAlternateAddress");
					mod:true
				}
				mailForwardingAddress {
					add:true
					flow:ret.value = work.getAttribute("mailForwardingAddress");
					mod:true
				}
				postalAddress {
					add:true
					flow:ret.value = work.getAttribute("postalAddress");
					mod:true
				}
				telephoneNumber {
					add:true
					flow:ret.value = work.getAttribute("telephoneNumber");
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
				uwcCity {
					add:true
					flow:ret.value = work.getAttribute("uwcCity");
					mod:true
				}
				uwcCountry {
					add:true
					flow:ret.value = work.getAttribute("uwcCountry");
					mod:true
				}
				uwcFallbackContactAddress {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactAddress");
					mod:true
				}
				uwcFallbackContactCity {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactCity");
					mod:true
				}
				uwcFallbackContactCountry {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactCountry");
					mod:true
				}
				uwcFallbackContactName {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactName");
					mod:true
				}
				uwcFallbackContactPostalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactPostalCode");
					mod:true
				}
				uwcFallbackContactProvince {
					add:true
					flow:ret.value = work.getAttribute("uwcFallbackContactProvince");
					mod:true
				}
				uwcHomePhoneAreaCode {
					add:true
					flow:ret.value = work.getAttribute("uwcHomePhoneAreaCode");
					mod:true
				}
				uwcHomePhoneInternationalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcHomePhoneInternationalCode");
					mod:true
				}
				uwcPostalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcPostalCode");
					mod:true
				}
				uwcProvince {
					add:true
					flow:ret.value = work.getAttribute("uwcProvince");
					mod:true
				}
				uwcTelephoneNumberAreaCode {
					add:true
					flow:ret.value = work.getAttribute("uwcTelephoneNumberAreaCode");
					mod:true
				}
				uwcTelephoneNumberInternationalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcTelephoneNumberInternationalCode");
					mod:true
				}
				uwcWorkCity {
					add:true
					flow:ret.value = work.getAttribute("uwcWorkCity");
					mod:true
				}
				uwcWorkCountry {
					add:true
					flow:ret.value = work.getAttribute("uwcWorkCountry");
					mod:true
				}
				uwcWorkPostalCode {
					add:true
					flow:ret.value = work.getAttribute("uwcWorkPostalCode");
					mod:true
				}
				uwcWorkProvince {
					add:true
					flow:ret.value = work.getAttribute("uwcWorkProvince");
					mod:true
				}
			}
		}
		change_first_name {
			enabled:true
			script:if (retry)\n{\n\tstr = "" + work.getString("First name");\n\twork.setAttribute("First name", str.split(" ")[count-1]);\n\tmain.logmsg("retrying " + work.getString("first name"));\n}\n
			type:Script
		}
		lookup {
			ALEvent {
				lookup_fail {
					active:true
					flow:if (count >= 2)\n\tchange = true;\nelse \n{\n\tchange = false;\n\tretry = true;\n\tcount++;\t\n\tsystem.restartEntry();\n}\n\nif (change)\n{\n\tretry = false;\n\tcount = 0;\n}
				}
				lookup_ok {
					active:true
					flow:retry = false;\ncount = 0;
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=nc00bcha,o=uwc
					Syntax:java.lang.String
				}
				MigLastModifiedBy {
					Include:true
					Name:MigLastModifiedBy
					Sample:nc00bcha
					Syntax:java.lang.String
				}
				MigLastModifiedDate {
					Include:true
					Name:MigLastModifiedDate
					Sample:20020517095248PDT
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Bhakta Chand
					Syntax:MUST/String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:nombox
					Syntax:java.lang.String
				}
				description {
					Include:true
					Name:description
					Sample:
					Syntax:MAY/String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+1 (404) 894-8905
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Bhakta
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:28440
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:SOS Youth Facility$Biratnagar$Malaya Road, Biratnagar-17$Post box-149$Nepal
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:http://www.geocities.com/bhakta_chand
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:nc00bcha@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:bhakta.chand@uwc.net
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:nc00bcha@rcnuwc.uwc.org
					Syntax:java.lang.String
				}
				mailMessageStore {
					Include:true
					Name:mailMessageStore
					Sample:aw83aqui
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+1 (404) 247-1896
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:Georgia Institute of Technology
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:School of Psychology, $ Georgia Insitute of $ Technology, $ 274 5th Street
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:sq
					Syntax:java.lang.String
				}
				seeAlso {
					Include:true
					Name:seeAlso
					Sample:
					Syntax:MAY/String
				}
				sn {
					Include:true
					Name:sn
					Sample:Chand
					Syntax:MUST/String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+977 25 81567
					Syntax:MAY/String
				}
				title {
					Include:true
					Name:title
					Sample:Assistant Professor of Psychology and Computing
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:nc00bcha
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@1bf785
					Syntax:MAY/String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Arun
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:Mr Bhakta Bahadur Chand is a graduate from UWC Norway in the year 2000-2002.$
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:19830619
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:None
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Biratnagar
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:nc
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Bhakta
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Chand
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:NP
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:PhD
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:Not yet,,, (-_-)
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Everything
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:2002
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:SOS youth facility Biratnagar$Malaya Road, Biratnagar-149$nepal
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:biratnagar
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:NP
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:Mr Damaru Ballav Subedi
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:V9T 4G5
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:BC
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:21
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:0997
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:ICQ:4054874
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Sports, music
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:single
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:Bahadur
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Albanian
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Nydia Rivera
					Syntax:java.lang.String
				}
				uwcPictureURI {
					Include:true
					Name:uwcPictureURI
					Sample:http://w3.rcnuwc.uwc.org/people/astudentpage.asp?UWCID=nc00bcha
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:Post box-149
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Student
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:Georgia
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Former Student
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Bruce
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:sq
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:2000
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:404
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:1
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:http://w3.rcnuwc.uwc.org/people/astudentpage.asp?UWCID=nc00bcha
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Atlanta
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:US
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:never worked in my life
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:30332-0170
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Georgia
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://www.psychology.gatech.edu
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchScope:onelevel
			}
			link [
				gn:~|$First name
				sn:=|$Surname
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				homePhone {
					add:false
					flow:ret.value = conn.getAttribute("homePhone");
					mod:false
				}
				homePostalAddress {
					add:false
					flow:ret.value = conn.getAttribute("homePostalAddress");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				mailAlternateAddress {
					add:false
					flow:ret.value = conn.getAttribute("mailAlternateAddress");
					mod:false
				}
				mailForwardingAddress {
					add:false
					flow:ret.value = conn.getAttribute("mailForwardingAddress");
					mod:false
				}
				postalAddress {
					add:false
					flow:ret.value = conn.getAttribute("postalAddress");
					mod:false
				}
				telephoneNumber {
					add:false
					flow:ret.value = conn.getAttribute("telephoneNumber");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
				uwcCity {
					add:false
					flow:ret.value = conn.getAttribute("uwcCity");
					mod:false
				}
				uwcCountry {
					add:false
					flow:ret.value = conn.getAttribute("uwcCountry");
					mod:false
				}
				uwcFallbackContactAddress {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactAddress");
					mod:false
				}
				uwcFallbackContactCity {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactCity");
					mod:false
				}
				uwcFallbackContactCountry {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactCountry");
					mod:false
				}
				uwcFallbackContactName {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactName");
					mod:false
				}
				uwcFallbackContactPostalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactPostalCode");
					mod:false
				}
				uwcFallbackContactProvince {
					add:false
					flow:ret.value = conn.getAttribute("uwcFallbackContactProvince");
					mod:false
				}
				uwcHomePhoneAreaCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcHomePhoneAreaCode");
					mod:false
				}
				uwcHomePhoneInternationalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcHomePhoneInternationalCode");
					mod:false
				}
				uwcPostalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcPostalCode");
					mod:false
				}
				uwcProvince {
					add:false
					flow:ret.value = conn.getAttribute("uwcProvince");
					mod:false
				}
				uwcTelephoneNumberAreaCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcTelephoneNumberAreaCode");
					mod:false
				}
				uwcTelephoneNumberInternationalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcTelephoneNumberInternationalCode");
					mod:false
				}
				uwcWorkCity {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkCity");
					mod:false
				}
				uwcWorkCountry {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkCountry");
					mod:false
				}
				uwcWorkPostalCode {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkPostalCode");
					mod:false
				}
				uwcWorkProvince {
					add:false
					flow:ret.value = conn.getAttribute("uwcWorkProvince");
					mod:false
				}
			}
		}
		read {
			ALEvent {
			}
			attributeList {
				Active {
					Include:true
					Name:Active
					Sample:true
					Syntax:java.lang.Boolean
				}
				Address line 1 {
					Include:true
					Name:Address line 1
					Sample:Klostergaten 69
					Syntax:java.lang.String
				}
				Address line 2 {
					Include:true
					Name:Address line 2
					Sample:
					Syntax:java.lang.String
				}
				Address line 3 {
					Include:true
					Name:Address line 3
					Sample:
					Syntax:java.lang.String
				}
				City {
					Include:true
					Name:City
					Sample:TRONDHEIM
					Syntax:java.lang.String
				}
				First name {
					Include:true
					Name:First name
					Sample:Heidi og Tore
					Syntax:java.lang.String
				}
				Postnr (front) {
					Include:true
					Name:Postnr (front)
					Sample:7030
					Syntax:java.lang.String
				}
				Surname {
					Include:true
					Name:Surname
					Sample:Amundsen
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcSource:jdbc:odbc:q-bulle
				jdbcTable:data
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				Active {
					add:false
					flow:ret.value = conn.getAttribute("Active");
					mod:false
				}
				Address line 1 {
					add:false
					flow:ret.value = conn.getAttribute("Address line 1");
					mod:false
				}
				Address line 2 {
					add:false
					flow:ret.value = conn.getAttribute("Address line 2");
					mod:false
				}
				Address line 3 {
					add:false
					flow:ret.value = conn.getAttribute("Address line 3");
					mod:false
				}
				City {
					add:false
					flow:ret.value = conn.getAttribute("City");
					mod:false
				}
				First name {
					add:false
					flow:ret.value = conn.getAttribute("First name");\n
					mod:false
				}
				Postnr (front) {
					add:false
					flow:ret.value = conn.getAttribute("Postnr (front)");
					mod:false
				}
				Surname {
					add:false
					flow:ret.value = conn.getAttribute("Surname");
					mod:false
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var retry = false;\nvar count = 0;
	scriptEngine:JavaScript
[end]

[task custom2LDAP.headmasters-info]
	attribute_map {
	}
	automapattributes:false
	componentlist [
		hm
		ldap
	]
	components {
		hm {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				college {
					Include:true
					Name:college
					Sample:SOUTH EAST ASIA
					Syntax:java.lang.String
				}
				endyear {
					Include:true
					Name:endyear
					Sample:1977
					Syntax:java.lang.String
				}
				headmaster {
					Include:true
					Name:headmaster
					Sample:David Lloyd
					Syntax:java.lang.String
				}
				startyear {
					Include:true
					Name:startyear
					Sample:1976
					Syntax:java.lang.String
				}
				uwccollege {
					Include:true
					Name:uwccollege
					Sample:SEA
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:C:\\Program Files\\MetaMerge\\headmasters.txt
				inheritFrom:metamerge.FileSystem
				parser:headmasters
			}
			link [
			]
			override {
			}
			parserConfig {
				includeFiles:
				inheritFrom:headmasters
				scriptEngine:JavaScript
			}
			type:Iterator
			updateAttributes {
				college {
					add:false
					flow:ret.value = conn.getAttribute("college");
					mod:false
				}
				endyear {
					add:false
					flow:str = conn.getString("endyear");\nif (str.length() < 4) {\n\tret.value = "9999";\n} else {\n\tret.value = str;\n}\n
					mod:false
				}
				headmaster {
					add:false
					flow:ret.value = conn.getAttribute("headmaster");
					mod:false
				}
				startyear {
					add:false
					flow:str = conn.getString("startyear");\nif (str.length() < 4) {\n\tret.value = "9999";\n} else {\n\tret.value = str;\n}\n
					mod:false
				}
				uwccollege {
					add:false
					flow:ret.value = conn.getAttribute("uwccollege");
					mod:false
				}
			}
		}
		ldap {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:headmaster=1962 Desmond Hoare,ou=headmasters,o=uwc
				}
				headmaster {
					Include:true
					Name:headmaster
					Sample:Desmond Hoare
				}
				hmcollege {
					Include:true
					Name:hmcollege
					Sample:ATLANTIC COLLEGE
				}
				hmendyear {
					Include:true
					Name:hmendyear
					Sample:1968
				}
				hmstartyear {
					Include:true
					Name:hmstartyear
					Sample:1962
				}
				hmuwccollege {
					Include:true
					Name:hmuwccollege
					Sample:AC
				}
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchBase:ou=headmasters,o=uwc
				ldapSearchFilter:hmcollege=*
			}
			link [
				headmaster:=|$headmaster
				hmstartyear:=|$startyear
				hmuwccollege:=|$uwccollege
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "headmaster=" + \n\twork.getString("uwccollege") +  " " +\n\twork.getString("startyear") +  " " +\n\twork.getString("headmaster") +\n\t",ou=headmasters,o=uwc";\n
					mod:true
				}
				headmaster {
					add:true
					flow:ret.value = work.getAttribute("headmaster");
					mod:true
				}
				hmcollege {
					add:true
					flow:ret.value = work.getAttribute("college");
					mod:true
				}
				hmendyear {
					add:true
					flow:ret.value = work.getString("endyear");\n
					mod:true
				}
				hmstartyear {
					add:true
					flow:ret.value = work.getString("startyear");\n
					mod:true
				}
				hmuwccollege {
					add:true
					flow:ret.value = work.getAttribute("uwccollege");
					mod:true
				}
				objectclass {
					add:true
					flow:ret.value = "headmaster";
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to import HeadMaster info into freedom's GD
	epilog:
	includeGlobalPrologs:true
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task fix rcnuwc.mailforwardingaddress]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		freedom.lookup
	]
	components {
		freedom.lookup {
			ALEvent {
				before_modify {
					active:true
					flow:if (current.getAttribute("deliverymode") != null)\n\tif (current.getString("deliverymode") == "nombox")\n\t{\n\t\tif (current.getString("mailForwardingAddress").equalsIgnoreCase("rcnuwcmail@unity.uwc.org"))\n\t\t\ttask.logmsg("Skipping update because mailforward already different");\n\t\t\tsystem.ignoreEntry();\n\t} \n
				}
				lookup_ok {
					active:true
					flow:main.dump(work);
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC70OEID,o=uwc
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGuser
					Syntax:java.lang.String
				}
				MigChallengeQuestion {
					Include:true
					Name:MigChallengeQuestion
					Sample:What is your preferred internet password?
					Syntax:java.lang.String
				}
				MigChallengeQuestionAnswer {
					Include:true
					Name:MigChallengeQuestionAnswer
					Sample:daddy
					Syntax:java.lang.String
				}
				MigLastModifiedBy {
					Include:true
					Name:MigLastModifiedBy
					Sample:ad96cgah
					Syntax:java.lang.String
				}
				MigLastModifiedDate {
					Include:true
					Name:MigLastModifiedDate
					Sample:Feb 25, 2002 11:53:48 AM
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Olaf Eidsaether
					Syntax:java.lang.String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:localdelivery
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+1 603 297 7599
					Syntax:java.lang.String
				}
				generationQualifier {
					Include:true
					Name:generationQualifier
					Sample:asd sdfs' sdf>z
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Olaf
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:22494994
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:Tennisveien 3E
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:http://www.ljone.net/
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:AC70OEID@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:olafe@start.no
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:christian.gahre@redcross.no
					Syntax:java.lang.String
				}
				mailHost {
					Include:true
					Name:mailHost
					Sample:www.uwc.org
					Syntax:java.lang.String
				}
				mailMessageStore {
					Include:true
					Name:mailMessageStore
					Sample:ac70oeid
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47-9003 3738
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:Norwegian Red Cross
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:Hausmannsgate 7 / $PO Box 1 GrÃ¸nland
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:en
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Eidsaether
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:9003 3738
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:Managing Dir.
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:AC70OEID
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@25b721
					Syntax:ByteArray
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Gino
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:I was born at a very early age. I was pretty shy and liked to read. Then I went to a UWC and that opened my eyes to the joys of dancing and sailing. I became a professional Ukranian dancer, before taking up my new career of software testing for the UWC.
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:530528
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:Sofie (1985)$Sara (1988)
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Olaf
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Eidsaether
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:NO
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:MBA / Siviløkonom
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:Université Fribourg, Switzerl
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economist
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1972
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:PO Box 54
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:SPANGEREID
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:Grete and Stein Gahre
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:4521
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:Quetzalcuatl
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:5773
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:19470147
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Skiing, canoeing
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:married
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:Haffner
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:Not much else to add.
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Sidsel
					Syntax:java.lang.String
				}
				uwcPictureURI {
					Include:true
					Name:uwcPictureURI
					Sample:http://w3.rcnuwc.uwc.org/people/photos/nc00dati.jpg
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:0777
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Entrepenuer
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:Status
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:Ester, T. (1998). Cool thoughts, warm words. New York: Random House
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Board/Committee migmodifieddata
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Ted
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:no
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1970
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:99
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:47
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:http://no.uwc.org/network/
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:OSLO
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:AF
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:1980-82 Sales Manager
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:0158
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Ohio
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:www.redcross.no
					Syntax:java.lang.String
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchScope:onelevel
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				mailForwardingAddress {
					add:true
					flow:ret.value = work.getAttribute("forward");
					mod:true
				}
			}
		}
		read {
			ALEvent {
			}
			attributeList {
				forward {
					Include:true
					Name:forward
					Sample:eaa@sas.upenn.edu
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:nc95aand
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\Metamerge\\UWC\\forwardrcnuwc.csv
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumnSeparator:,
				csvColumns:uid\nforward
				csvEnableQuoting:true
				csvLogLongLines:0
				csvWriteHeader:true
				inheritFrom:metamerge.CSV
			}
			type:Iterator
			updateAttributes {
				forward {
					add:false
					flow:ret.value = conn.getAttribute("forward");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task fix uwcaw mailAlternateAddress]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		freedom.lookup
	]
	components {
		freedom.lookup {
			ALEvent {
				lookup_ok {
					active:true
					flow:main.dump(work);
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				mailAlternateAddress:=|$address
			]
			linkScript:ret.filter = "";
			override {
			}
			type:Update
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:true
				}
				mailAlternateAddress {
					add:false
					flow:str = "" + work.getString("address");\nind = str.indexOf("@uwcaw.uwc.org");\nnewstr = str.substring(0, ind) + "@uwc.net";\nret.value = newstr;
					mod:true
				}
			}
		}
		read {
			ALEvent {
			}
			attributeList {
				address {
					Include:true
					Name:address
					Sample:Adriana.Botero@uwcaw.uwc.org
					Syntax:java.lang.String
				}
				name {
					Include:true
					Name:name
					Sample:mailAlternateAddress
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\Metamerge\\UWC\\wrongacemails.txt
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumnSeparator::
				csvColumns:name:address
				csvEnableQuoting:true
				csvLogLongLines:0
				csvWriteHeader:true
				inheritFrom:metamerge.CSV
			}
			type:Iterator
			updateAttributes {
				address {
					add:false
					flow:ret.value = conn.getAttribute("address");
					mod:false
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task quick schema lift]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		readCurrent
		write
		writeFile
	]
	components {
		readCurrent {
			ALEvent {
				get_ok {
					active:false
					flow:
				}
			}
			attributeList {
				attr {
					Include:true
					Name:attr
					Sample:attributetypes: (1.2.826.0.1341.1.30 NAME ( 'hmUWCCollege' ) DESC 'Headmaster college:' EQUALITY caseExactIA5Match SUBSTR caseIgnoreSubstringsMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.15  )
					Syntax:java.lang.String
				}
				ibmattr {
					Include:true
					Name:ibmattr
					Sample:ibmattributetypes: (1.2.826.0.1341.1.30 NAME ( 'hmUWCCollege' ) DBNAME ( 'hmUWCCollege' 'hmUWCCollege' ) ACCESS-CLASS normal LENGTH 400  )
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:C:\\Atelier\\Metamerge\\MIG\\v3\\schema\\ibmdefined.schema
				inheritFrom:metamerge.FileSystem
				parser:metamerge.ScriptParser1
			}
			link [
			]
			override {
			}
			parserConfig {
				attributeName:line
				inheritFrom:metamerge.ScriptParser1
				script://\n// This is a simple parser that returns one line at a time from\n// the input stream.\n//\n\nvar counter = 0;\n\nfunction writeEntry ()\n{\n\tout.write (entry.getString("line"));\n\tout.newLine();\n}\n\nfunction readEntry ()\n{\n\tvar str = inp.readLine();\n\n\t\tvar xtr = inp.readLine();\n\n\tif (xtr == null) {\n\t\tresult.setStatus (0);\n\t\tresult.setMessage ("End of input");\n\t\treturn;\n\t}\n\n\n\tcounter++;\n\n\tentry.setAttribute ("attr", str);\n\tentry.setAttribute ("ibmattr", xtr);\n\tresult.setStatus (1);\n}\n
			}
			type:Iterator
			updateAttributes {
				attr {
					add:false
					flow:ret.value = conn.getAttribute("attr");
					mod:false
				}
				ibmattr {
					add:false
					flow:ret.value = conn.getAttribute("ibmattr");
					mod:false
				}
			}
		}
		write {
			enabled:true
			script:str = "dn: cn=schema\\r\\nchangetype: modify\\r\\nadd: attributetypes\\r\\n" + work.getString("attr") + "\\r\\n-\\r\\nadd: ibmattributetypes\\r\\n" + work.getString("ibmattr") + "\\r\\n";\n\nwork.setAttribute("out", str);\n\n/*\n myAttribute-oid NAME ( myAttribute )\nDESC An attribute I defined for my LDAP application\nEQUALITY 2.5.13.2 SYNTAX 1.3.6.1.4.1.1466.115.121.1.15\nUSAGE userApplications )\n-\nadd: ibmattributetypes\nibmattributetypes: ( myAttribute-oid DBNAME ( myAttrTable myAttrColumn )\nACCESS-CLASS normal LENGTH 200 )\n\nstr = "dn: cn=Schema\\nchangetype: modify\\nadd: objectclasses\\nobjectclasses: ( <myobjectClass-oid> NAME <myObjectClass> DESC <An object class\nI defined for my LDAP application> SUP <objectclassinheritance> <objectclasstype> MAY (<attribute1> $ <attribute2>))\n*/
			type:Script
		}
		writeFile {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:output
				filePath:C:\\Documents and Settings\\CHATEAUVIEUX\\Desktop\\schema.ldif
				inheritFrom:metamerge.FileSystem
				parser:metamerge.ScriptParser1
			}
			link [
			]
			override {
			}
			parserConfig {
				attributeName:line
				inheritFrom:metamerge.ScriptParser1
			}
			type:AddOnly
			updateAttributes {
				line {
					add:true
					flow:ret.value = work.getAttribute("out");
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task repair_openLDAP]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read_shit_entries
		update_dummy
	]
	components {
		read_shit_entries {
			ALEvent {
			}
			attributeList {
				uid {
					Include:true
					Name:uid
					Sample:nc97vuzu
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				filePath:D:\\Atelier\\temp\\shittyEntries.txt
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumns:uid
				csvEnableQuoting:true
				csvLogLongLines:0
				csvWriteHeader:true
				inheritFrom:metamerge.CSV
			}
			type:Iterator
			updateAttributes {
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		update_dummy {
			ALEvent {
				before_modify {
					active:false
					flow:
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=nc99ajel,o=uwc
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGuser
					Syntax:java.lang.String
				}
				MigChallengeQuestion {
					Include:true
					Name:MigChallengeQuestion
					Sample:What is your preferred internet password?
					Syntax:java.lang.String
				}
				MigChallengeQuestionAnswer {
					Include:true
					Name:MigChallengeQuestionAnswer
					Sample:xxx
					Syntax:java.lang.String
				}
				MigLastModifiedBy {
					Include:true
					Name:MigLastModifiedBy
					Sample:ac89mpaa
					Syntax:java.lang.String
				}
				MigLastModifiedDate {
					Include:true
					Name:MigLastModifiedDate
					Sample:20020417035413PDT
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Ante Jelcic
					Syntax:java.lang.String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:nombox
					Syntax:java.lang.String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:(505) 454-4274
					Syntax:java.lang.String
				}
				generationQualifier {
					Include:true
					Name:generationQualifier
					Sample:asd
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Marie Cecilie
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:22 46 21 40
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:Vidarsgate 5
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:http://sonify.psych.gatech.edu/~walkerb
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:nc99ajel@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:ante.jelcic@uwc.net
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:pekka_sb@hotmail.com
					Syntax:java.lang.String
				}
				mailHost {
					Include:true
					Name:mailHost
					Sample:www.uwc.org
					Syntax:java.lang.String
				}
				mailMessageStore {
					Include:true
					Name:mailMessageStore
					Sample:pc87dmar
					Syntax:java.lang.String
				}
				mailReplyText {
					Include:true
					Name:mailReplyText
					Sample:This is an inactive email address. We have now changed list names. If you tried to send to a mailing list, you can maybe add '-list' to the email address you sent to (instead of -l). Regards UWCIT (uwcgd-support@www.uwc.org)
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:91788406
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:Rikshospitalet
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:P.O. Box 248
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:no
					Syntax:java.lang.String
				}
				qmailDotMode {
					Include:true
					Name:qmailDotMode
					Sample:both
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Jelcic
					Syntax:java.lang.String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:454-4225
					Syntax:java.lang.String
				}
				title {
					Include:true
					Name:title
					Sample:medical doctor
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:nc99ajel
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@7b6074
					Syntax:ByteArray
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Lars
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:Dr. Bruce Walker was born in Montreal, and grew up in many places across Canada. He represented Saskatchewan at Pearson College, where he participated in many activities including diving, swimming with the blind, and tutoring troubled youth. Bruce completed his B.Sc. in Physics and Psychology at McGill University, and went on to complete his Ph.D. in Human Factors Psychology at Rice University in Houston. He is currently a professor of Psychology and Computer Science at the Georgia Institute of Technology in Atlanta. Bruce's research focuses on how to make technology (such as computers) more person-friendly and easy to use. Bruce has travelled extensively, and enjoys active sports, photography, and community service. He serves on the UWC International Board of Directors, and is the Chair of the UWC Information Technology Task Force.
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:19721121
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:none
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:NC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Ante
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Jelcic
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:NO
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:cand.med.
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:University of Oslo
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:{T.61}Medicine!Oslo Univ.
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:1991
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:Tempelveien 43,3475 Saetre, Norway
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:Saetre
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:NO
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:Hector and Blanca Marquez
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:3475
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:Quebec
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Female
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:505
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:1
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Ms.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:ICQ:4054874
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:ultimate frisbee$jujutsu$scuba diving$photography
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:domestic partnership
					Syntax:java.lang.String
				}
				uwcMiddleName {
					Include:true
					Name:uwcMiddleName
					Sample:C.
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:Norwegian
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:UWC College
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:Lars Kristian Roland
					Syntax:java.lang.String
				}
				uwcPictureURI {
					Include:true
					Name:uwcPictureURI
					Sample:http://sonify.psych.gatech.edu/~walkerb/graphics/bruce_walker.jpg
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:0452
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Home
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:medical doctor
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:New Mexico
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:Nothing...
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Former Student
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:Bruce
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:en
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1999
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:505
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:1
					Syntax:java.lang.String
				}
				uwcWebSite {
					Include:true
					Name:uwcWebSite
					Sample:http://www.uwc.org/regions/us/tx
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Montezuma
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:US
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:Rice University: Post-doctoral researcher$IBM: Human Factors and Interface Consultant$Lockheed Martin: Human Factors Psychologist
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:87731
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:New Mexico
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:www.uwc-usa.org
					Syntax:java.lang.String
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchScope:onelevel
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task uwc.IntraStore.user.schema.create]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		input
		update
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				College {
					Include:true
					Name:College
					Sample:ac
				}
				firstname {
					Include:true
					Name:firstname
					Sample:Ingo
				}
				mail {
					Include:true
					Name:mail
					Sample:ingo.gobel@uwc.net
				}
				startyear {
					Include:true
					Name:startyear
					Sample:2001
				}
				surname {
					Include:true
					Name:surname
					Sample:Gobel
				}
				uid {
					Include:true
					Name:uid
					Sample:ac01igob
				}
			}
			connectorConfig {
				inheritFrom:ODBC
				jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
				jdbcLogin:
				jdbcSelect:
				jdbcSource:jdbc:odbc:uwcac2001staff
				jdbcTable:ac
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:true
					flow:task.logmsg ("found: " + conn.getString("mail") + " as " + conn.getString("filePathname"));
					name:After lookup
				}
				after_modify {
					active:true
					flow:\n// make sure file path exists\nvar url = new java.net.URL("http://unity.uwc.org/cgi-bin/checkdir.cpe?uid=" + work.getString("uid"));\nurl.getContent();\ntask.logmsg ("Create: " + work.getString("uid"));
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:true
					flow:task.logmsg ("WARNING No entry was found for UID: " + work.getString("uid"));\nsystem.skipEntry();
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:var cur = current.getString("preferredRfc822Recipient");\nif (cur != "rcnuwcmail@unity.uwc.org") {\n\ttask.logmsg ("****** Entry has not a default mail forward *****");\n\ttask.logmsg ("UID: " + work.getString("uid"));\n\ttask.logmsg ("Current forward: " + current.getString("preferredRfc822Recipient"));\n\ttask.logmsg ("New forward: " + conn.getString("preferredRfc822Recipient"));\n}\n
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update failed: " + error.getString("class"));\n
					name:Update fail
				}
				update_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nsystem.skipEntry();
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=nc98akal,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Aili Kalvemo
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/nc98akal
				}
				gn {
					Include:true
					Name:gn
					Sample:Aili
				}
				mail {
					Include:true
					Name:mail
					Sample:aili.kalvemo@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=iss-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:rcnuwcmail@unity.uwc.org
				}
				sn {
					Include:true
					Name:sn
					Sample:Kalvemo
				}
				uid {
					Include:true
					Name:uid
					Sample:nc98akal
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@364ee5
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:NC
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:100
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:98
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchBase:o=uwc
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				filePathname {
					add:false
					flow:ret.value = "/var/ISS/mail/uwc/" + work.getString("uid");
					mod:true
				}
				mhsMessageStoreName {
					add:false
					flow:ret.value = "CN=iss-unity.uwc.org, cn=Application Services, o=UWC";
					mod:true
				}
				preferredRfc822Recipient {
					add:false
					flow:ret.value = "";
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to enable ISS for users imported with xls2LDAP.AC2000grads assembly line
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	maxread:
	nullBehavior:Default Behavior
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task uwc.IntraStore.user.schema.create2]
	attribute_map {
	}
	automapattributes:false
	componentlist [
		input
		update
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				Forwarding e-mail {
					Include:true
					Name:Forwarding e-mail
					Sample:
					Syntax:VARCHAR:255
				}
				Last Name {
					Include:true
					Name:Last Name
					Sample:
					Syntax:VARCHAR:255
				}
				Preferred Name {
					Include:true
					Name:Preferred Name
					Sample:
					Syntax:VARCHAR:255
				}
				UWC E-mail {
					Include:true
					Name:UWC E-mail
					Sample:
					Syntax:VARCHAR:255
				}
				UWC ID {
					Include:true
					Name:UWC ID
					Sample:
					Syntax:VARCHAR:255
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
				jdbcLogin:
				jdbcSelect:
				jdbcSource:jdbc:odbc:toOslo
				jdbcTable:toOslo
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				uid {
					add:false
					flow:ret.value = conn.getAttribute("UWC ID");
					mod:false
				}
			}
		}
		update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:true
					flow:task.logmsg ("found: " + conn.getString("mail") + " as " + conn.getString("filePathname"));
					name:After lookup
				}
				after_modify {
					active:true
					flow:\n// make sure file path exists\nvar url = new java.net.URL("http://unity.uwc.org/cgi-bin/checkdir.cpe?uid=" + work.getString("uid"));\nurl.getContent();\ntask.logmsg ("Create: " + work.getString("uid"));
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:\n
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update failed: " + error.getString("class"));\n
					name:Update fail
				}
				update_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nsystem.skipEntry();
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=nc98akal,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Aili Kalvemo
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/nc98akal
				}
				gn {
					Include:true
					Name:gn
					Sample:Aili
				}
				mail {
					Include:true
					Name:mail
					Sample:aili.kalvemo@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=iss-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:rcnuwcmail@unity.uwc.org
				}
				sn {
					Include:true
					Name:sn
					Sample:Kalvemo
				}
				uid {
					Include:true
					Name:uid
					Sample:nc98akal
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@364ee5
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:NC
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:100
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:98
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchBase:o=uwc
			}
			link [
				uid:=|$uid
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				filePathname {
					add:true
					flow:ret.value = "/var/ISS/mail/uwc/" + work.getString("uid");
					mod:true
				}
				mhsMessageStoreName {
					add:true
					flow:ret.value = "CN=iss-unity.uwc.org, cn=Application Services, o=UWC";
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to enable ISS for users imported with xls2LDAP.NC1999grads assembly line
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	maxread:
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task uwc.MIG2.user.lookup]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		unity.record.detect
		Auth
		MIG.record.detect
		reply
	]
	components {
		Auth {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("$dn") );\ncheckHeadmaster(work);
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapReferrals:follow
				ldapSearchBase:ou=headmasters, o=uwc
				ldapSizeLimit:0
				ldapTimeLimit:0
				ldapUseSSL:false
			}
			link [
				(attr):=|$value
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Passive
			updateAttributes {
			}
		}
		MIG.record.detect {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:if (ldapError != "OK")\n\tsystem.ignoreEntry();
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("http.qs.dn") );
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapUseSSL:false
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
			}
		}
		input {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		inputain {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.logmsg ("Submitted DATA");\ntask.dumpEntry (conn);\n\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:false
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:false
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:false
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:false
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:false
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:false
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:false
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:false
					Name:i
					Sample:
				}
				inputStream {
					Include:false
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:false
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:false
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				connectorType:@input
			}
			inheritAM:
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			enabled:true
			script:work.setAttribute ("inputStream", null);\nwork.setAttribute ("outputStream", null);\nwork.setAttribute ("userPassword", null);\n\nwork.setAttribute ("exitStatus", ldapError);\n\ntask.logmsg ("Output Work");\ntask.dumpEntry (work);\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
		unity.record.detect {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:true
					flow:if (conn.getAttribute("initials") != null)\n{\n\ttask.logmsg ("Verifying middlename");\n\tif (conn.getString("initials").compareToIgnoreCase(work.getString("http.qs.initials")) != 0)\n\t{\n\t\tldapError = "Metamerge Integrator unable to find an entry based on your submitted data(2)";\t\t\n\t\tsystem.ignoreEntry();\n\t}\n}
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:task.logmsg  ("Unable to find entry");\n\nldapError = "Metamerge Integrator unable to find an entry based on your submitted data(1)";\n\nwork.removeAllAttributes();\n
					name:Lookup fail
				}
				lookup_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nldapError = "Not found";\nwork.setAttribute ("status", "entry not found");\n
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:task.logmsg ("Now check headmaster");\n\nif (!checkHeadmaster()) \n{\n\tldapError = "Metamerge Integrator unable to find an entry based on your submitted data(3)";\n}\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapAuthenticationMethod:Simple
			}
			link [
				uwcCollegeFirstName:=|$http.qs.givenName
				uwcCollegeSurname:=|$http.qs.sn
				uwccollege:=|$http.qs.uwccollege
				uwcstartyear:=|$http.qs.uwcstartyear
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
			}
		}
		unityRead {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:if (work.getString("oper") != "read") {\n\ttask.logmsg ("Not a read operation");\n\tsystem.ignoreEntry();\n}
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Unable to find entry");\nldapError = "AS unable to find entry based on your submitted data(3)";\n
					name:Lookup fail
				}
				lookup_multiple {
					active:true
					flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "Not found";\nwork.setAttribute ("status", "entry not found");\n
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:task.logmsg ("Entry READ on UNITY");\n\n//task.logmsg ("additional mappings");\n\nif (work.getAttribute("uwccollegesurname") == null)\n\twork.setAttribute("uwccollegesurname",work.getString("sn"));\n\nif (work.getAttribute("uwccollegefirstname") == null)\n\twork.setAttribute("uwccollegefirstname",work.getString("gn"));\n\n//work.setAttribute("uwcrole",work.getString("title"));\n//work.setAttribute("title","");\n\n//if (work.getAttribute("uwcmiddlename") == null)\n//{\n//\twork.setAttribute("uwcmiddlename",work.getString("initials"));\n//}\n\n//if (work.getAttribute("mail") == null)\n//\twork.setAttribute("mail", work.getString("gn") + "." + work.getString("sn") + "@uwc.net");\n\n//for (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n//{\n//\tif (work.getAttribute("homepostaladdress") == null)\n//\t{\n//\t\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Home"))\n//\t\t\twork.setAttribute("homepostaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n\n//\tif (work.getAttribute("postaladdress") == null)\n//\t{\n//\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Work")) \n//\t\twork.setAttribute("postaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n//}\n//task.logmsg ("Mappings done");\n\n\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapSearchFilter:objectclass=uwcperson
			}
			link [
				$dn:=|$dn
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to register new detect user in MIG
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:\nvar ldapError = "OK";\n\nfunction checkHeadmaster ()\n{\n\tif (work.getString("http.qs.uwccollege").toLowerCase() == "xx")\n\t{\n\t\ttask.logmsg ("External users dont have headmasters");\n\t\treturn true;\n\t}\n\n\ttask.logmsg ("Check headmaster with uwcCollege=" + work.getString("http.qs.uwcCollege"));\n\n\tAuth.connector.setParam ("ldapSearchFilter", "(&(headmaster=" + work.getString("http.qs.uwcheadmaster") + ")(hmuwccollege=" + work.getString("http.qs.uwccollege") + "))" );\n\n\tAuth.connector.selectEntries ();\n\n\tchk = work.getString("http.qs.uwcstartyear");\n\n\ttask.logmsg ("Check against: " + chk);\n\n\twhile ( (e = Auth.connector.getNextEntry()) ) {\n\t\ttask.dumpEntry (e);\n\t\ta = e.getString("hmstartyear");\n\t\tb = e.getString("hmendyear");\n\t\tif (a.compareTo(chk) <= 0 && b.compareTo(chk) >= 0) {\n\t\t\ttask.logmsg ("Match found");\n\t\t\treturn true;\n\t\t}\n\t}\n\n\ttask.logmsg ("No match found");\n\twork.removeAllAttributes();\n\treturn false;\n}\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.mail.modify]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		freedom.lookup
		freedom.update
		freedom_mailAlternateAddresscheck
		freedom_mailcheck
		reply
	]
	components {
		freedom.lookup {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:task.logmsg ("Entry not found");\nldapError = "Unable to find entry";\nwork.setAttribute("ErrorOccured", "yes");\nwork.setAttribute ("$dn", "bullshit");
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			allow_duplicates:false
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$http.qs.dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		freedom.update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:true
					flow:task.logmsg ("Attempting to ADD on unity");\ntask.dumpEntry (conn);\n
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes on freedom");\ntask.dumpEntry (conn);\n\nalias = conn.getAttribute("mailAlternateAddress");\n\nif (alias != null)\n{\n\tempty = true;\n\tfor (i = 0; i < alias.size(); i++)\n\t\tif (!alias.getValue(i).toString().trim().equals("")) \n\t\t{\n\t\t\tempty = false;\n\t\t\tbreak;\n\t\t}\n\t\n\tif (!empty && !checkUniqueEmail(work.getString("uid"), alias))\n\t{\n\t\tldapErrorFreedom = "At least one of the specified email alias is already in use.";\n\t\tsystem.ignoreEntry();\n\t}\n}
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:true
					flow:if (work.getString("ErrorOccured") == "yes") {\n\ttask.logmsg ("Unregistered user attack! I quit");\n\tsystem.ignoreEntry();\n}\ntask.logmsg ("Before Update on freedom");\ntask.dumpEntry (work);\n
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:true
					flow:task.logmsg("Apply Attributes on freedom");\ntask.dumpEntry (conn);
					name:Before Applying Changes
				}
				modify_nochange {
					active:true
					flow:task.logmsg ("No changes on freedom");
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapErrorFreedom = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapErrorFreedom);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));\nwork.setAttribute("ErrorOccured", "yes");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:// ISS update\n// make sure file path exists\n//var url = new java.net.URL("http://unity.uwc.org/cgi-bin/checkdir.cpe?uid=" + work.getString("http.qs.uid"));\n//url.getContent();\n//task.logmsg ("Create: " + work.getString("http.qs.uid"));\n\nldapErrorFreedom = "OK";\ntask.logmsg ("Entry updated OK on freedom");\n
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				connectorType:@freedom.lookup
				inheritFrom:@freedom.lookup
			}
			inheritAM:
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				deliveryMode {
					add:false
					flow:if (work.getAttribute("http.qs.deliveryMode") != null)\n{\n\tif (work.getString("http.qs.deliveryMode").equalsIgnoreCase("forward"))\n\t\tret.value = "nombox";\n\tif (work.getString("http.qs.deliveryMode").equalsIgnoreCase("local"))\n\t\tret.value = "localdelivery";\n\tif (work.getString("http.qs.deliveryMode").equalsIgnoreCase("both"))\n\t\tret.value = "localdelivery";\n}\nelse ret.value = null;
					mod:true
					nullBehavior:Default Behavior
					nullBehaviorValue:nombox
				}
				mail {
					add:false
					flow:ret.value = work.getAttribute("http.qs.mail");
					mod:true
				}
				mailAlternateAddress {
					add:false
					flow:attr = work.getAttribute("http.qs.mailAlternateAddress");\n\nif (attr != null)\n{\n\tnewattr = system.newAttribute("mail");\n\n\tfor (i = 0; i < attr.size(); i++)\n\t\tif (!attr.getValue(i).toString().trim().equals(""))\n\t\t{\n\t\t\tif (attr.getValue(i).toString().toLowerCase().trim().endsWith("@uwcac.uwc.org"))\n\t\t\t\tnewattr.addValue(attr.getValue(i).toString().trim());\n\t\t\telse\n\t\t\t\tnewattr.addValue(attr.getValue(i).toString().trim() + "@uwc.net");\n\t\t}\n\tret.value = newattr;\t\n}\nelse ret.value = null;\n
					mod:true
				}
				mailForwardingAddress {
					add:false
					flow:if (work.getAttribute("http.qs.deliveryMode") != null)\n{\n\tif (work.getString("http.qs.deliveryMode").equalsIgnoreCase("local"))\n\t\tret.value = null;\n\telse ret.value = work.getAttribute("http.qs.mailForwardingAddress");\n}\nelse ret.value = null;
					mod:true
				}
				mailMessageStore {
					add:false
					flow:if (work.getAttribute("http.qs.deliveryMode") != null)\n\tif (!work.getString("http.qs.deliveryMode").equalsIgnoreCase("forward"))\n\t\tret.value = work.getString("uid").toLowerCase();\n\telse ret.value = null;\nelse ret.value = null;
					mod:true
				}
				migLastModifiedBy {
					add:false
					flow:ret.value = work.getAttribute("http.qs.migLastModifiedBy");
					mod:true
				}
				migLastModifiedDate {
					add:false
					flow:ret.value = work.getAttribute("http.qs.migLastModifiedDate");
					mod:true
				}
			}
		}
		freedom_mailAlternateAddresscheck {
			ALEvent {
				lookup_fail {
					active:true
					flow:// That's fine, we should end up here anyway
				}
			}
			allow_duplicates:true
			compute_changes:true
			connectorConfig {
				connectorType:@freedom.lookup
				inheritFrom:@freedom.lookup
			}
			link [
				mailAlternateAddress:=|@mailAlternateAddress
				uid:!|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			type:Passive
			updateAttributes {
			}
		}
		freedom_mailcheck {
			ALEvent {
				lookup_fail {
					active:true
					flow:// That's fine, we should end up here anyway
				}
			}
			allow_duplicates:true
			connectorConfig {
				connectorType:@freedom.lookup
				inheritFrom:@freedom.lookup
			}
			link [
				mail:=|@mail
				uid:!|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			type:Passive
			updateAttributes {
			}
		}
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.dumpEntry (conn);\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:true
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:true
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:true
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:true
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				inputStream {
					Include:true
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:true
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:true
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			attributeList {
			}
			enabled:true
			parserConfig {
			}
			script:if (ldapErrorFreedom == "OK")\n\twork.setAttribute ("exitStatus", "OK");\nelse\n\twork.setAttribute ("exitStatus", "While updating Freedom: " + ldapErrorFreedom);\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
	}
	debug:false
	description:Used to edit user's data in UWC's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	nullBehavior:Null
	prolog:var ldapErrorFreedom = "OK";\n\nfunction checkPublic (work, attr)\n{\n   // Is the attribute set to be public ?\n\tvar pub = work.getString("http.qs.p_" + attr);\n\tif (pub != null)\n\t{\n\t\t attr = "http.qs." + attr;\n\t\tif (pub == "on")\n\t\t{\n\t\t\tvar attribute = work.getAttribute(attr);\n\t\t\tif (attribute != null)\n\t\t\t{\n\t\t\t\tvar size = attribute.size();\t\t\t\t\n\t\t\t\tif (size == 1)\n\t\t\t\t{\n\t\t\t\t\tvar value = attribute.getValue();\n\t\t\t\t\tif (value != "") return value;\n\t\t\t\t\telse return null;\n\t\t\t\t}\n\t\t\t\telse return attribute;\n\t\t\t}\n\t\t\telse return null;\n\t\t}\n\t\telse return null;\n\t}\n\telse return null;\n}\n\nfunction checkUniqueEmail (uid, email)\n{\n\tmatchEntry = system.newEntry();\n\tmatchEntry.setAttribute("uid", uid);\n\tmatchEntry.setAttribute("mailAlternateAddress", email);\n\n\t// because of NASTY BUG can't write \tmatchEntry.setAttribute("mail", email);\n\t// instead write\n\tfor (i = 0; i < email.size(); i++)\n\t\tmatchEntry.addAttributeValue("mail", email.getValue(i).toString());\n\n\tif (freedom_mailAlternateAddresscheck.lookup(matchEntry) != null) \n\t{\n\t\ttask.logmsg ("Match found");\n\t\treturn false;\n\t}\n\telse if (freedom_mailcheck.lookup(matchEntry) != null) \n\t{\n\t\ttask.logmsg ("Match found");\n\t\treturn false;\n\t}\n\telse return true;\n}\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.mail.read]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		freedomRead
		reply
	]
	components {
		freedomLookup {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:if (work.getString("oper") != "lookup") {\n\ttask.logmsg ("Not a lookup operation");\n\tsystem.ignoreEntry();\n}
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("$dn") );\n
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$dn
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
			}
		}
		freedomRead {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Unable to find entry");\nldapError = "MetaMerge Integrator is unable to find your entry";\nwork.removeAllAttributes();
					name:Lookup fail
				}
				lookup_multiple {
					active:true
					flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "MetaMerge Integrator is unable to find your entry";\n
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:task.logmsg ("Entry READ on UNITY");\n\n//task.logmsg ("additional mappings");\n\nif (work.getAttribute("uwccollegesurname") == null)\n\twork.setAttribute("uwccollegesurname",work.getString("sn"));\n\nif (work.getAttribute("uwccollegefirstname") == null)\n\twork.setAttribute("uwccollegefirstname",work.getString("gn"));\n\n// OPENLDAP considers gn as givenName, CDC does not\n//if (work.getAttribute("givenName") == null)\n//\twork.setAttribute("givenName",work.getString("gn"));\n\n// OPENLDAP considers generationQualifier as is, CDC as gq\n//if (work.getAttribute("generationQualifier") == null)\n//\twork.setAttribute("generationQualifier",work.getString("gq"));\n\n//work.setAttribute("uwcrole",work.getString("title"));\n//work.setAttribute("title","");\n\n//if (work.getAttribute("uwcmiddlename") == null)\n//{\n//\twork.setAttribute("uwcmiddlename",work.getString("initials"));\n//}\n\n//if (work.getAttribute("mail") == null)\n//\twork.setAttribute("mail", work.getString("gn") + "." + work.getString("sn") + "@uwc.net");\n\n//for (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n//{\n//\tif (work.getAttribute("homepostaladdress") == null)\n//\t{\n//\t\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Home"))\n//\t\t\twork.setAttribute("homepostaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n\n//\tif (work.getAttribute("postaladdress") == null)\n//\t{\n//\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Work")) \n//\t\twork.setAttribute("postaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n//}\n//task.logmsg ("Mappings done");\n\n\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$http.qs.dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		hm {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("$dn") );\ncheckHeadmaster(work);
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchBase:ou=headmasters, o=uwc
			}
			link [
				(attr):=|$value
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Passive
			updateAttributes {
			}
		}
		input {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:true
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				dn {
					add:false
					flow:ret.value = conn.getAttribute("dn");
					mod:false
				}
			}
		}
		inputain {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.logmsg ("Submitted DATA");\ntask.dumpEntry (conn);\n\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:false
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:false
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:false
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:false
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:false
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:false
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:false
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:false
					Name:i
					Sample:
				}
				inputStream {
					Include:false
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:false
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:false
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				connectorType:@input
			}
			inheritAM:
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			enabled:true
			script:work.setAttribute ("inputStream", null);\nwork.setAttribute ("outputStream", null);\nwork.setAttribute ("userPassword", null);\n\nif (work.getAttribute("deliveryMode") != null)\n{\n\tif (work.getAttribute("deliveryMode").hasValueIC("nombox"))\n\t\twork.setAttribute("read_mode", "forward");\n\tif (work.getAttribute("deliveryMode").hasValueIC("localdelivery"))\n\t\twork.setAttribute("read_mode", "local");\n}\n\nwork.setAttribute ("exitStatus", ldapError);\n\ntask.logmsg ("Output Work");\ntask.dumpEntry (work);\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
		test {
			enabled:true
			script:main.logmsg("test: " + work.getString("http.qs.dn"));
			type:Script
		}
		unity {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:var initials = work.getString("initials");\nif (work.getString("oper") != "lookup") {\n\ttask.logmsg ("Not a lookup operation");\n\tsystem.ignoreEntry();\n}
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Unable to find entry");\nldapError = "AS unable to find entry based on your submitted data(1)";\n
					name:Lookup fail
				}
				lookup_multiple {
					active:true
					flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "Not found";\nwork.setAttribute ("status", "entry not found");\n
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:task.logmsg ("Entry found on UNITY");\nif (conn.getAttribute("initials") != null)\n{\n\ttask.logmsg ("Verifying middlename");\n\tif (conn.getString("initials").compareTo(initials) != 0)\n\t\tldapError = "AS unable to find entry based on your submitted data(1)";\n}\ntask.logmsg ("Now check headmaster");\nif (!checkHeadmaster()) {\n\tldapError = "AS unable to find entry based on your submitted data(2)";\n}\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
				gn:=|$gn
				sn:=|$sn
				uwccollege:=|$uwccollege
				uwcstartyear:=|$uwcstartyear
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to register new users in MIG
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:\nvar ldapError = "OK";\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.password.modify]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		unity.lookup
		unity.update
		freedom.lookup
		freedom.update
		reply
	]
	components {
		freedom.lookup {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=xx00ccha,o=uwc
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGadmin
					Syntax:java.lang.String
				}
				MigLastModifiedBy {
					Include:true
					Name:MigLastModifiedBy
					Sample:xx00ccha
					Syntax:java.lang.String
				}
				MigLastModifiedDate {
					Include:true
					Name:MigLastModifiedDate
					Sample:20020619082131PDT
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Christian Chateauvieux
					Syntax:MUST/String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:nombox
					Syntax:java.lang.String
				}
				description {
					Include:true
					Name:description
					Sample:
					Syntax:MAY/String
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:zxczcxzc
					Syntax:java.lang.String
				}
				generationQualifier {
					Include:true
					Name:generationQualifier
					Sample:asd sdfs' sdf>z
					Syntax:java.lang.String
				}
				givenName {
					Include:true
					Name:givenName
					Sample:Christian
					Syntax:java.lang.String
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:61279492 + (9)
					Syntax:java.lang.String
				}
				homePostalAddress {
					Include:true
					Name:homePostalAddress
					Sample:dfg
					Syntax:java.lang.String
				}
				labeledURI {
					Include:true
					Name:labeledURI
					Sample:http://www.etud.insa-tlse.fr/~chateau/
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:xx00ccha@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:christian.chateauvieux@uwc.net
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:christian@metamerge.com
					Syntax:java.lang.String
				}
				mobile {
					Include:true
					Name:mobile
					Sample:+47 41 27 44 35
					Syntax:java.lang.String
				}
				o {
					Include:true
					Name:o
					Sample:MetaMerge AS
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				pager {
					Include:true
					Name:pager
					Sample:zxczxc
					Syntax:java.lang.String
				}
				postalAddress {
					Include:true
					Name:postalAddress
					Sample:Akersgaten 43
					Syntax:java.lang.String
				}
				preferredLanguage {
					Include:true
					Name:preferredLanguage
					Sample:fr
					Syntax:java.lang.String
				}
				seeAlso {
					Include:true
					Name:seeAlso
					Sample:
					Syntax:MAY/String
				}
				sn {
					Include:true
					Name:sn
					Sample:Chateauvieux
					Syntax:MUST/String
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:12
					Syntax:MAY/String
				}
				title {
					Include:true
					Name:title
					Sample:Consultant
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:xx00ccha
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@bc3c9
					Syntax:MAY/String
				}
				uwcAffiliations {
					Include:true
					Name:uwcAffiliations
					Sample:Amnesty International
					Syntax:java.lang.String
				}
				uwcAlsoKnownAs {
					Include:true
					Name:uwcAlsoKnownAs
					Sample:Krist
					Syntax:java.lang.String
				}
				uwcBiography {
					Include:true
					Name:uwcBiography
					Sample:xcxcv
					Syntax:java.lang.String
				}
				uwcBirthDate {
					Include:true
					Name:uwcBirthDate
					Sample:19790901
					Syntax:java.lang.String
				}
				uwcChildren {
					Include:true
					Name:uwcChildren
					Sample:dasd
					Syntax:java.lang.String
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Castanet
					Syntax:java.lang.String
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:XX
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Christian
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Chateauvieux
					Syntax:java.lang.String
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:FR
					Syntax:java.lang.String
				}
				uwcDegree {
					Include:true
					Name:uwcDegree
					Sample:Engineer
					Syntax:java.lang.String
				}
				uwcEducatedAt {
					Include:true
					Name:uwcEducatedAt
					Sample:INSA Toulouse
					Syntax:java.lang.String
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Engineer
					Syntax:java.lang.String
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:2048
					Syntax:java.lang.String
				}
				uwcFallbackContactAddress {
					Include:true
					Name:uwcFallbackContactAddress
					Sample:ff
					Syntax:java.lang.String
				}
				uwcFallbackContactCity {
					Include:true
					Name:uwcFallbackContactCity
					Sample:sdfsdf
					Syntax:java.lang.String
				}
				uwcFallbackContactCountry {
					Include:true
					Name:uwcFallbackContactCountry
					Sample:FR
					Syntax:java.lang.String
				}
				uwcFallbackContactName {
					Include:true
					Name:uwcFallbackContactName
					Sample:gg
					Syntax:java.lang.String
				}
				uwcFallbackContactPostalCode {
					Include:true
					Name:uwcFallbackContactPostalCode
					Sample:asdasd
					Syntax:java.lang.String
				}
				uwcFallbackContactProvince {
					Include:true
					Name:uwcFallbackContactProvince
					Sample:fdsf
					Syntax:java.lang.String
				}
				uwcGender {
					Include:true
					Name:uwcGender
					Sample:Male
					Syntax:java.lang.String
				}
				uwcHomePhoneAreaCode {
					Include:true
					Name:uwcHomePhoneAreaCode
					Sample:5
					Syntax:java.lang.String
				}
				uwcHomePhoneInternationalCode {
					Include:true
					Name:uwcHomePhoneInternationalCode
					Sample:33
					Syntax:java.lang.String
				}
				uwcHonorific {
					Include:true
					Name:uwcHonorific
					Sample:Mr.
					Syntax:java.lang.String
				}
				uwcICQNumber {
					Include:true
					Name:uwcICQNumber
					Sample:zxczxc
					Syntax:java.lang.String
				}
				uwcInterest {
					Include:true
					Name:uwcInterest
					Sample:Music, Cinema
					Syntax:java.lang.String
				}
				uwcMaritalStatus {
					Include:true
					Name:uwcMaritalStatus
					Sample:single
					Syntax:java.lang.String
				}
				uwcNationality {
					Include:true
					Name:uwcNationality
					Sample:French
					Syntax:java.lang.String
				}
				uwcNotes {
					Include:true
					Name:uwcNotes
					Sample:qwe
					Syntax:java.lang.String
				}
				uwcOrganisation {
					Include:true
					Name:uwcOrganisation
					Sample:Other/Friend of UWC
					Syntax:java.lang.String
				}
				uwcPartnerName {
					Include:true
					Name:uwcPartnerName
					Sample:zxcxzc
					Syntax:java.lang.String
				}
				uwcPictureURI {
					Include:true
					Name:uwcPictureURI
					Sample:fff
					Syntax:java.lang.String
				}
				uwcPostalCode {
					Include:true
					Name:uwcPostalCode
					Sample:31320
					Syntax:java.lang.String
				}
				uwcPreferredAddress {
					Include:true
					Name:uwcPreferredAddress
					Sample:Work
					Syntax:java.lang.String
				}
				uwcProfessions {
					Include:true
					Name:uwcProfessions
					Sample:Consultant
					Syntax:java.lang.String
				}
				uwcProvince {
					Include:true
					Name:uwcProvince
					Sample:sda
					Syntax:java.lang.String
				}
				uwcPublication {
					Include:true
					Name:uwcPublication
					Sample:asd
					Syntax:java.lang.String
				}
				uwcRoles {
					Include:true
					Name:uwcRoles
					Sample:Current UWC staff
					Syntax:java.lang.String
				}
				uwcSalutation {
					Include:true
					Name:uwcSalutation
					Sample:møn
					Syntax:java.lang.String
				}
				uwcSpokenLanguages {
					Include:true
					Name:uwcSpokenLanguages
					Sample:ab
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:2000
					Syntax:java.lang.String
				}
				uwcTelephoneNumberAreaCode {
					Include:true
					Name:uwcTelephoneNumberAreaCode
					Sample:6
					Syntax:java.lang.String
				}
				uwcTelephoneNumberInternationalCode {
					Include:true
					Name:uwcTelephoneNumberInternationalCode
					Sample:33
					Syntax:java.lang.String
				}
				uwcWorkCity {
					Include:true
					Name:uwcWorkCity
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkCountry {
					Include:true
					Name:uwcWorkCountry
					Sample:NO
					Syntax:java.lang.String
				}
				uwcWorkHistory {
					Include:true
					Name:uwcWorkHistory
					Sample:sdf
					Syntax:java.lang.String
				}
				uwcWorkPostalCode {
					Include:true
					Name:uwcWorkPostalCode
					Sample:N-1356
					Syntax:java.lang.String
				}
				uwcWorkProvince {
					Include:true
					Name:uwcWorkProvince
					Sample:Oslo
					Syntax:java.lang.String
				}
				uwcWorkURI {
					Include:true
					Name:uwcWorkURI
					Sample:http://www.metamerge.com
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				givenName {
					add:false
					flow:ret.value = conn.getAttribute("givenName");
					mod:false
					nullBehavior:Empty String
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
					nullBehavior:Empty String
				}
				migChallengeQuestion {
					add:false
					flow:ret.value = conn.getAttribute("migChallengeQuestion");
					mod:false
				}
				migChallengeQuestionAnswer {
					add:false
					flow:ret.value = conn.getAttribute("migChallengeQuestionAnswer");
					mod:false
				}
				sn {
					add:false
					flow:ret.value = conn.getAttribute("sn");
					mod:false
					nullBehavior:Empty String
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
					nullBehavior:Default Behavior
				}
				uwcPictureURI {
					add:false
					flow:ret.value = conn.getAttribute("uwcPictureURI");
					mod:false
					nullBehavior:Empty String
				}
			}
		}
		freedom.update {
			ALEvent {
				before_update {
					active:true
					flow:if (work.getString("ErrorOccured") == "yes") {\n\ttask.logmsg ("Unregistered user attack! I quit");\n\tsystem.ignoreEntry();\n}\ntask.logmsg ("Before Update on freedom");\ntask.dumpEntry (work);\n
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update Error");
				}
				update_ok {
					active:true
					flow:var strUrl = "http://www.uwc.org/WebX/updateTeamX.html?operation=moduser&userpassword=&uid=" + work.getString("uid");\nstrUrl += "&givenname=" + work.getString("givenName") + "&sn=" + work.getString("sn") + "&mail=" + work.getString("mail");\nstrUrl += "&pictureURL=" + work.getString("uwcpictureuri");\ntask.logmsg("URL:" +  strUrl);\nvar url = new java.net.URL(strUrl);\ntask.logmsg(url.getContent());\ntask.logmsg ("Create: " + work.getString("uid"));\n\nldapErrorFreedom = "OK";\ntask.logmsg ("Entry updated OK on freedom");\n
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			type:Update
			updateAttributes {
				migChallengeQuestion {
					add:false
					flow:if (work.getAttribute("http.qs.challenge_question") != null)\n\tret.value = work.getAttribute("http.qs.challenge_question");\nelse ret.value = work.getAttribute("migchallengequestion");
					mod:true
				}
				migChallengeQuestionAnswer {
					add:false
					flow:if (work.getAttribute("http.qs.challenge_answer") != null)\n\tret.value = work.getAttribute("http.qs.challenge_answer");\nelse ret.value = work.getAttribute("migchallengequestionanswer");
					mod:true
				}
				userPassword {
					add:false
					flow:if (work.getString("http.qs.rehash") == "no")\n\tret.value = work.getString("http.qs.hashed_password");\nelse ret.value = work.getString("http.qs.password");
					mod:true
				}
			}
		}
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.dumpEntry (conn);\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:true
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:true
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:true
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:true
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				inputStream {
					Include:true
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:true
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:true
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			attributeList {
			}
			enabled:true
			parserConfig {
			}
			script:if (ldapErrorFreedom == "OK")\n\twork.setAttribute ("exitStatus", "OK");\nelse\n\twork.setAttribute ("exitStatus", "While updating Freedom: " + ldapErrorFreedom);\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
		unity.lookup {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:task.logmsg ("Entry not found");\nldapError = "Unable to find entry";\nwork.setAttribute("ErrorOccured", "yes");\nwork.setAttribute ("$dn", "bullshit");
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			allow_duplicates:false
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
				$dn:=|$http.qs.dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		unity.update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:true
					flow:task.logmsg ("Attempting to ADD on unity");\ntask.dumpEntry (conn);\n
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes on freedom");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:true
					flow:if (work.getString("ErrorOccured") == "yes") {\n\ttask.logmsg ("Unregistered user attack! I quit");\n\tsystem.ignoreEntry();\n}\ntask.logmsg ("Before Update on Unity");\ntask.dumpEntry (work);\n
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:true
					flow:task.logmsg("Apply Attributes on freedom");\ntask.dumpEntry (conn);
					name:Before Applying Changes
				}
				modify_nochange {
					active:true
					flow:task.logmsg ("No changes on freedom");
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapErrorFreedom = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapErrorFreedom);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));\nwork.setAttribute("ErrorOccured", "yes");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapErrorFreedom = "OK";\ntask.logmsg ("Entry updated OK on untiy");\n
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				connectorType:@unity.lookup
				inheritFrom:@unity.lookup
			}
			inheritAM:
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				userPassword {
					add:false
					flow:if (work.getString("http.qs.rehash") == "no")\n\tret.value = work.getString("http.qs.hashed_password");\nelse ret.value = work.getString("http.qs.password");
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to edit user's data in UWC's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	nullBehavior:Null
	prolog:var ldapErrorFreedom = "OK";
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.record.add]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		reply
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.dumpEntry (conn);\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:true
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:true
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:true
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:true
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				inputStream {
					Include:true
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:true
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:true
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			attributeList {
			}
			enabled:true
			parserConfig {
			}
			script:work.setAttribute ("exitStatus", "Operation not allowed on freedom.uwc.org");\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
	}
	debug:false
	description:Used to edit user's data in UWC's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	nullBehavior:Null
	prolog:\n\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.record.modify]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		unity.lookup
		unity.update
		freedom.lookup
		freedom.update
		reply
	]
	components {
		freedom.lookup {
			ALEvent {
				before_lookup {
					active:true
					flow:if (work.getString("ErrorOccured") == "yes") {\n\ttask.logmsg ("Unity had a problem with the update");\n\tsystem.ignoreEntry();\n}\ntask.logmsg ("Before lookup");\ntask.dumpEntry (work);
				}
				lookup_fail {
					active:true
					flow:task.logmsg ("Entry not found");
				}
			}
			allow_duplicates:false
			attributeList {
			}
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				objectclass {
					add:false
					flow:ret.value = conn.getAttribute("objectclass");
					mod:false
				}
			}
		}
		freedom.update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:true
					flow:task.logmsg ("Attempting to ADD");\ntask.dumpEntry (conn);\n
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:true
					flow:task.logmsg ("Before Update");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:true
					flow:task.logmsg("Apply Attributes");\ntask.dumpEntry (conn);
					name:Before Applying Changes
				}
				modify_nochange {
					active:true
					flow:task.logmsg ("No changes");
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapErrorFreedom = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapErrorFreedom);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:// TeamX update\n// make sure file path exists\nvar strUrl = "http://www.uwc.org/WebX/updateTeamX.html?operation=moduser&userpassword=&uid=" + work.getString("http.qs.uid");\nstrUrl += "&givenname=" + work.getString("http.qs.givenName") + "&sn=" + work.getString("http.qs.sn") + "&mail=" + work.getString("mail");\nstrUrl += "&pictureURL=" + work.getString("http.qs.uwcpictureuri");\nvar url = new java.net.URL(strUrl);\nurl.getContent();\ntask.logmsg ("Create: " + work.getString("http.qs.uid"));\n\nldapErrorFreedom = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=xx98bsta,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn Stadheim
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:+47 2274 5705
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				mail {
					Include:true
					Name:mail
					Sample:bjorn@architech.no
				}
				objectclass {
					Include:true
					Name:objectclass
					Sample:uwcperson
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Consultant
				}
				uid {
					Include:true
					Name:uid
					Sample:xx98bsta
				}
				userpassword {
					Include:true
					Name:userpassword
					Sample:[B@1ce4a3
				}
				uwccollege {
					Include:true
					Name:uwccollege
					Sample:xx
				}
				uwcdateofbirth {
					Include:true
					Name:uwcdateofbirth
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
			}
			compute_changes:true
			connectorConfig {
				connectorType:@freedom.lookup
				inheritFrom:@freedom.lookup
			}
			inheritAM:GDFullSetOfAttributes
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = work.getAttribute("$dn");
					mod:false
				}
				MIGcategory {
					add:true
					flow:ret.value = "MIGuser";
					mod:false
				}
				cn {
					add:true
					flow:ret.value = work.getAttribute("http.qs.cn");
					mod:true
				}
				facsimileTelephonenumber {
					add:true
					flow:ret.value = checkPublic(work, "facsimiletelephonenumber");
					mod:true
				}
				generationQualifier {
					add:true
					flow:ret.value = checkPublic(work, "generationQualifier");
					mod:true
				}
				homePhone {
					add:true
					flow:if (work.getString("http.qs.p_uwchomephoneset") != null) \n\tret.value = work.getString("http.qs.homephone");\nelse ret.value = null;\n\n
					mod:true
				}
				labeledURI {
					add:true
					flow:ret.value = checkPublic(work, "labeledURI");
					mod:true
				}
				lastModifiedDate {
					add:true
					flow:ret.value = work.getAttribute("http.qs.lastModifiedDate");
					mod:true
				}
				lastModifiedUID {
					add:true
					flow:ret.value = work.getAttribute("http.qs.lastModifiedUID");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getString("http.qs.uid") + "@uwc.net";
					mod:true
				}
				mobile {
					add:true
					flow:ret.value = checkPublic(work, "mobile");
					mod:true
				}
				o {
					add:true
					flow:ret.value = checkPublic(work, "o");
					mod:true
				}
				objectclass {
					add:true
					flow:// customized\n\ntmp = system.newAttribute("objectclass");\ntmp.addValue("inetOrgPerson");\ntmp.addValue("person");\ntmp.addValue("top");\ntmp.addValue("uwcPerson");\ntmp.addValue("organizationalPerson");\ntmp.addValue("MIGitem");\ntmp.addValue("qmailUser");\n\nret.value = tmp;\n\n
					mod:false
				}
				pager {
					add:true
					flow:ret.value = checkPublic(work, "pager");
					mod:true
				}
				postalAddress {
					add:true
					flow:ret.value = checkPublic(work, "postalAddress");
					mod:true
				}
				preferredLanguage {
					add:true
					flow:ret.value = checkPublic(work, "preferredLanguage");
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("http.qs.sn");\n
					mod:true
				}
				telephoneNumber {
					add:true
					flow:if (work.getString("http.qs.p_uwctelephonenumberset") != null) \n\tret.value = work.getString("http.qs.telephonenumber");\nelse ret.value = null;\n
					mod:true
				}
				title {
					add:true
					flow:ret.value = checkPublic(work, "title");
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uid");
					mod:false
				}
				uwcAffiliations {
					add:true
					flow:ret.value = checkPublic(work, "uwcaffiliations");
					mod:true
				}
				uwcAlsoKnownAs {
					add:true
					flow:ret.value = checkPublic(work, "uwcalsoknownas");
					mod:true
				}
				uwcBiography {
					add:true
					flow:ret.value = checkPublic(work, "uwcbiography");
					mod:true
				}
				uwcBirthDate {
					add:true
					flow:if (work.getString("http.qs.p_uwcbirthdate")  == "on")\nret.value = \n\twork.getString("http.qs.y4_uwcbirthdate") + \n\twork.getString("http.qs.mm_uwcbirthdate") + \n\twork.getString("http.qs.dd_uwcbirthdate");
					mod:true
				}
				uwcChildren {
					add:true
					flow:ret.value = checkPublic(work, "uwcchildren");
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uwccollege");
					mod:false
				}
				uwcCollegeFirstName {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uwccollegefirstname");
					mod:false
				}
				uwcCollegeSurname {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uwccollegesurname");
					mod:false
				}
				uwcDegree {
					add:true
					flow:ret.value = checkPublic(work, "uwcdegree");
					mod:true
				}
				uwcEducatedAt {
					add:true
					flow:ret.value = checkPublic(work, "uwceducatedat");
					mod:true
				}
				uwcEducation {
					add:true
					flow:ret.value = checkPublic(work, "uwceducation");
					mod:true
				}
				uwcEndYear {
					add:true
					flow:ret.value = checkPublic(work, "uwcendyear");
					mod:true
				}
				uwcFallbackContactAddress {
					add:true
					flow:ret.value = checkPublic(work, "uwcfallbackcontactaddress");
					mod:true
				}
				uwcFallbackContactCity {
					add:true
					flow:ret.value = checkPublic(work, "uwcfallbackcontactcity");
					mod:true
				}
				uwcFallbackContactCountry {
					add:true
					flow:ret.value = checkPublic(work, "uwcfallbackcontactcountry");
					mod:true
				}
				uwcFallbackContactName {
					add:true
					flow:ret.value = checkPublic(work, "uwcfallbackcontactname");
					mod:true
				}
				uwcFallbackContactPostalCode {
					add:true
					flow:ret.value = checkPublic(work, "uwcfallbackcontactpostalcode");
					mod:true
				}
				uwcFallbackContactProvince {
					add:true
					flow:ret.value = checkPublic(work, "uwcfallbackcontactprovince");
					mod:true
				}
				uwcFallbackFacsimileTelephoneNumber {
					add:true
					flow:ret.value = checkPublic(work, "uwcFallbackFacsimileTelephoneNumber");
					mod:true
				}
				uwcFallbackHomePhone {
					add:true
					flow:ret.value = checkPublic(work, "uwcFallbackHomePhone");
					mod:true
				}
				uwcFallbackMail {
					add:true
					flow:ret.value = checkPublic(work, "uwcFallbackMail");
					mod:true
				}
				uwcGender {
					add:true
					flow:ret.value = checkPublic(work, "uwcgender");
					mod:true
				}
				uwcHomePhoneAreaCode {
					add:true
					flow:if (work.getString("http.qs.p_uwchomephoneset") != null) \n\tret.value = work.getString("http.qs.uwchomephoneareacode");\nelse ret.value = null;\n
					mod:true
				}
				uwcHomePhoneInternationalCode {
					add:true
					flow:if (work.getString("http.qs.p_uwchomephoneset") != null) \n\tret.value = work.getString("http.qs.uwchomephoneinternationalcode");\nelse ret.value = null;\n\n
					mod:true
				}
				uwcHonorific {
					add:true
					flow:ret.value = checkPublic(work, "uwcHonorific");
					mod:true
				}
				uwcICQNumber {
					add:true
					flow:ret.value = checkPublic(work, "uwcicqnumber");
					mod:true
				}
				uwcInterest {
					add:true
					flow:ret.value = checkPublic(work, "uwcinterest");
					mod:true
				}
				uwcMaritalStatus {
					add:true
					flow:ret.value = checkPublic(work, "uwcmaritalstatus");
					mod:true
				}
				uwcMiddleName {
					add:true
					flow:ret.value = checkPublic(work, "uwcmiddlename");
					mod:true
				}
				uwcNationality {
					add:true
					flow:ret.value = checkPublic(work, "uwcnationality");
					mod:true
				}
				uwcNotes {
					add:true
					flow:ret.value = checkPublic(work, "uwcnotes");
					mod:true
				}
				uwcOrganisation {
					add:true
					flow:ret.value = checkPublic(work, "uwcorganisation");
					mod:true
				}
				uwcPartnerName {
					add:true
					flow:ret.value = checkPublic(work, "uwcpartnername");
					mod:true
				}
				uwcPictureURI {
					add:true
					flow:ret.value = checkPublic(work, "uwcpictureuri");
					mod:true
				}
				uwcPostalCode {
					add:true
					flow:ret.value = checkPublic(work, "uwcPostalCode");
					mod:true
				}
				uwcPreferredAddress {
					add:true
					flow:ret.value = checkPublic(work, "uwcPreferredAddress");
					mod:true
				}
				uwcProfessions {
					add:true
					flow:ret.value = checkPublic(work, "uwcprofessions");
					mod:true
				}
				uwcProvince {
					add:true
					flow:ret.value = checkPublic(work, "uwcprovince");
					mod:true
				}
				uwcPublication {
					add:true
					flow:ret.value = checkPublic(work, "uwcpublication");
					mod:true
				}
				uwcRoles {
					add:true
					flow:ret.value = checkPublic(work, "uwcroles");
					mod:true
				}
				uwcSalutation {
					add:true
					flow:ret.value = checkPublic(work, "uwcsalutation");
					mod:true
				}
				uwcSpokenLanguages {
					add:true
					flow:ret.value = checkPublic(work, "uwcspokenlanguages");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uwcstartyear");
					mod:false
				}
				uwcTelephoneNumberAreaCode {
					add:true
					flow:if (work.getString("http.qs.p_uwctelephonenumberset") != null)\n\tret.value = work.getString("http.qs.uwctelephonenumberareacode");\nelse ret.value = null;
					mod:true
				}
				uwcTelephoneNumberInternationalCode {
					add:true
					flow:if (work.getString("http.qs.p_uwctelephonenumberset") != null) \n\tret.value = work.getString("http.qs.uwctelephonenumberinternationalcode");\nelse ret.value = null;
					mod:true
				}
				uwcWebSite {
					add:true
					flow:ret.value = checkPublic(work, "uwcwebsite");
					mod:true
				}
				uwcWorkCity {
					add:true
					flow:ret.value = checkPublic(work, "uwcworkcity");
					mod:true
				}
				uwcWorkCountry {
					add:true
					flow:ret.value = checkPublic(work, "uwcworkcountry");
					mod:true
				}
				uwcWorkHistory {
					add:true
					flow:ret.value = checkPublic(work, "uwcWorkHistory");
					mod:true
				}
				uwcWorkPostalCode {
					add:true
					flow:ret.value = checkPublic(work, "uwcworkpostalcode");
					mod:true
				}
				uwcWorkProvince {
					add:true
					flow:ret.value = checkPublic(work, "uwcworkprovince");
					mod:true
				}
				uwcWorkURI {
					add:true
					flow:ret.value = checkPublic(work, "uwcworkURI");
					mod:true
				}
			}
		}
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.dumpEntry (conn);\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:true
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:true
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:true
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:true
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				inputStream {
					Include:true
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:true
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:true
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			attributeList {
			}
			enabled:true
			parserConfig {
			}
			script:if ((ldapErrorUnity == "OK") && (ldapErrorFreedom == "OK"))\n\twork.setAttribute ("exitStatus", "OK");\nelse\n{\n\tif (ldapErrorUnity != "OK")\n\t{\n\t\tif (ldapErrorFreedom != "OK")\n\t\t\twork.setAttribute ("exitStatus", "While updating Unity: " + ldapErrorUnity + "\\r\\n" + "While updating Freedom: " + ldapErrorFreedom);\n\t\telse \n\t\t\twork.setAttribute ("exitStatus", "While updating Unity: " + ldapErrorUnity);\n\t}\n\telse\n\t\twork.setAttribute ("exitStatus", "While updating Freedom: " + ldapErrorFreedom);\n}\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
		unity.lookup {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:task.logmsg ("Entry not found");\nldapError = "Unable to find entry";\nwork.setAttribute("ErrorOccured", "yes");\nwork.setAttribute ("$dn", "unknown");
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			allow_duplicates:false
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
				$dn:=|$http.qs.dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				$dn {
					add:false
					flow:ret.value = conn.getAttribute("$dn");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				objectclass {
					add:false
					flow:ret.value = conn.getAttribute("objectclass");
					mod:false
				}
			}
		}
		unity.update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:true
					flow:task.logmsg ("Attempting to ADD on unity");\ntask.dumpEntry (conn);\n
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes on unity");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:true
					flow:if (work.getString("ErrorOccured") == "yes") {\n\ttask.logmsg ("Unregistered user attack! I quit");\n\tsystem.ignoreEntry();\n}\ntask.logmsg ("Before Update on unity");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:true
					flow:task.logmsg("Apply Attributes on unity");\ntask.dumpEntry (conn);
					name:Before Applying Changes
				}
				modify_nochange {
					active:true
					flow:task.logmsg ("No changes on unity");
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapErrorUnity = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapErrorUnity);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));\nwork.setAttribute("ErrorOccured", "yes");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:// ISS update\n// make sure file path exists\n//var url = new java.net.URL("http://unity.uwc.org/cgi-bin/checkdir.cpe?uid=" + work.getString("http.qs.uid"));\n//url.getContent();\n//task.logmsg ("Create: " + work.getString("http.qs.uid"));\n\nldapErrorUnity = "OK";\ntask.logmsg ("Entry updated OK on unity");\n
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				connectorType:@unity.lookup
				inheritFrom:@unity.lookup
			}
			inheritAM:GDFullSetOfAttributes
			link [
				$dn:=|$$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				mail {
					add:true
					flow:ret.value = work.getString("http.qs.uid") + "@uwc.net";
					mod:true
				}
				objectclass {
					add:true
					flow:if (!work.getAttribute("objectclass").hasValue("uwcPerson"))\n{\n\ttmp = work.getAttribute("objectclass");\n\ttmp.addValue("uwcPerson");\n\tret.value = tmp;\n}\nelse\n{\n\tret.value = work.getAttribute("objectclass");\n}
					mod:false
				}
				uwcLocation {
					add:true
					flow:ret.value = null;
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to edit user's data in UWC's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	nullBehavior:Null
	prolog:var ldapErrorUnity = "OK";\nvar ldapErrorFreedom = "OK";\n\nfunction checkPublic (work, attr)\n{\n   // Is the attribute set to be public ?\n\tvar pub = work.getString("http.qs.p_" + attr);\n\tif (pub != null)\n\t{\n\t\t attr = "http.qs." + attr;\n\t\tif (pub == "on")\n\t\t{\n\t\t\tvar attribute = work.getAttribute(attr);\n\t\t\tif (attribute != null)\n\t\t\t{\n\t\t\t\tvar size = attribute.size();\t\t\t\t\n\t\t\t\tif (size == 1)\n\t\t\t\t{\n\t\t\t\t\tvar value = attribute.getValue();\n\t\t\t\t\tif (value != "") return value;\n\t\t\t\t\telse return null;\n\t\t\t\t}\n\t\t\t\telse return attribute;\n\t\t\t}\n\t\t\telse return null;\n\t\t}\n\t\telse return null;\n\t}\n\telse return null;\n}\n\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.record.read]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		unityRead
		reply
	]
	components {
		freedomLookup {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:if (work.getString("oper") != "lookup") {\n\ttask.logmsg ("Not a lookup operation");\n\tsystem.ignoreEntry();\n}
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("$dn") );\n
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$dn
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
			}
		}
		hm {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:main.logmsg  ("Entry not in FREEDOM directory: " + work.getString("$dn") );\ncheckHeadmaster(work);
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:ldapError = "Your entry shows that you have already performed this registration";\nwork.removeAllAttributes();\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchBase:ou=headmasters, o=uwc
			}
			link [
				(attr):=|$value
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Passive
			updateAttributes {
			}
		}
		input {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:true
				inheritFrom:(runtime provided)
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				dn {
					add:false
					flow:ret.value = conn.getAttribute("dn");
					mod:false
				}
			}
		}
		inputain {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.logmsg ("Submitted DATA");\ntask.dumpEntry (conn);\n\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:false
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:false
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:false
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:false
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:false
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:false
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:false
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:false
					Name:i
					Sample:
				}
				inputStream {
					Include:false
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:false
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:false
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
				connectorType:@input
			}
			inheritAM:
			link [
			]
			override {
			}
			parserConfig {
				inheritFrom:
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			enabled:true
			script:work.setAttribute ("inputStream", null);\nwork.setAttribute ("outputStream", null);\nwork.setAttribute ("userPassword", null);\n\nwork.setAttribute ("exitStatus", ldapError);\n\ntask.logmsg ("Output Work");\ntask.dumpEntry (work);\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\n\nwork.setAttribute("http.body", s);\n
			type:Script
		}
		test {
			enabled:true
			script:main.logmsg("test: " + work.getString("http.qs.dn"));
			type:Script
		}
		unity {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:true
					flow:var initials = work.getString("initials");\nif (work.getString("oper") != "lookup") {\n\ttask.logmsg ("Not a lookup operation");\n\tsystem.ignoreEntry();\n}
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Unable to find entry");\nldapError = "AS unable to find entry based on your submitted data(1)";\n
					name:Lookup fail
				}
				lookup_multiple {
					active:true
					flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "Not found";\nwork.setAttribute ("status", "entry not found");\n
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:task.logmsg ("Entry found on UNITY");\nif (conn.getAttribute("initials") != null)\n{\n\ttask.logmsg ("Verifying middlename");\n\tif (conn.getString("initials").compareTo(initials) != 0)\n\t\tldapError = "AS unable to find entry based on your submitted data(1)";\n}\ntask.logmsg ("Now check headmaster");\nif (!checkHeadmaster()) {\n\tldapError = "AS unable to find entry based on your submitted data(2)";\n}\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
				gn:=|$gn
				sn:=|$sn
				uwccollege:=|$uwccollege
				uwcstartyear:=|$uwcstartyear
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		unityRead {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:task.logmsg ("Working Entry");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:true
					flow:main.logmsg  ("Unable to find entry");\nldapError = "MetaMerge Integrator is unable to find your entry";\nwork.removeAllAttributes();
					name:Lookup fail
				}
				lookup_multiple {
					active:true
					flow:java.lang.System.out.println ("Multiple entries found");\nldapError = "MetaMerge Integrator is unable to find your entry";\n
					name:Multiple Entries Found
				}
				lookup_ok {
					active:true
					flow:task.logmsg ("Entry READ on UNITY");\n\n//task.logmsg ("additional mappings");\n\nif (work.getAttribute("uwccollegesurname") == null)\n\twork.setAttribute("uwccollegesurname",work.getString("sn"));\n\nif (work.getAttribute("uwccollegefirstname") == null)\n\twork.setAttribute("uwccollegefirstname",work.getString("gn"));\n\n// OPENLDAP considers gn as givenName, CDC does not\n//if (work.getAttribute("givenName") == null)\n//\twork.setAttribute("givenName",work.getString("gn"));\n\n// OPENLDAP considers generationQualifier as is, CDC as gq\n//if (work.getAttribute("generationQualifier") == null)\n//\twork.setAttribute("generationQualifier",work.getString("gq"));\n\n//work.setAttribute("uwcrole",work.getString("title"));\n//work.setAttribute("title","");\n\n//if (work.getAttribute("uwcmiddlename") == null)\n//{\n//\twork.setAttribute("uwcmiddlename",work.getString("initials"));\n//}\n\n//if (work.getAttribute("mail") == null)\n//\twork.setAttribute("mail", work.getString("gn") + "." + work.getString("sn") + "@uwc.net");\n\n//for (i=0; i < work.getAttribute("uwcLocation").size(); i++)\n//{\n//\tif (work.getAttribute("homepostaladdress") == null)\n//\t{\n//\t\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Home"))\n//\t\t\twork.setAttribute("homepostaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n\n//\tif (work.getAttribute("postaladdress") == null)\n//\t{\n//\tif (work.getAttribute("uwclocation").getValue(i).toString().startsWith("Work")) \n//\t\twork.setAttribute("postaladdress",work.getAttribute("uwclocation").getValue(i).toString().substring(6));\n//\t}\n//}\n//task.logmsg ("Mappings done");\n\n\n
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed");
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=AC65MKNA,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Michael Knagenhjelm
				}
				facsimileTelephoneNumber {
					Include:true
					Name:facsimileTelephoneNumber
					Sample:+47 67 59 16 19
				}
				filePathname {
					Include:true
					Name:filePathname
					Sample:/var/ISS/mail/uwc/ac65mkna
				}
				gn {
					Include:true
					Name:gn
					Sample:Michael
				}
				homePhone {
					Include:true
					Name:homePhone
					Sample:+47 67 59 16 17
				}
				initials {
					Include:true
					Name:initials
					Sample:Haffner
				}
				mail {
					Include:true
					Name:mail
					Sample:m@uwc.net
				}
				mhsMessageStoreName {
					Include:true
					Name:mhsMessageStoreName
					Sample:cn=ISS-unity.uwc.org, cn=Application Services, o=UWC
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Originator {
					Include:true
					Name:preferredRfc822Originator
					Sample:mhk@uwc.net
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:mhk@uwc.net
				}
				sn {
					Include:true
					Name:sn
					Sample:Knagenhjelm
				}
				telephoneNumber {
					Include:true
					Name:telephoneNumber
					Sample:+47 92 03 20 11
				}
				title {
					Include:true
					Name:title
					Sample:Board Member
				}
				uid {
					Include:true
					Name:uid
					Sample:AC65MKNA
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@32cf5
				}
				uwcCity {
					Include:true
					Name:uwcCity
					Sample:Bekkestua
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcCountry {
					Include:true
					Name:uwcCountry
					Sample:Norway
				}
				uwcEducation {
					Include:true
					Name:uwcEducation
					Sample:Economics!London Sch. of Economics
				}
				uwcEndYear {
					Include:true
					Name:uwcEndYear
					Sample:67
				}
				uwcLocation {
					Include:true
					Name:uwcLocation
					Sample:Home: Griniveien 406,1340 Bekkestua, Norway
				}
				uwcSkills {
					Include:true
					Name:uwcSkills
					Sample:Education: Economics at London Sch. of Economics
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:65
				}
			}
			compute_changes:false
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapPageSize:0
				ldapReferrals:follow
				ldapSearchFilter:objectclass=uwcperson
				ldapSizeLimit:0
				ldapTimeLimit:0
			}
			link [
				$dn:=|$http.qs.dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Lookup
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to register new users in MIG
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	prolog:\nvar ldapError = "OK";\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task uwc.MIG2.user.schema.create]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		usersubtree
		reply
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:true
					flow:task.dumpEntry (conn);\n
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				base {
					Include:true
					Name:base
					Sample:/data03.html
				}
				cn {
					Include:true
					Name:cn
					Sample:Bjorn+Stadheim
				}
				dd_uwcdateofbirth {
					Include:true
					Name:dd_uwcdateofbirth
					Sample:
				}
				dn {
					Include:true
					Name:dn
					Sample:uid=xx98bsta,+o=UWC
				}
				gn {
					Include:true
					Name:gn
					Sample:Bjorn
				}
				homephone {
					Include:true
					Name:homephone
					Sample:
				}
				homepostaladdress {
					Include:true
					Name:homepostaladdress
					Sample:
				}
				i {
					Include:true
					Name:i
					Sample:
				}
				inputStream {
					Include:true
					Name:inputStream
					Sample:java.io.BufferedReader@3c5fd5
				}
				mail {
					Include:true
					Name:mail
					Sample:Bjorn.Stadheim@uwc.net
				}
				mm_uwcdateofbirth {
					Include:true
					Name:mm_uwcdateofbirth
					Sample:
				}
				mobile {
					Include:true
					Name:mobile
					Sample:
				}
				outputStream {
					Include:true
					Name:outputStream
					Sample:java.io.BufferedWriter@37a875
				}
				p_mobile {
					Include:true
					Name:p_mobile
					Sample:0
				}
				p_uwcwebsite {
					Include:true
					Name:p_uwcwebsite
					Sample:0
				}
				pager {
					Include:true
					Name:pager
					Sample:
				}
				postaladdress {
					Include:true
					Name:postaladdress
					Sample:
				}
				sn {
					Include:true
					Name:sn
					Sample:Stadheim
				}
				title {
					Include:true
					Name:title
					Sample:Partner
				}
				uwccollegesurname {
					Include:true
					Name:uwccollegesurname
					Sample:
				}
				uwcgender {
					Include:true
					Name:uwcgender
					Sample:
				}
				uwcknownas {
					Include:true
					Name:uwcknownas
					Sample:
				}
				uwcnationality {
					Include:true
					Name:uwcnationality
					Sample:
				}
				uwcsalutation {
					Include:true
					Name:uwcsalutation
					Sample:Mr.
				}
				uwcwebsite {
					Include:true
					Name:uwcwebsite
					Sample:
				}
				y4_uwcdateofbirth {
					Include:true
					Name:y4_uwcdateofbirth
					Sample:
				}
			}
			connectorConfig {
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				* {
					add:false
					flow:ret.value = conn.getAttribute("*");
					mod:false
				}
			}
		}
		reply {
			enabled:true
			script:work.setAttribute("exitStatus", ldapError);\n\ns = system.entry2LDIF(work);\nif (s == null) {\n\ttask.logmsg("LDIF Error: " + system.lastError);\n}\ntask.logmsg(s);\nwork.setAttribute("http.body", s);\n
			type:Script
		}
		usersubtree {
			ALEvent {
				addonly_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Subtree add failed: " + ldapError);\ntask.logmsg ("Subtree add failed: " + error.getString("exception"));
					name:AddOnly fail
				}
				addonly_ok {
					active:true
					flow:task.logmsg ("User subtree added succesfully");
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg("Update Attributes");\ntask.dumpEntry (conn);
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:true
					flow:task.logmsg ("Before Update");\ntask.dumpEntry (work);
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:true
					flow:task.logmsg("Apply Attributes");\ntask.dumpEntry (conn);
					name:Before Applying Changes
				}
				modify_nochange {
					active:true
					flow:task.logmsg ("No changes");\nldapError = "No changes";
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:ldapError = error.getString("message");\ntask.logmsg ("Entry update failed: " + ldapError);\ntask.logmsg ("Entry update failed: " + error.getString("exception"));
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:true
					flow:ldapError = "OK";\ntask.logmsg ("Entry updated OK");
					name:Update ok
				}
			}
			attributeList {
			}
			compute_changes:false
			connectorConfig {
				connectorFlags:{DontdeleteEmptyStrings}
				debug:true
				inheritFrom:LDAPFreedom
			}
			link [
				$dn:=|$$dn
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("http.qs.uid") + ",ou=userdefaults,ou=schema,o=uwc";\n
					mod:false
				}
				objectclass {
					add:true
					flow:tmp = system.newAttribute("objectclass");\ntmp.addValue("uidObject");\ntmp.addValue("top");\nret.value = tmp;
					mod:false
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("http.qs.uid");
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to insert user's search engine preference folder into freedom's MIG
	epilog:
	get_history:
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	prolog:var ldapError = "OK";\n
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
	verbose:
[end]

[task xls2LDAP.AC2000grads]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		input
		update
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				College {
					Include:true
					Name:College
					Sample:AC
				}
				firstname {
					Include:true
					Name:firstname
					Sample:Saad
				}
				mail {
					Include:true
					Name:mail
					Sample:saad.afsar@uwc.net
				}
				startyear {
					Include:true
					Name:startyear
					Sample:2000
				}
				surname {
					Include:true
					Name:surname
					Sample:AFSAR
				}
				uid {
					Include:true
					Name:uid
					Sample:ac00safs
				}
			}
			connectorConfig {
				inheritFrom:ODBC
				jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
				jdbcLogin:
				jdbcSelect:
				jdbcSource:jdbc:odbc:uwcac2000
				jdbcTable:ac
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				college {
					add:false
					flow:ret.value = conn.getAttribute("College");
					mod:false
				}
				firstname {
					add:false
					flow:ret.value = conn.getAttribute("firstname");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				startyear {
					add:false
					flow:ret.value = conn.getAttribute("startyear");
					mod:false
				}
				surname {
					add:false
					flow:ret.value = conn.getAttribute("surname");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("uid");
					mod:false
				}
			}
		}
		update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:true
					flow:conn.getAttribute ("objectclass").addValue ("cdsIntraStoreUser");\ntask.dumpEntry (conn);
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg ("UID already present: " + work.getString("uid"));
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update failed: " + error.getString("class"));\n
					name:Update fail
				}
				update_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nsystem.skipEntry();
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=ac90hham,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Hilary Hamper
				}
				gn {
					Include:true
					Name:gn
					Sample:Hilary
				}
				mail {
					Include:true
					Name:mail
					Sample:ac90hham@uwc.net
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:ac90hham@rcnuwc.uwc.org
				}
				sn {
					Include:true
					Name:sn
					Sample:Hamper
				}
				uid {
					Include:true
					Name:uid
					Sample:ac90hham
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@14fc36
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:90
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAP
				ldapPassword:worthington
				ldapSearchBase:o=uwc
				ldapSearchFilter:uid=ac90hham
				ldapUrl:ldap://unity.uwc.org:389
				ldapUsername:cn=administrator,o=uwc
			}
			link [
				uid:=|$uid
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ", o=uwc";
					mod:false
				}
				cn {
					add:true
					flow:ret.value = work.getString("firstname") + " " + work.getString("surname");
					mod:false
				}
				gn {
					add:true
					flow:ret.value = work.getAttribute("firstname");
					mod:false
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:false
				}
				objectClass {
					add:true
					flow:ret.value = "uwcPerson";\n
					mod:false
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("surname");
					mod:false
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				userPassword {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("college");
					mod:false
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("startyear");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to import new users from excel file into freedom's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	maxread:
	nullBehavior:Default Behavior
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task xls2LDAP.AC2002grads]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		input
		output
	]
	components {
		input {
			ALEvent {
			}
			attributeList {
				first name {
					Include:true
					Name:first name
					Sample:Annikki
					Syntax:java.lang.String
				}
				fwd {
					Include:true
					Name:fwd
					Sample:
				}
				last name {
					Include:true
					Name:last name
					Sample:allam
					Syntax:java.lang.String
				}
				student / staff {
					Include:true
					Name:student / staff
					Sample:student
					Syntax:java.lang.String
				}
				username {
					Include:true
					Name:username
					Sample:ac02aher
					Syntax:java.lang.String
				}
				uwc email address {
					Include:true
					Name:uwc email address
					Sample:Annikki.allam@uwc.net
					Syntax:java.lang.String
				}
				uwccollege {
					Include:true
					Name:uwccollege
					Sample:ac
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcSource:jdbc:odbc:Excel Files;dbq=C:\\Documents and Settings\\no010190\\My Documents\\Excel Files\\uwc email 2002.xls
				jdbcTable:uwc
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				firstname {
					add:false
					flow:ret.value = conn.getAttribute("first name");
					mod:false
				}
				lastname {
					add:false
					flow:ret.value = conn.getAttribute("last name");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("uwc email address");
					mod:false
				}
				uwcid {
					add:false
					flow:ret.value = conn.getAttribute("username");
					mod:false
				}
			}
		}
		output {
			ALEvent {
				addonly_fail {
					active:true
					flow:main.dump(error);
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uwcid") + ", o=uwc";
					mod:true
				}
				cn {
					add:true
					flow:ret.value = work.getString("firstname") + " " + work.getString("lastname");
					mod:true
				}
				givenName {
					add:true
					flow:ret.value = work.getAttribute("Firstname");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getString("uwcid") + "@uwc.net";
					mod:true
				}
				mailAlternateAddress {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				mailMessageStore {
					add:true
					flow:ret.value = work.getAttribute("uwcid");
					mod:true
				}
				objectClass {
					add:true
					flow:ret.value = system.newAttribute("objectclass");\nret.value.addValue ("top");\nret.value.addValue ("person");\nret.value.addValue ("organizationalPerson");\nret.value.addValue ("uwcPerson");\nret.value.addValue ("qmailUser");\nret.value.addValue ("MIGitem");\n\n
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("lastname");
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uwcid");
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = "AC";
					mod:true
				}
				uwcCollegeFirstName {
					add:true
					flow:ret.value = work.getAttribute("firstname");
					mod:true
				}
				uwcCollegeSurname {
					add:true
					flow:ret.value = work.getAttribute("lastname");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = "2002";
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task xls2LDAP.AW2000grads]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		input
		output
	]
	components {
		input {
			ALEvent {
			}
			attributeList {
				firstname {
					Include:true
					Name:firstname
					Sample:Awo
					Syntax:java.lang.String
				}
				forward {
					Include:true
					Name:forward
					Sample:nc02aadd@rcnuwc.uwc.org
					Syntax:java.lang.String
				}
				lastname {
					Include:true
					Name:lastname
					Sample:Addo
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:awo.addo@uwc.net
					Syntax:java.lang.String
				}
				uwcid {
					Include:true
					Name:uwcid
					Sample:nc02aadd
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcSource:jdbc:odbc:Excel Files;dbq=C:\\Documents and Settings\\no010190\\My Documents\\Excel Files\\uwc.net user list.xls
				jdbcTable:nc
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
				firstname {
					add:false
					flow:ret.value = conn.getAttribute("firstname");
					mod:false
				}
				forward {
					add:false
					flow:ret.value = conn.getAttribute("forward");
					mod:false
				}
				lastname {
					add:false
					flow:ret.value = conn.getAttribute("lastname");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("mail");
					mod:false
				}
				uwcid {
					add:false
					flow:ret.value = conn.getAttribute("uwcid");
					mod:false
				}
			}
		}
		output {
			ALEvent {
				addonly_fail {
					active:true
					flow:main.dump(error);
				}
			}
			attributeList {
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
			}
			link [
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uwcid") + ", o=uwc";
					mod:true
				}
				cn {
					add:true
					flow:ret.value = work.getString("firstname") + " " + work.getString("lastname");
					mod:true
				}
				deliveryMode {
					add:true
					flow:fwd = system.newAttribute("deliveryMode");\nfwd.addValue("forwardonly");\nfwd.addValue("nombox");\nret.value = fwd;
					mod:true
				}
				givenName {
					add:true
					flow:ret.value = work.getAttribute("Firstname");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getString("uwcid") + "@uwc.net";
					mod:true
				}
				mailAlternateAddress {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				mailForwardingAddress {
					add:true
					flow:ret.value = work.getAttribute("forward");
					mod:true
				}
				mailMessageStore {
					add:true
					flow:ret.value = work.getAttribute("uwcid");
					mod:true
				}
				objectClass {
					add:true
					flow:ret.value = system.newAttribute("objectclass");\nret.value.addValue ("top");\nret.value.addValue ("person");\nret.value.addValue ("organizationalPerson");\nret.value.addValue ("uwcPerson");\nret.value.addValue ("qmailUser");\nret.value.addValue ("MIGitem");\n\n
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("lastname");
					mod:true
				}
				uid {
					add:true
					flow:ret.value = work.getAttribute("uwcid");
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = "NC";
					mod:true
				}
				uwcCollegeFirstName {
					add:true
					flow:ret.value = work.getAttribute("firstname");
					mod:true
				}
				uwcCollegeSurname {
					add:true
					flow:ret.value = work.getAttribute("lastname");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = "2002";
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task xls2LDAP.NC1999grads]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		input
		update
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				E-mail address {
					Include:true
					Name:E-mail address
					Sample:binadaimary@hotmail.com
					Syntax:java.lang.String
				}
				First name {
					Include:true
					Name:First name
					Sample:Bina
					Syntax:java.lang.String
				}
				Last name {
					Include:true
					Name:Last name
					Sample:Daimary
					Syntax:java.lang.String
				}
				Preferred name {
					Include:true
					Name:Preferred name
					Sample:Bina
					Syntax:java.lang.String
				}
				UWC E-mail {
					Include:true
					Name:UWC E-mail
					Sample:bina.daimary@uwc.net
					Syntax:java.lang.String
				}
				UWC ID {
					Include:true
					Name:UWC ID
					Sample:nc99bdai
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
				jdbcLogin:
				jdbcSelect:
				jdbcSource:jdbc:odbc:nc99
				jdbcTable:nc
			}
			deltaConfig {
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				college {
					add:false
					flow:ret.value = "NC";
					mod:false
				}
				firstname {
					add:false
					flow:ret.value = conn.getAttribute("First name");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("UWC E-mail");
					mod:false
				}
				preferredrfc822recipient {
					add:false
					flow:ret.value = conn.getAttribute("E-mail address");
					mod:false
				}
				startyear {
					add:false
					flow:ret.value = "1999";
					mod:false
				}
				surname {
					add:false
					flow:ret.value = conn.getAttribute("Last name");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("UWC ID");
					mod:false
				}
				uwcalsoknownas {
					add:false
					flow:ret.value = conn.getAttribute("Preferred name");
					mod:false
				}
			}
		}
		update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:conn.getAttribute ("objectclass").addValue ("cdsIntraStoreUser");\ntask.dumpEntry (conn);
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg ("UID already present: " + work.getString("uid"));
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update failed: " + error.getString("class"));\n
					name:Update fail
				}
				update_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nsystem.skipEntry();
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=ac90hham,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Hilary Hamper
				}
				gn {
					Include:true
					Name:gn
					Sample:Hilary
				}
				mail {
					Include:true
					Name:mail
					Sample:ac90hham@uwc.net
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:ac90hham@rcnuwc.uwc.org
				}
				sn {
					Include:true
					Name:sn
					Sample:Hamper
				}
				uid {
					Include:true
					Name:uid
					Sample:ac90hham
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@14fc36
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:90
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapPassword:worthington
				ldapSearchBase:o=uwc
				ldapSearchFilter:uid=ac90hham
				ldapUrl:ldap://unity.uwc.org:389
				ldapUsername:cn=administrator,o=uwc
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ", o=uwc";
					mod:false
				}
				cn {
					add:true
					flow:ret.value = work.getString("firstname") + " " + work.getString("surname");
					mod:true
				}
				gn {
					add:true
					flow:ret.value = work.getAttribute("firstname");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				objectClass {
					add:true
					flow:ret.value = system.newAttribute("objectclass");\nret.value.addValue ("top");\nret.value.addValue ("person");\nret.value.addValue ("organizationalPerson");\nret.value.addValue ("uwcPerson");\nret.value.addValue ("cdsIntraStoreUser");\n
					mod:true
				}
				preferredRfc822Recipient {
					add:true
					flow:ret.value = work.getAttribute("preferredrfc822recipient");
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("surname");
					mod:true
				}
				uid {
					add:false
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				userPassword {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				uwcAlsoKnownAs {
					add:true
					flow:ret.value = work.getAttribute("uwcalsoknownas");
					mod:true
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("college");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("startyear");
					mod:true
				}
			}
		}
	}
	debug:false
	description:Used to import new users from excel file into freedom's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	maxread:
	nullBehavior:Default Behavior
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task xls2LDAP.NC2001grads]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		input
		update
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				College {
					Include:true
					Name:College
					Sample:NC
					Syntax:VARCHAR:255
				}
				Fwd {
					Include:true
					Name:Fwd
					Sample:nc01lels@rcnuwc.uwc.org
					Syntax:VARCHAR:255
				}
				Last name {
					Include:true
					Name:Last name
					Sample:Elsrud
					Syntax:VARCHAR:255
				}
				Preferred name {
					Include:true
					Name:Preferred name
					Sample:Lars
					Syntax:VARCHAR:255
				}
				UWC E-mail {
					Include:true
					Name:UWC E-mail
					Sample:lars.elsrud@uwc.net
					Syntax:VARCHAR:255
				}
				UWC ID {
					Include:true
					Name:UWC ID
					Sample:nc01lels
					Syntax:VARCHAR:255
				}
				UWCOrg {
					Include:true
					Name:UWCOrg
					Sample:Student
					Syntax:VARCHAR:255
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
				jdbcLogin:
				jdbcSelect:
				jdbcSource:jdbc:odbc:toOslo
				jdbcTable:toOslo
			}
			deltaConfig {
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				college {
					add:false
					flow:ret.value = conn.getAttribute("College");
					mod:false
				}
				firstname {
					add:false
					flow:ret.value = conn.getAttribute("Preferred name");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("UWC E-mail");
					mod:false
				}
				preferredrfc822recipient {
					add:false
					flow:ret.value = conn.getAttribute("Fwd");
					mod:false
				}
				startyear {
					add:false
					flow:ret.value = "2001";
					mod:false
				}
				surname {
					add:false
					flow:ret.value = conn.getAttribute("Last name");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("UWC ID");
					mod:false
				}
				uwcalsoknownas {
					add:false
					flow:ret.value = conn.getAttribute("Preferred name");
					mod:false
				}
				uwcorganisation {
					add:false
					flow:ret.value = conn.getAttribute("uwcorganisation");
					mod:false
				}
			}
		}
		update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:true
					flow:task.logmsg("added2");\n// make sure file path exists\nvar url = new java.net.URL("http://unity.uwc.org/cgi-bin/checkdir.cpe?uid=" + work.getString("uid"));\nurl.getContent();\ntask.logmsg ("Create: " + work.getString("uid"));
					name:AddOnly ok
				}
				after_add {
					active:true
					flow:task.logmsg("added");
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:conn.getAttribute ("objectclass").addValue ("cdsIntraStoreUser");\ntask.dumpEntry (conn);
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg ("UID already present: " + work.getString("uid"));
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update failed: " + error.getString("class"));\n
					name:Update fail
				}
				update_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nsystem.skipEntry();
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=ac90hham,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Hilary Hamper
				}
				gn {
					Include:true
					Name:gn
					Sample:Hilary
				}
				mail {
					Include:true
					Name:mail
					Sample:ac90hham@uwc.net
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:ac90hham@rcnuwc.uwc.org
				}
				sn {
					Include:true
					Name:sn
					Sample:Hamper
				}
				uid {
					Include:true
					Name:uid
					Sample:ac90hham
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@14fc36
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:90
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapPassword:worthington
				ldapSearchBase:o=uwc
				ldapSearchFilter:uid=ac90hham
				ldapUrl:ldap://unity.uwc.org:389
				ldapUsername:cn=administrator,o=uwc
			}
			link [
				uid:=|$uid
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:AddOnly
			updateAttributes {
				$dn {
					add:true
					flow://ret.value = "uid=" + work.getString("uid") + ", o=uwc";\nret.value = "uid=xxxxx, o=uwc";
					mod:false
				}
				cn {
					add:true
					flow:ret.value = work.getString("firstname") + " " + work.getString("surname");
					mod:true
				}
				filePathName {
					add:true
					flow:ret.value = "/var/ISS/mail/uwc/" + work.getString("uid");
					mod:true
				}
				gn {
					add:true
					flow:ret.value = work.getAttribute("firstname");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				mhsMessageStoreName {
					add:true
					flow:ret.value = "CN=iss-unity.uwc.org, cn=Application Services, o=UWC";
					mod:true
				}
				objectClass {
					add:true
					flow:ret.value = system.newAttribute("objectclass");\nret.value.addValue ("top");\nret.value.addValue ("person");\nret.value.addValue ("organizationalPerson");\nret.value.addValue ("uwcPerson");\nret.value.addValue ("cdsIntraStoreUser");\n
					mod:true
				}
				preferredRfc822Recipient {
					add:true
					flow:ret.value = work.getAttribute("preferredrfc822recipient");
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("surname");
					mod:true
				}
				uid {
					add:false
					flow://ret.value = work.getAttribute("uid");\nret.value = "xxxxx";
					mod:false
				}
				userPassword {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				uwcAlsoKnownAs {
					add:true
					flow:ret.value = work.getAttribute("uwcalsoknownas");
					mod:false
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("college");
					mod:false
				}
				uwcOrganisation {
					add:true
					flow:ret.value = work.getAttribute("uwcOrganisation");
					mod:true
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("startyear");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to import new users from excel file into freedom's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	maxread:
	nullBehavior:Default Behavior
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task xls2LDAP.NCgradsPasswords]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
		Crypt
		update
	]
	components {
		Crypt {
			enabled:true
			script:pass = work.getString("password");\n\ncrypt = "{crypt}" + system.shellCommand("/home/krist/cryptPass " + pass.substring(2)).getOutputBuffer().substring(0,13);\n\nwork.setAttribute("password", crypt);\nwork.setAttribute("dn", "uid=" + work.getString("UWC ID") + ",o=uwc");
			type:Script
		}
		read {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				fileMode:input
				filePath:/home/krist/PasswordsforUnity.csv
				inheritFrom:metamerge.FileSystem
				parser:metamerge.CSV
			}
			link [
			]
			override {
			}
			parserConfig {
				csvColumnSeparator:,
				csvEnableQuoting:true
				csvLogLongLines:0
				csvWriteHeader:true
				inheritFrom:metamerge.CSV
			}
			type:Iterator
			updateAttributes {
				Password {
					add:false
					flow:ret.value = conn.getAttribute("Password");
					mod:false
				}
				UWC ID {
					add:false
					flow:ret.value = conn.getAttribute("UWC ID");
					mod:false
				}
			}
		}
		update {
			ALEvent {
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=ac90cham,o=uwc
					Syntax:java.lang.String
				}
				MigCategory {
					Include:true
					Name:MigCategory
					Sample:MIGuser
					Syntax:java.lang.String
				}
				cn {
					Include:true
					Name:cn
					Sample:Chris Hamper
					Syntax:java.lang.String
				}
				deliveryMode {
					Include:true
					Name:deliveryMode
					Sample:nombox
					Syntax:java.lang.String
				}
				mail {
					Include:true
					Name:mail
					Sample:ac90cham@uwc.net
					Syntax:java.lang.String
				}
				mailAlternateAddress {
					Include:true
					Name:mailAlternateAddress
					Sample:ac90cham@unity.uwc.org
					Syntax:java.lang.String
				}
				mailForwardingAddress {
					Include:true
					Name:mailForwardingAddress
					Sample:ac90cham@rcnuwc.uwc.org
					Syntax:java.lang.String
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
					Syntax:java.lang.String
				}
				sn {
					Include:true
					Name:sn
					Sample:Hamper
					Syntax:java.lang.String
				}
				uid {
					Include:true
					Name:uid
					Sample:ac90cham
					Syntax:java.lang.String
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@4cdac8
					Syntax:ByteArray
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
					Syntax:java.lang.String
				}
				uwcCollegeFirstName {
					Include:true
					Name:uwcCollegeFirstName
					Sample:Chris
					Syntax:java.lang.String
				}
				uwcCollegeSurname {
					Include:true
					Name:uwcCollegeSurname
					Sample:Hamper
					Syntax:java.lang.String
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:1990
					Syntax:java.lang.String
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPFreedom
				ldapSearchFilter:uid=ac90cham
				ldapSearchScope:onelevel
			}
			link [
				$dn:=|$dn
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			type:Update
			updateAttributes {
				userPassword {
					add:false
					flow:ret.value = work.getAttribute("Password");
					mod:true
				}
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	maxread:
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[task xls2LDAP.SC2000grads]
	IOSettings {
	}
	attribute_map {
	}
	automapattributes:false
	componentlist [
		input
		update
	]
	components {
		input {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:false
					flow:
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:false
					flow:
					name:Update fail
				}
				update_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				Forwarding e-mail {
					Include:true
					Name:Forwarding e-mail
					Sample:reiko717@beige.ocn.ne.jp
					Syntax:java.lang.String
				}
				Last Name {
					Include:true
					Name:Last Name
					Sample:Yamamoto
					Syntax:java.lang.String
				}
				Preferred Name {
					Include:true
					Name:Preferred Name
					Sample:Reiko
					Syntax:java.lang.String
				}
				UWC E-mail {
					Include:true
					Name:UWC E-mail
					Sample:reiko.yamamoto@uwc.net
					Syntax:java.lang.String
				}
				UWC ID {
					Include:true
					Name:UWC ID
					Sample:hk99ryam
					Syntax:java.lang.String
				}
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcDriver:sun.jdbc.odbc.JdbcOdbcDriver
				jdbcLogin:
				jdbcSelect:select * from sc20
				jdbcSource:jdbc:odbc:sc20
				jdbcTable:
			}
			deltaConfig {
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Iterator
			updateAttributes {
				college {
					add:false
					flow:ret.value = "SC";
					mod:false
				}
				firstname {
					add:false
					flow:ret.value = conn.getAttribute("Preferred name");
					mod:false
				}
				mail {
					add:false
					flow:ret.value = conn.getAttribute("UWC E-mail");
					mod:false
				}
				preferredrfc822recipient {
					add:false
					flow:ret.value = conn.getAttribute("Forwarding e-mail");
					mod:false
				}
				startyear {
					add:false
					flow:ret.value = "2001";
					mod:false
				}
				surname {
					add:false
					flow:ret.value = conn.getAttribute("Last name");
					mod:false
				}
				uid {
					add:false
					flow:ret.value = conn.getAttribute("UWC ID");
					mod:false
				}
				uwcalsoknownas {
					add:false
					flow:ret.value = conn.getAttribute("Preferred name");
					mod:false
				}
			}
		}
		update {
			ALEvent {
				addonly_fail {
					active:false
					flow:
					name:AddOnly fail
				}
				addonly_ok {
					active:false
					flow:
					name:AddOnly ok
				}
				after_add {
					active:false
					flow:
					name:After Add
				}
				after_close {
					active:false
					flow:
					name:After close
				}
				after_delete {
					active:false
					flow:
					name:After delete
				}
				after_getnext {
					active:false
					flow:
					name:After GetNext
				}
				after_initialize {
					active:false
					flow:
					name:After initialize
				}
				after_lookup {
					active:false
					flow:
					name:After lookup
				}
				after_modify {
					active:false
					flow:
					name:After Modify
				}
				after_selectEntries {
					active:false
					flow:
					name:After selectEntries
				}
				after_update {
					active:false
					flow:
					name:After update
				}
				before_add {
					active:false
					flow:conn.getAttribute ("objectclass").addValue ("cdsIntraStoreUser");\ntask.dumpEntry (conn);
					name:Before Add
				}
				before_close {
					active:false
					flow:
					name:Before close
				}
				before_delete {
					active:false
					flow:
					name:Before delete
				}
				before_getnext {
					active:false
					flow:
					name:Before GetNext
				}
				before_initialize {
					active:false
					flow:
					name:Before initialize
				}
				before_lookup {
					active:false
					flow:
					name:Before lookup
				}
				before_modify {
					active:true
					flow:task.logmsg ("UID already present: " + work.getString("uid"));
					name:Before Modify
				}
				before_selectEntries {
					active:false
					flow:
					name:Before selectEntries
				}
				before_update {
					active:false
					flow:
					name:Before update
				}
				default_fail {
					active:false
					flow:
					name:Default fail
				}
				default_ok {
					active:false
					flow:
					name:Default ok
				}
				delete_fail {
					active:false
					flow:
					name:Fail Delete
				}
				delete_ok {
					active:false
					flow:
					name:OK Delete
				}
				get_fail {
					active:false
					flow:
					name:GetNext fail
				}
				get_ok {
					active:false
					flow:
					name:GetNext ok
				}
				lookup_fail {
					active:false
					flow:
					name:Lookup fail
				}
				lookup_multiple {
					active:false
					flow:
					name:Multiple Entries Found
				}
				lookup_ok {
					active:false
					flow:
					name:Lookup ok
				}
				modify_apply {
					active:false
					flow:
					name:Before Applying Changes
				}
				modify_nochange {
					active:false
					flow:
					name:Modify No changes
				}
				override_add {
					active:false
					flow:
					name:Override add
				}
				override_delete {
					active:false
					flow:
					name:Override delete
				}
				override_getnext {
					active:false
					flow:
					name:Override getnext
				}
				override_lookup {
					active:false
					flow:
					name:Override lookup
				}
				override_modify {
					active:false
					flow:
					name:Override modify
				}
				override_update {
					active:false
					flow:
					name:Override update
				}
				update_fail {
					active:true
					flow:task.logmsg ("Update failed: " + error.getString("class"));\n
					name:Update fail
				}
				update_multiple {
					active:true
					flow:task.logmsg ("Multiple entries found");\nsystem.skipEntry();
					name:Multiple Entries Found
				}
				update_ok {
					active:false
					flow:
					name:Update ok
				}
			}
			attributeList {
				$dn {
					Include:true
					Name:$dn
					Sample:uid=ac90hham,o=uwc
				}
				cn {
					Include:true
					Name:cn
					Sample:Hilary Hamper
				}
				gn {
					Include:true
					Name:gn
					Sample:Hilary
				}
				mail {
					Include:true
					Name:mail
					Sample:ac90hham@uwc.net
				}
				objectClass {
					Include:true
					Name:objectClass
					Sample:top
				}
				preferredRfc822Recipient {
					Include:true
					Name:preferredRfc822Recipient
					Sample:ac90hham@rcnuwc.uwc.org
				}
				sn {
					Include:true
					Name:sn
					Sample:Hamper
				}
				uid {
					Include:true
					Name:uid
					Sample:ac90hham
				}
				userPassword {
					Include:true
					Name:userPassword
					Sample:[B@14fc36
				}
				uwcCollege {
					Include:true
					Name:uwcCollege
					Sample:AC
				}
				uwcStartYear {
					Include:true
					Name:uwcStartYear
					Sample:90
				}
			}
			compute_changes:true
			connectorConfig {
				inheritFrom:LDAPUnity
				ldapPassword:worthington
				ldapSearchBase:o=uwc
				ldapSearchFilter:uid=ac90hham
				ldapUrl:ldap://unity.uwc.org:389
				ldapUsername:cn=administrator,o=uwc
			}
			link [
				uid:=|$uid
			]
			linkScript:ret.filter = "";
			override {
			}
			parserConfig {
			}
			proxyConfig {
			}
			type:Update
			updateAttributes {
				$dn {
					add:true
					flow:ret.value = "uid=" + work.getString("uid") + ", o=uwc";
					mod:false
				}
				cn {
					add:true
					flow:ret.value = work.getString("firstname") + " " + work.getString("surname");
					mod:true
				}
				gn {
					add:true
					flow:ret.value = work.getAttribute("firstname");
					mod:true
				}
				mail {
					add:true
					flow:ret.value = work.getAttribute("mail");
					mod:true
				}
				objectClass {
					add:true
					flow:ret.value = system.newAttribute("objectclass");\nret.value.addValue ("top");\nret.value.addValue ("person");\nret.value.addValue ("organizationalPerson");\nret.value.addValue ("uwcPerson");\nret.value.addValue ("cdsIntraStoreUser");\n
					mod:true
				}
				preferredRfc822Recipient {
					add:true
					flow:ret.value = work.getAttribute("preferredrfc822recipient");
					mod:true
				}
				sn {
					add:true
					flow:ret.value = work.getAttribute("surname");
					mod:true
				}
				uid {
					add:false
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				userPassword {
					add:true
					flow:ret.value = work.getAttribute("uid");
					mod:false
				}
				uwcAlsoKnownAs {
					add:true
					flow:ret.value = work.getAttribute("uwcalsoknownas");
					mod:false
				}
				uwcCollege {
					add:true
					flow:ret.value = work.getAttribute("college");
					mod:false
				}
				uwcStartYear {
					add:true
					flow:ret.value = work.getAttribute("startyear");
					mod:false
				}
			}
		}
	}
	debug:false
	description:Used to import new users from excel file into freedom's GD
	epilog:
	get_history:
	includeGlobalPrologs:true
	maxerr:
	maxread:
	nullBehavior:Default Behavior
	prolog:
	scriptEngine:JavaScript
	source:C:\\My Documents\\My Webs\\Newuser\\freedom.uwc.net.cfg
[end]

[task xls2LDAP.SEAgrads]
	IOSettings {
	}
	automapattributes:false
	componentlist [
		read
	]
	components {
		read {
			ALEvent {
			}
			attributeList {
			}
			connectorConfig {
				debug:false
				inheritFrom:metamerge.JDBC
				jdbcSource:jdbc:odbc:ms access database;dbq=c:\\atelier\\metamerge\\uwc\\sea-alumni-univ database.xls
			}
			link [
			]
			override {
			}
			parserConfig {
			}
			type:Iterator
			updateAttributes {
			}
		}
	}
	debug:false
	includeGlobalPrologs:true
	nullBehavior:Default Behavior
	scriptEngine:JavaScript
[end]

[window state]
	height:748
	left:-4
	top:-4
	width:1032
[end]

